<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Reasoning</title>
<link>https://shixiangwang.github.io/index.html</link>
<atom:link href="https://shixiangwang.github.io/index.xml" rel="self" type="application/rss+xml"/>
<description>Reasoning is a blog dedicated to exploring the intersection of data science, bioinformatics, and personal insights.</description>
<generator>quarto-1.3.361</generator>
<lastBuildDate>Tue, 25 Jul 2023 16:00:00 GMT</lastBuildDate>
<item>
  <title>Single-cell Workshop 2021 - 02 - èšç±»å’Œç»†èƒç±»å‹é‰´å®š</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index.html</link>
  <description><![CDATA[ <p>å­¦ä¹ èµ„æ–™ï¼š<a href="https://github.com/pkuerten/single_cell_clustering_annotation.github.io/blob/main/index.md" class="uri">https://github.com/pkuerten/single_cell_clustering_annotation.github.io/blob/main/index.md</a></p>
<section id="æ•°æ®ä¸‹è½½" class="level2"><h2 class="anchored" data-anchor-id="æ•°æ®ä¸‹è½½">æ•°æ®ä¸‹è½½</h2>
<p>æˆ‘ä»¬å°†ä½¿ç”¨åŒ…å«å¤§çº¦10Kä¸ªå•ç»†èƒçš„PBMCæ•°æ®é›†ã€‚è¿™ä¸ªæ•°æ®é›†æ˜¯ç”±10XåŸºå› ç»„å…¬å¸å…¬å¼€æä¾›çš„ï¼Œå¯ä»¥ä» <a href="https://www.dropbox.com/s/wn4mgwkkzqw2pox/SC3_v3_NextGem_DI_PBMC_10K_filtered_feature_bc_matrix.h5?dl=0" class="uri">https://www.dropbox.com/s/wn4mgwkkzqw2pox/SC3_v3_NextGem_DI_PBMC_10K_filtered_feature_bc_matrix.h5?dl=0</a> ä¸‹è½½ã€‚</p>
</section><section id="å‡†å¤‡" class="level2"><h2 class="anchored" data-anchor-id="å‡†å¤‡">å‡†å¤‡</h2>
<p>è¿™ä¸ªæ–‡ç« çš„å†…å®¹çµæ„Ÿæ¥è‡ªå¤šä¸ª<a href="https://satijalab.org/seurat/articles/get_started.html">Seurat æ–‡æ¡£</a>ã€‚å®ƒå‡å®šä½ å·²ç»ç†Ÿæ‚‰äº†æœ€åˆçš„è´¨æ§æ­¥éª¤ã€‚æˆ‘ä»¬å°†ä»ç”±cellrangerç”Ÿæˆçš„æ•°æ® x ç»†èƒè¿‡æ»¤çŸ©é˜µå¼€å§‹ï¼Œè¿™æ˜¯å¤§å¤šæ•°åˆ†æçš„å¸¸è§èµ·ç‚¹ã€‚</p>
<p>æˆ‘ä»¬å°†ä¸“æ³¨äºå•ç»†èƒRNAæµ‹åºåˆ†æçš„ä¸¤ä¸ªå…·ä½“å…³é”®ä»»åŠ¡ï¼šèšç±»å’Œå¯¹å·²è¯†åˆ«èšç±»çš„æ³¨é‡Šã€‚</p>
</section><section id="å®‰è£…åŒ…" class="level2"><h2 class="anchored" data-anchor-id="å®‰è£…åŒ…">å®‰è£…åŒ…</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Seurat"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hdf5r"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clustree"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BiocManager"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">BiocManager</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SingleR"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">BiocManager</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"celldex"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<p>åŠ è½½ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat">Seurat</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Attaching SeuratObject</code></pre>
</div>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/lazappi/clustree">clustree</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggraph</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/LTLA/SingleR">SingleR</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: SummarizedExperiment</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MatrixGenerics</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: matrixStats</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'matrixStats'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    count</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MatrixGenerics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:matrixStats':

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: GenomicRanges</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: stats4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: BiocGenerics</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'BiocGenerics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    combine, intersect, setdiff, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    IQR, mad, sd, var, xtabs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,
    table, tapply, union, unique, unsplit, which.max, which.min</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: S4Vectors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'S4Vectors'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    first, rename</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    expand.grid, I, unname</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: IRanges</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'IRanges'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    collapse, desc, slice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: GenomeInfoDb</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Biobase</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Biobase'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MatrixGenerics':

    rowMedians</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:matrixStats':

    anyMissing, rowMedians</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'SummarizedExperiment'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:SeuratObject':

    Assays</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Seurat':

    Assays</code></pre>
</div>
<div class="sourceCode" id="cb42" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/LTLA/celldex">celldex</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'celldex'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:SingleR':

    BlueprintEncodeData, DatabaseImmuneCellExpressionData,
    HumanPrimaryCellAtlasData, ImmGenData, MonacoImmuneData,
    MouseRNAseqData, NovershternHematopoieticData</code></pre>
</div>
</div>
</section><section id="è¯»å…¥æ•°æ®é›†å¹¶åˆ›å»ºä¸€ä¸ª-seurat-å¯¹è±¡" class="level2"><h2 class="anchored" data-anchor-id="è¯»å…¥æ•°æ®é›†å¹¶åˆ›å»ºä¸€ä¸ª-seurat-å¯¹è±¡">è¯»å…¥æ•°æ®é›†å¹¶åˆ›å»ºä¸€ä¸ª Seurat å¯¹è±¡</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦è¯»å–10Xæµ‹åºæ•°æ®å¹¶å°†å…¶è½¬æ¢ä¸º Seurat å¯¹è±¡ã€‚Seurat å¯¹è±¡ä½œä¸ºä¸€ä¸ªå®¹å™¨ï¼Œæœ€åˆåªåŒ…å« UMI è®¡æ•°çŸ©é˜µã€‚ä½†æˆ‘ä»¬ä¼šå‘å…¶æ·»åŠ æ›´å¤šçš„åˆ†æå†…å®¹ï¼ˆä¾‹å¦‚PCAã€èšç±»ç»“æœï¼‰ã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆé€šè¿‡ä½¿ç”¨ <code>Read10X_h5</code> å‡½æ•°è¯»å–è®¡æ•°çŸ©é˜µï¼Œè¯¥å‡½æ•°ä»10X CellRanger hdf5æ–‡ä»¶ä¸­è¯»å–è®¡æ•°çŸ©é˜µã€‚å±‚æ¬¡æ•°æ®æ ¼å¼ï¼ˆHierarchical Data Formatï¼ŒHDF5æˆ–H5ï¼‰æä¾›äº†æ•°æ®çš„æ›´å‹ç¼©çš„è¡¨ç¤ºå½¢å¼ã€‚Seurat è½¯ä»¶åŒ…åŒ…å«å¤šä¸ªè¯»å–å‡½æ•°ï¼Œå…·ä½“å–å†³äºæ–‡ä»¶æ ¼å¼ã€‚</p>
<p>åœ¨è¯»å–æ•°æ®æ—¶ï¼Œæˆ‘ä»¬ä¼šåº”ç”¨åŸºæœ¬çš„è´¨é‡æ§åˆ¶ï¼Œå°†ä½è´¨é‡çš„ç»†èƒä¸¢å¼ƒã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb45" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc.data</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/Read10X_h5.html">Read10X_h5</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>filename<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/wsx/Library/CloudStorage/OneDrive-shanghaitech.edu.cn/Public/data/SC3_v3_NextGem_DI_PBMC_10K_filtered_feature_bc_matrix.h5"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/CreateSeuratObject.html">CreateSeuratObject</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>counts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc.data</span>, project <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pbmc10k"</span>, min.cells <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, min.features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"percent.mt"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/PercentageFeatureSet.html">PercentageFeatureSet</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, pattern <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^MT-"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, subset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nFeature_RNA</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nFeature_RNA</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">percent.mt</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¡ç®—çº¿ç²’ä½“RNAåœ¨æ€»RNAå«é‡ä¸­çš„ç™¾åˆ†æ¯”è´¡çŒ®ã€‚é«˜çº¿ç²’ä½“å«é‡å¯èƒ½è¡¨æ˜æ­£åœ¨ç»å†å‡‹äº¡çš„ä½è´¨é‡ç»†èƒã€‚æˆ‘ä»¬æ ¹æ®çº¿ç²’ä½“å«é‡å’Œæ¯ä¸ªç»†èƒç‰¹å¾æ•°çš„åˆ†å¸ƒå†æ¬¡è¿›è¡Œè´¨é‡æ§åˆ¶ã€‚ç‰¹å¾æ•°è¿‡ä½å¯èƒ½è¡¨æ˜ç©ºçš„æ¶²æ»´ä¸­å­˜åœ¨ç¯å¢ƒRNAæ±¡æŸ“ã€‚ç‰¹å¾æ•°è¿‡é«˜å¯èƒ½æ˜¯ç”±äºå¤šä¸ªç»†èƒè¢«å›°åœ¨åŒä¸€ä¸ªæ¶²æ»´ä¸­å¼•èµ·çš„ã€‚</p>
</section><section id="æ•°æ®å¤„ç†" class="level2"><h2 class="anchored" data-anchor-id="æ•°æ®å¤„ç†">æ•°æ®å¤„ç†</h2>
<p>ç»è¿‡è´¨é‡æ§åˆ¶æªæ–½ä»¥é€‰æ‹©ç»§ç»­åˆ†æçš„ç»†èƒåï¼Œæ¥ä¸‹æ¥çš„æ­¥éª¤åŒ…æ‹¬å¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ–ã€è¯†åˆ«é«˜åº¦å¯å˜ç‰¹å¾ä»¥åŠè¿›è¡Œå°ºåº¦ç¼©æ”¾ã€‚åŒæ—¶ï¼Œè¿˜ä¼šè¿›è¡Œä¸»æˆåˆ†åˆ†æï¼Œå› ä¸ºè®¸å¤šåç»­åˆ†ææ­¥éª¤å°†åœ¨è¾ƒä½ç»´åº¦ç©ºé—´ä¸­è¿›è¡Œè®¡ç®—ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb46" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/NormalizeData.html">NormalizeData</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html">FindVariableFeatures</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, selection.method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vst"</span>, nfeatures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all.genes</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/ScaleData.html">ScaleData</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all.genes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Centering and scaling data matrix</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb48" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/RunPCA.html">RunPCA</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>å‰é¢æ‰€æœ‰æ­¥éª¤çš„åŸºæœ¬åŸç†éƒ½ä¸è´¨é‡æ§åˆ¶ç›¸å…³ï¼Œåœ¨å‰é¢çš„æ•™ç¨‹ä¸­æœ‰æ›´è¯¦ç»†çš„ä»‹ç»ã€‚</p>
</section><section id="é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡" class="level2"><h2 class="anchored" data-anchor-id="é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡">é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡</h2>
<p>é¦–è¦çš„é‡è¦å†³ç­–æ˜¯åœ¨åç»­åˆ†æä¸­ä¿ç•™å¤šå°‘ä¸ªä¸»æˆåˆ†ï¼ˆPCsï¼‰ã€‚ä¿ç•™çš„ä¸»æˆåˆ†è¶Šå¤šï¼Œä¿¡å·é‡ä¹Ÿä¼šå¢åŠ ï¼Œä½†åŒæ—¶ä¹Ÿä¼šå¢åŠ å™ªéŸ³ï¼Œå¹¶ä¸”è®¡ç®—éœ€æ±‚ä¹Ÿä¼šå¢åŠ ã€‚åœ¨åšå‡ºè¿™ä¸ªé€‰æ‹©ä¹‹å‰ï¼Œè¯·æ£€æŸ¥ä¸æ¯ä¸ªä¸»æˆåˆ†ç›¸å…³çš„åŸºå› ã€‚å­˜åœ¨ä¸ç‰¹å®šç»†èƒç±»å‹ç›¸å…³çš„åŸºå› å°†è¡¨æ˜è¯¥ä¸»æˆåˆ†å…·æœ‰ä¿¡æ¯é‡ã€‚è€Œå­˜åœ¨ä¸æ‰€æœ‰ä¸ç›¸å…³åŸºå› åç§°ç›¸å…³çš„æƒ…å†µåˆ™è¡¨æ˜ç›¸åã€‚åœ¨å¤–å‘¨è¡€å•ä¸ªæ ¸ç»†èƒï¼ˆPBMCï¼‰çš„èƒŒæ™¯ä¸‹ï¼Œæˆ‘ä»¬é¢„æœŸä¸»è¦çš„ç»†èƒç±»å‹å°†åŒ…æ‹¬Tç»†èƒã€Bç»†èƒã€NKç»†èƒã€å•æ ¸ç»†èƒç­‰ç­‰ã€‚</p>
<p>æ£€æŸ¥å‰ 10 ä¸ª PCï¼Œä½ ä¼šçœ‹åˆ°å¾ˆå¤šç†Ÿæ‚‰çš„åŸºå› åç§°ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb49" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, nfeatures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PC_ 1 
Positive:  LTB, IL32, TRAC, CD3D, TRBC2 
Negative:  FCN1, FGL2, CST3, IFI30, TYMP 
PC_ 2 
Positive:  MS4A1, CD79A, BANK1, IGHM, NIBAN3 
Negative:  IL32, GZMM, CD3D, CD7, CD247 
PC_ 3 
Positive:  GZMB, CLIC3, NKG7, GNLY, KLRD1 
Negative:  CCR7, LEF1, TRABD2A, TCF7, LTB 
PC_ 4 
Positive:  CD79B, MS4A1, GNLY, CD79A, LINC00926 
Negative:  LILRA4, CLEC4C, SERPINF1, TPM2, SCT 
PC_ 5 
Positive:  CDKN1C, HES4, CTSL, TCF7L2, BATF3 
Negative:  S100A12, ITGAM, VCAN, CES1, MGST1 
PC_ 6 
Positive:  CDKN1C, NRGN, PADI4, CKB, FCGR3A 
Negative:  CRIP1, GBP5, ISG15, NIBAN1, MAF 
PC_ 7 
Positive:  CLU, ITGB1, NRGN, LIMS1, GP1BB 
Negative:  MALAT1, CCR7, TXK, LINC02446, KLRK1 
PC_ 8 
Positive:  CDKN1C, VIM, S100A4, CKB, ITGB1 
Negative:  MAP3K7CL, SERPING1, GMPR, LGALS2, NEXN 
PC_ 9 
Positive:  HERC5, IFIT1, RSAD2, IFIT3, MX1 
Negative:  CLEC10A, FCER1A, ENHO, CD1C, CACNA2D3 
PC_ 10 
Positive:  TNFRSF13B, IGHG1, IGHA1, SSPN, IGFBP7 
Negative:  TCL1A, CD8A, TRGC2, GZMK, CD8B </code></pre>
</div>
</div>
<p>å¦ä¸€ç§å¯è§†åŒ–ä¿¡æ¯çš„æ–¹æ³•æ˜¯ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb51" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VizDimLoadings.html">VizDimLoadings</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, reduction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span>,balanced<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>è¿™æ˜¯å¦ä¸€ç§æä¾›å›¾ç¤ºè¡¨ç¤ºçš„æ–¹æ³•ã€‚ç»†èƒå’Œç‰¹å¾æ ¹æ®ä¸»æˆåˆ†åˆ†æå¾—åˆ†è¿›è¡Œæ’åºã€‚è®¾ç½®ä¸€ä¸ªç»†èƒæ•°é‡æœ‰åŠ©äºè®¡ç®—æ•ˆç‡ï¼Œå› ä¸ºå®ƒä¼šå¿½ç•¥é‚£äº›ä¿¡æ¯è¾ƒå°‘çš„æç«¯ç»†èƒã€‚å¼ºåˆ¶ä½¿å…¶å¹³è¡¡å¯åœ¨æ­£ç›¸å…³å’Œè´Ÿç›¸å…³ä¹‹é—´è·å¾—ç›¸ç­‰çš„è¡¨ç¤ºã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb52" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimHeatmap.html">DimHeatmap</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, cells <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, balanced <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb53" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimHeatmap.html">DimHeatmap</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, cells <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, balanced <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Jackstraw å›¾ç”¨äºä¼°è®¡æ¯ä¸ªä¸»æˆåˆ†æ‰€æ•è·çš„ç»“æ„çš„æ˜¾è‘—æ€§ã€‚å®ƒä¼šéšæœºå¯¹æ•°æ®çš„å­é›†è¿›è¡Œæ’åˆ—ï¼Œä»¥å»ºç«‹ç©ºå€¼åˆ†å¸ƒï¼Œå¹¶æ ¹æ®è¿™ä¸ªç©ºå€¼åˆ†å¸ƒä¼°è®¡på€¼ã€‚</p>
<p>âš ï¸ è¿™å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´æ¥æ‰§è¡Œã€‚å¦‚æœæ—¶é—´ä¸å¤Ÿï¼Œè¯·è·³è¿‡è¿™éƒ¨åˆ†ï¼Œç„¶ååªä¸“æ³¨äºæ¥ä¸‹æ¥çš„æ‹ç‚¹å›¾ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb54" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/JackStraw.html">JackStraw</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, num.replicate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/ScoreJackStraw.html">ScoreJackStraw</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/JackStrawPlot.html">JackStrawPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 28000 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>æ‹ç‚¹å›¾æ˜¯ç»å…¸çš„è®¡ç®—æœºç§‘å­¦æ–¹æ³•ï¼Œç”¨äºæ£€æŸ¥é€šè¿‡é€ä¸ªæ·»åŠ ä¸»æˆåˆ†æ¥è¡¨ç¤ºæ•°æ®ä¸­ç´¯ç§¯å˜å¼‚æ€§ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb56" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/ElbowPlot.html">ElbowPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>,ndims<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>æ ¹æ®è¿™äº›å›¾ï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨20ä¸ªä¸»æˆåˆ†ã€‚ä½†ä¹Ÿå¯ä»¥ä¸º15åˆ°30ä¹‹é—´çš„ä»»ä½•æ•°é‡æå‡ºç†ç”±ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨UMAPæ¥å¯è§†åŒ–æ•°æ®é›†ã€‚æˆ‘ä»¬æå‰è®¡ç®—UMAPï¼Œä»¥ä¾¿åœ¨éœ€è¦æ—¶ç«‹å³ä½¿ç”¨ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb57" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/RunUMAP.html">RunUMAP</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric
To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'
This message will be shown once per session</code></pre>
</div>
</div>
</section><section id="èšç±»" class="level2"><h2 class="anchored" data-anchor-id="èšç±»">èšç±»</h2>
<p>Seuraté»˜è®¤çš„èšç±»ç®—æ³•é‡‡ç”¨åŸºäºå›¾çš„èšç±»æ–¹æ³•ã€‚å®ƒå—åˆ°ä»¥å‰çš„å‘è¡¨æ–‡ç« çš„å¯å‘ï¼Œè¿™äº›æ–‡ç« åœ¨å¼€å‘å’Œæ”¹è¿›è¿™ç§æ–¹æ³•æ–¹é¢åšå‡ºäº†è´¡çŒ®ã€‚ç‰¹åˆ«æ˜¯ï¼Œ<a href="http://www.ncbi.nlm.nih.gov/pubmed/26095251">ã€ŠPhenographã€‹è®ºæ–‡</a>å¼ºçƒˆæ¨èç»™é‚£äº›å¸Œæœ›æ›´å¥½åœ°ç†è§£è¿™ç§æ–¹æ³•çš„äººã€‚ç®€è¦æ¥è¯´ï¼Œèšç±»ç®—æ³•é¦–å…ˆåœ¨PCAç©ºé—´ä¸­è®¡ç®—æ¯ä¸ªç»†èƒçš„Kä¸ªæœ€è¿‘é‚»ã€‚ç„¶åï¼Œæ ¹æ®å…±äº«é‚»å±…è®¡ç®—ç»†èƒä¹‹é—´çš„Jaccardç›¸ä¼¼æ€§ã€‚ä½¿ç”¨Louvainç®—æ³•å¯¹ä¿¡æ¯è¿›è¡Œèšåˆï¼Œä»¥ä¾¿å°†ç»†èƒè¿­ä»£åœ°åˆ†ç»„åœ¨ä¸€èµ·ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb59" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html">FindNeighbors</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Computing nearest neighbor graph</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Computing SNN</code></pre>
</div>
</div>
<p>ç¬¬äºŒä¸ªé‡è¦çš„å†³ç­–æ˜¯é€‰æ‹©èšç±»çš„åˆ†è¾¨ç‡ã€‚è¾ƒå°çš„æ•°å€¼ä¼šç”Ÿæˆæ··åˆçš„èšç±»ï¼Œè€Œè¾ƒå¤§çš„æ•°å€¼ä¼šäº§ç”Ÿè¿‡å¤šçš„èšç±»ï¼Œè¿™äº›èšç±»å¯èƒ½ä¸å¤ªå…·æœ‰æ„ä¹‰ã€‚</p>
<p>ğŸ“ å¯¹äºä½ è‡ªå·±çš„ç ”ç©¶ï¼ŒèŠ±ä¸€äº›æ—¶é—´æ¥ä¼˜åŒ–åˆ†è¾¨ç‡çš„é€‰æ‹©æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚å°è¯•ä½¿ç”¨å¤šä¸ªå€™é€‰çš„åˆ†è¾¨ç‡é€‰é¡¹æ¥è¿›è¡Œæ‰€æœ‰åç»­åˆ†æå¯èƒ½ä¼šæœ‰å¸®åŠ©ã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°è¯•ä¸‰ä¸ªä¸åŒçš„åˆ†è¾¨ç‡å€¼ï¼Œå¹¶ä½¿ç”¨clustreeæ¥ç ”ç©¶å…¶å½±å“ã€‚åœ¨è®¡ç®—å®Œèšç±»åï¼Œæˆ‘ä»¬è¿˜ä¿å­˜äº†pbmcå¯¹è±¡ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb62" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindClusters.html">FindClusters</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>object <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>,  resolution <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,  dims.use <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,  save.SNN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following arguments are not used: dims.use, save.SNN</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Suggested parameter: dims instead of dims.use</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following arguments are not used: dims.use, save.SNN</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Suggested parameter: dims instead of dims.use</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck

Number of nodes: 9729
Number of edges: 356102

Running Louvain algorithm...
Maximum modularity in 10 random starts: 0.9145
Number of communities: 16
Elapsed time: 1 seconds
Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck

Number of nodes: 9729
Number of edges: 356102

Running Louvain algorithm...
Maximum modularity in 10 random starts: 0.8655
Number of communities: 20
Elapsed time: 1 seconds
Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck

Number of nodes: 9729
Number of edges: 356102

Running Louvain algorithm...
Maximum modularity in 10 random starts: 0.8279
Number of communities: 22
Elapsed time: 1 seconds</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb68" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/wsx/Library/CloudStorage/OneDrive-shanghaitech.edu.cn/Public/data/pbmc_tutorial.rds"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/clustree/man/clustree.html">clustree</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>è¿™ä¸‰è¡Œè¡¨ç¤ºæ¯ä¸ªåˆ†è¾¨ç‡å€¼ä¸‹çš„ç»†èƒåˆ†é…æƒ…å†µã€‚æ¯è¡Œä¸­çš„èŠ‚ç‚¹å¤§å°è¡¨ç¤ºè¯¥èšç±»ä¸­çš„ç»†èƒæ•°é‡ã€‚è¡Œä¹‹é—´çš„ç®­å¤´æ˜¾ç¤ºéšç€åˆ†è¾¨ç‡çš„å¢åŠ ï¼Œèšç±»çš„åˆ†é…æƒ…å†µå¦‚ä½•å˜åŒ–ã€‚ç¨³å®šçš„èšç±»å¯èƒ½ä¼šæ›´æ”¹åç§°ï¼Œä½†æ˜¯ç»†èƒåœ¨ä¸åŒçš„åˆ†è¾¨ç‡ä¸‹ä»ç„¶ä¼šèšé›†åœ¨ä¸€èµ·ã€‚ä¸€äº›èšç±»å¯èƒ½ä¼šåˆ†è£‚æˆä¸¤ä¸ªï¼ˆæˆ–æ›´å¤šï¼‰å­èšç±»ã€‚è¿™æš—ç¤ºç€å¢åŠ åˆ†è¾¨ç‡ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ çœ‹åˆ°èšç±»ä¹‹é—´æ¥å›è·³åŠ¨çš„æƒ…å†µå¾ˆå¤šï¼Œé‚£å°±è¡¨ç¤ºç¨³å®šæ€§è¾ƒå·®ã€‚åœ¨ä½ è‡ªå·±çš„æ•°æ®ä¸­ï¼Œæœ€å¥½è¿›è¡Œè¿‡åº¦èšç±»ï¼Œç„¶åæ£€æŸ¥åŸºå› ï¼Œç„¶åæ‰‹åŠ¨é€‰æ‹©è¦åˆå¹¶çš„èšç±»ã€‚</p>
<p>æˆ‘ä»¬é€‰æ‹©åˆ†è¾¨ç‡=0.5è¿›è¡Œè¿›ä¸€æ­¥æ£€æŸ¥ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb69" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html">Idents</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RNA_snn_res.0.5</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimPlot.html">DimPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, reduction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"umap"</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="èšç±»å¯Œé›†æ ‡è®°" class="level2"><h2 class="anchored" data-anchor-id="èšç±»å¯Œé›†æ ‡è®°">èšç±»å¯Œé›†æ ‡è®°</h2>
<p>æ¥ä¸‹æ¥ï¼Œå¯¹äºæ¯ä¸ªèšç±»ï¼Œæˆ‘ä»¬æƒ³è¦æ£€æŸ¥åœ¨è¯¥èšç±»ä¸­ç›¸æ¯”å…¶ä»–ç»†èƒé«˜åº¦è¡¨è¾¾çš„ç‰¹å¾ï¼ˆä¹Ÿç§°ä¸ºæ ‡è®°æˆ–åŸºå› ï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨â€™rocâ€™æ–¹æ³•æ¥ä¼°è®¡æ¯ä¸ªæ ‡è®°çš„åˆ†ç±»èƒ½åŠ›ï¼ˆ0è¡¨ç¤ºéšæœºï¼Œ1è¡¨ç¤ºå®Œç¾ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€ä¸ªèšç±»åœ°è¿›è¡Œè¿™ä¸ªåˆ†æï¼Œä¹Ÿå¯ä»¥åŒæ—¶å¯¹æ‰€æœ‰èšç±»è¿›è¡Œåˆ†æã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb70" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cluster0.markers</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindMarkers.html">FindMarkers</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, ident.1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, logfc.threshold <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, test.use <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"roc"</span>, only.pos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>âš ï¸ å¯¹æ‰€æœ‰èšç±»æ‰§è¡Œæ­¤æ“ä½œéå¸¸è€—æ—¶ã€‚å¦‚æœä½ æƒ³ä¼‘æ¯ä¸€ä¸‹ã€‚åœ¨è¿™æ ·åšä¹‹å‰å¯åŠ¨å®ƒã€‚è®¡ç®—æ—¶é—´å¯èƒ½é•¿è¾¾30åˆ†é’Ÿã€‚å¦‚æœä½ åœ¨æ•™ç¨‹æ—¶é—´æ–¹é¢è¿è¡Œæ™šäº†ï¼Œç°åœ¨è·³è¿‡è¿™ä¸ªå’Œä¸‹é¢çš„çƒ­å›¾ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb71" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cluster.all.markers0.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindAllMarkers.html">FindAllMarkers</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, logfc.threshold <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, test.use <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"roc"</span>, only.pos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, min.pct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 6</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 8</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 9</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 10</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 13</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 14</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 15</code></pre>
</div>
</div>
<p>çƒ­å›¾ä¸ºå…±äº«é«˜åº¦è¡¨è¾¾æ ‡è®°çš„é›†ç¾¤æä¾›äº†å¾ˆå¥½çš„å›¾å½¢è¡¨ç¤ºã€‚æ³¨æ„åˆ°umapä¸­è¿™äº›é›†ç¾¤ä¹‹é—´çš„å…³ç³»äº†å—?</p>
<div class="cell">
<div class="sourceCode" id="cb88" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cluster.all.markers0.5</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cluster</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, wt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">avg_log2FC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">top5</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DoHeatmap.html">DoHeatmap</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">top5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gene</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html">NoLegend</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸€äº›æ ‡è®°ï¼Œè¿™äº›æ ‡è®°å¾€å¾€é€‚ç”¨äºPBMCæ•°æ®é›†ã€‚å…¶ä¸­è®¸å¤šæ¥è‡ª<code>cluster.all.markers0.5</code>ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb89" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">markers.to.plot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD3D"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HSPH1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SELL"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD14"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LYZ"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GIMAP5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CACYBP"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GNLY"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NKG7"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CCL5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD8A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MS4A1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD79A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FCGR3A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MS4A7"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S100A9"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HLA-DQA1"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GPR183"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PPBP"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GNG11"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TSPAN13"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IL3RA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FCER1A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CST3"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S100A12"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DotPlot.html">DotPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">markers.to.plot</span>, cols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, dot.scale <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html">RotatedAxis</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb90" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MS4A1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD79A"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb91" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NKG7"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GNLY"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb92" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FCGR3A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MS4A7"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb93" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PPBP"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-19-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb94" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FCER1A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CST3"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>   </span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-19-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb95" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD8A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD8B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD3D"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-19-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb96" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FeaturePlot.html">FeaturePlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MS4A1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GNLY"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD3E"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD14"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FCER1A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FCGR3A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LYZ"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PPBP"</span>,  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD8A"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="åŸºäºå‚è€ƒçš„èšç±»æ³¨é‡Š" class="level2"><h2 class="anchored" data-anchor-id="åŸºäºå‚è€ƒçš„èšç±»æ³¨é‡Š">åŸºäºå‚è€ƒçš„èšç±»æ³¨é‡Š</h2>
<p>åŸºäºå‚è€ƒæ•°æ®çš„èšç±»æ³¨é‡Šä¸åœ¨Seuratè½¯ä»¶åŒ…ä¸­è¿›è¡Œã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨SingleRï¼Œå¹¶é¦–å…ˆå°†Seuratæ•°æ®çš„ä¿¡æ¯è½¬æ¢ä¸ºSingleRçš„æ ¼å¼ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb97" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sce</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/AssayData.html">GetAssayData</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>object <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, assay <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RNA"</span>, slot <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ç¯‡<a href="https://pubmed.ncbi.nlm.nih.gov/30726743/">ç»å…¸è®ºæ–‡</a>ä¸­çš„æ•°æ®ï¼Œè¯¥è®ºæ–‡ä½¿ç”¨åˆ†ç±»ç»†èƒå¯¹ä¸åŒçš„å…ç–«ç»†èƒç±»å‹è¿›è¡Œäº†æ¯”è¾ƒã€‚åŸºäºå‚è€ƒæ•°æ®çš„æ³¨é‡Šå…è®¸ä¸é«˜åº¦ç²¾é€‰çš„æ•°æ®é›†è¿›è¡Œç›´æ¥æ¯”è¾ƒã€‚ç„¶è€Œï¼Œç¼ºç‚¹æ˜¯æ¨æ–­çš„ç»“æœå–å†³äºå‚è€ƒæ•°æ®é›†ä¸­å®šä¹‰çš„å†…å®¹ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb98" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">refMonaco</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/celldex/man/MonacoImmuneData.html">MonacoImmuneData</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>snapshotDate(): 2022-10-31</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>see ?celldex and browseVignettes('celldex') for documentation</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>loading from cache</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>see ?celldex and browseVignettes('celldex') for documentation</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>loading from cache</code></pre>
</div>
</div>
<p>æ•°æ®æ ¼å¼åœ¨ä¸¤ä¸ªå±‚æ¬¡ä¸Šæ˜¾ç¤ºä¿¡æ¯:ä¸»è¦ç»†èƒç±»å‹å’Œæ›´ç²¾ç»†çš„åˆ†è¾¨ç‡ä¿¡æ¯ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb104" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prediction_Monaco_main</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/SingleR/man/SingleR.html">SingleR</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>test<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sce</span>, ref<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">refMonaco</span>, clusters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html">Idents</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">refMonaco</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">label.main</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prediction_Monaco_fine</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/SingleR/man/SingleR.html">SingleR</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>test<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sce</span>, ref<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">refMonaco</span>, clusters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html">Idents</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">refMonaco</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">label.fine</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">predicted_Monaco</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>cluster<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html">Idents</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, Monaco_main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prediction_Monaco_main</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">labels</span>, Monaco_fine<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prediction_Monaco_fine</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">labels</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">predicted_Monaco</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   cluster     Monaco_main                  Monaco_fine
1        0       Monocytes          Classical monocytes
2        1    CD4+ T cells            Naive CD4 T cells
3        2       Monocytes          Classical monocytes
4        3    CD8+ T cells            Naive CD8 T cells
5        4    CD4+ T cells               Th1/Th17 cells
6        5         T cells           Non-Vd2 gd T cells
7        6         B cells  Non-switched memory B cells
8        7         B cells                Naive B cells
9        8        NK cells         Natural killer cells
10       9       Monocytes       Intermediate monocytes
11      10         T cells                   MAIT cells
12      11 Dendritic cells      Myeloid dendritic cells
13      12 Dendritic cells Plasmacytoid dendritic cells
14      13       Monocytes          Classical monocytes
15      14     Progenitors             Progenitor cells
16      15         B cells                 Plasmablasts</code></pre>
</div>
</div>


</section> ]]></description>
  <category>note</category>
  <category>scRNA-seq</category>
  <category>R</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index.html</guid>
  <pubDate>Tue, 25 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>å°è®°ï¼ˆå¾€æ˜”ï¼‰</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-25-small-notes/index.html</link>
  <description><![CDATA[ 




<p>ä»¥æ—¶é—´å€’åºçš„å½¢å¼å¤‡ä»½ä¸‹ã€Œå°è®°ã€ä¸­å†™çš„éƒ¨åˆ†è¯—ã€‚</p>
<section id="è´ºå¦»å°è®°" class="level3">
<h3 class="anchored" data-anchor-id="è´ºå¦»å°è®°">è´ºå¦»å°è®°</h3>
<p>å±±æ°´åœ¨å›å“ä½ çš„ç”Ÿè¾°ï¼Œ</p>
<p>æˆ‘ä»ä¸­çª¥æ¢ç”Ÿå‘½çš„å°è®°ã€‚</p>
<p>ç¼˜æ¥äº†â€”â€”</p>
<p>æˆ‘ä½œäº­äº­å¤æ—¥çš„è²ï¼Œ</p>
<p>ä½ ä½œå¾®é£ï¼Œ</p>
<p>è¡å¼€æˆ‘æ¹–å¿ƒã€‚</p>
</section>
<section id="å†™äºäºŒåä¹" class="level3">
<h3 class="anchored" data-anchor-id="å†™äºäºŒåä¹">å†™äºäºŒåä¹</h3>
<p>å®å²æ·»ä¹è™šæ·»åï¼Œ</p>
<p>å·²æœ›å¤©å‘½ç˜¦è‚šè¿Ÿã€‚</p>
<p>å¤©å—åœ°åŒ—ç»ˆé¡»å°½ï¼Œ</p>
<p>äººåˆ°æ¡¥å¤´æœ‰è¯€æœŸã€‚</p>
</section>
<section id="æ— é¢˜" class="level3">
<h3 class="anchored" data-anchor-id="æ— é¢˜">æ— é¢˜</h3>
<p>ç¿ ç»¿å å¢¨è‰²ï¼Œ</p>
<p>çƒŸæŸ³å…¥æ±Ÿæ³¢ã€‚</p>
<p>æ’æ°´ç¢§ç©ºå°½ï¼Œ</p>
<p>æ¨äº‘çœºå±±éƒ­ã€‚</p>
</section>
<section id="æ— é¢˜-1" class="level3">
<h3 class="anchored" data-anchor-id="æ— é¢˜-1">æ— é¢˜</h3>
<p>é›¨éª¤é£è§å¤©æ˜“å†·ï¼Œ</p>
<p>å¯’æ¨æ¼çª—å¤œæ¶é—¨ã€‚</p>
<p>é¸Ÿå«è¿Ÿèµ·éš¾è¡Œæ—©ï¼Œ</p>
<p>ä¸–äº‹æƒ…åŠ«éš¾åº¦æˆã€‚</p>
</section>
<section id="å…«æœˆåå››ä¸å¦»ç™»ç™½äº‘å±±" class="level3">
<h3 class="anchored" data-anchor-id="å…«æœˆåå››ä¸å¦»ç™»ç™½äº‘å±±">å…«æœˆåå››ä¸å¦»ç™»ç™½äº‘å±±</h3>
<p>å±±æ—æ—¥æ›³é‡‘æ˜ç­ï¼Œ</p>
<p>ä¹”æœ¨æ·±æ·±æ¾æ¶§å ã€‚</p>
<p>æ™šèµ·ä¸Šç™½äº‘ï¼Œ</p>
<p>åŒåŒæ±—æ°´æ·‹ã€‚</p>
<p>æ¥æ—¶äº‘é®æœˆï¼Œ</p>
<p>å»æ—¶æœˆåŠ¨äººã€‚</p>
<p>æ¸…é£é¢‘ç›¸é€ï¼Œ</p>
<p>äººæœˆäº†æ— ç—•ã€‚</p>
</section>
<section id="äºŒæœˆ" class="level3">
<h3 class="anchored" data-anchor-id="äºŒæœˆ">äºŒæœˆ</h3>
<p>äººé“æ±Ÿå—å¥½é¢œè‰²ï¼Œ</p>
<p>å†·é£å¹èµ·äº®æ˜¥æ³½ã€‚</p>
<p>è¿‘è§‚ç²‰èŠ±æ©åŠç»¿ï¼Œ</p>
<p>è¿œçœºä¹Œæ³¢é©»é«˜æ¥¼ã€‚</p>
<p>éª‘è¡Œé¢‘é—»é¸£ç¿ æŸ³ï¼Œ</p>
<p>æ¸¸æ€å¶å¾—å£®å¹´æ„ã€‚</p>
<p>æ„¿æ­¤äººé—´å¤šæ¬¢ä¹ï¼Œ</p>
<p>ç¬‘å£°å½’å¤„äº†ç™½å¤´ã€‚</p>


</section>

 ]]></description>
  <category>è¯—</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-25-small-notes/index.html</guid>
  <pubDate>Mon, 24 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-07-25</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-25-journal/index.html</link>
  <description><![CDATA[ 




<p>ä¸ºä»€ä¹ˆäº‹æƒ…å®¹æ˜“å †ç§¯åœ¨ä¸€èµ·å‘ç”Ÿï¼Ÿ</p>
<p>ä¸ºä»€ä¹ˆè¶Šå¿™çš„æ—¶å€™è¶Šä¸æƒ³å¿™ï¼Ÿå¿™çš„æ—¶å€™è¶Šå®¹æ˜“åˆ†æ•£ç²¾åŠ›ï¼Ÿ</p>
<p>è¿™æ˜¯äººç±»çš„ä»€ä¹ˆå¿ƒç†å‘¢ï¼Ÿ</p>
<p>é‚£äº›å…ˆåœ£å…ˆè´¤ä»¬ç©¶ç«Ÿæ˜¯å¦‚ä½•å¡‘é€ çš„å‘¢ï¼Ÿ</p>
<p>æ˜¯ä»€ä¹ˆåœ¨å‹æŠ‘ç€æ€æ½®ï¼Œæ¶æ‰“ç€è‡ªä¿¡ï¼Ÿ</p>
<p>æ€æ ·æ‰èƒ½æŠŠæƒ³åšçš„çœŸæ­£åšå¥½ï¼Ÿä¸å…³æ³¨åˆ«äººï¼Ÿå¤šå…³æ³¨åˆ«äººï¼Ÿ</p>
<p>å“ªé‡Œæ˜¯æ™ºæ…§çš„çœŸè°›ï¼Œç”Ÿå‘½çš„å¦™é—¨ï¼Ÿ</p>



 ]]></description>
  <category>journal</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-25-journal/index.html</guid>
  <pubDate>Mon, 24 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>å­¦æœ¯çš„ä»·å€¼è§‚</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-21-academic-culture/index.html</link>
  <description><![CDATA[ 




<p>è¿™ç¯‡å°æ–‡ä¸»è¦æ˜¯è®°å½•ã€æ¨èå’Œåˆ†äº«ä¸‹å´æ€æ¶µ Lab çš„ç§‘å­¦ä»·å€¼è§‚æ¡ç›®ã€‚</p>
<p><img src="https://shixiangwang.github.io/posts/2023-07-21-academic-culture/wulab_culture.jpg" class="img-fluid"></p>
<p>æˆ‘è§‰å¾—éå¸¸å¥½ï¼Œä¹Ÿéå¸¸ä½©æœå´æ€æ¶µåˆ›å»ºè¿™ä¸ªæ¡ç›®å’Œå¯¹æ¯ä¸ªè¿›å…¥ Lab çš„æˆå‘˜è¿›è¡Œå®£è¯»ã€‚</p>
<p>æœ‰æ—¶å€™ï¼Œç§‘ç ”å·¥ä½œçš„ç¯å¢ƒçš„å–§åš£è®©äººç…ç†¬ã€‚åœ¨å¿ƒä¸­æ‚¬ç€ä¸€æŠŠä»·å€¼ä¹‹å‰‘ğŸ—¡ï¸ï¼Œæˆ‘è§‰å¾—æ—¢æ˜¯å‘Šè¯«ï¼Œä¹Ÿæ˜¯æŒ‡å¼•ã€‚ è¿™æŠŠå‰‘æœ‰ç¦»å¾—è¿‘å’Œç¦»å¾—è¿œçš„æ—¶å€™ï¼Œä½†å¦‚æœæ²¡æœ‰å®ƒï¼Œæˆ‘ä»¬çš„å¿ƒä¸­ä¼šç¼ºä¹ç»ˆæç›®æ ‡ğŸ¯ã€‚ ç§‘å­¦çš„è·¯ï¼Œæ˜¯æ°¸æ— æ­¢å¢ƒçš„ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨å¯»è§…ã€æŒ£æ‰ã€æˆé•¿ï¼Œä¹Ÿå¼¯å¼¯æ›²æ›²åœ°èµ°å‘å²æœˆé•¿æ²³çš„ä¸‹ä¸€æ­¥ï¼Œ ä½†æ˜¯å¦åœ¨å‰è¿›ã€æ˜¯å¦åœ¨åé€€ï¼Œæ˜¯å¦èƒ½æ°¸è¿œå‰è¿›ã€æ˜¯å¦ä¼šæ°¸è¿œåé€€ï¼ŒçœŸçš„ä¸çŸ¥é“ã€‚</p>
<p>å½“å‰ï¼Œå…¨å›½è¿›å…¥äº†â€œå·â€æ—¶ä»£ï¼Œrespect science value, keep deep thinkã€‚</p>



 ]]></description>
  <category>academic</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-21-academic-culture/index.html</guid>
  <pubDate>Thu, 20 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>ä½ è®¤åŒç”Ÿç‰©ä¿¡æ¯å­¦ä¸å±äºç§‘å­¦å—ï¼Ÿ</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-21-how-do-you-think-bioinformatics-in-science/index.html</link>
  <description><![CDATA[ 




<p><img src="https://shixiangwang.github.io/posts/2023-07-21-how-do-you-think-bioinformatics-in-science/snapshot_of_gu_twitter.jpg" class="img-fluid"></p>
<p>åˆšçœ‹åˆ° Zuguang Gu å‘çš„æ¨æ–‡ï¼Œå””ï¼Œå›½å†…ç”Ÿç‰©å­¦æœ¯ç•Œæœ‰è¿™ç§çœ‹æ³•æˆ‘æ˜¯ç”Ÿæ°”çš„ï¼Œå¹¶è®¤ä¸ºå¯è€»ã€‚ å› ä¸ºè¿™é‡Œçš„æŸä¸ªç ”ç©¶æœºæ„åœ¨æ”¶åˆ°æ±‚èŒä¿¡æ—¶ï¼Œéƒ½æ²¡æœ‰äº†è§£è¿‡è¿™ä¸ªé¢†åŸŸå’Œå®ƒçš„è´¡çŒ®å°±å¦„ä¸‹è¯„åˆ¤ã€‚ è¿™ä½“ç°ä¸€ç§è‡ªå‚²ä¸æ— çŸ¥ã€‚å°±æ²¡æœ‰æƒ³è¿‡ä¸–ç•Œå­˜åœ¨å³æœ‰ç†ç”±å—ï¼Ÿè¯„ä¼°å­¦æœ¯æ±‚èŒè€…è€ƒè™‘çš„ä¸åº”è¯¥æ˜¯ å­¦ç§‘å»ºè®¾çš„å¥‘åˆåº¦ï¼Œæ±‚èŒäººçš„ç§‘ç ”æ€åº¦ã€ç»å†ã€æˆæœå—ï¼Ÿ</p>
<p>å¦‚æœå¯¹æŠ€æœ¯çš„åŸºç¡€æ¢ç´¢ä¸å±äºç§‘å­¦èŒƒç•´ï¼Œé‚£å½“å‰çƒ­é—¨æ”¹é€ ä¸–ç•Œçš„ä¼Ÿå¤§æŠ€æœ¯ï¼Œæ¯”å¦‚CRISPRï¼Œé‚£äº›ç ”ç©¶ã€ä¼˜åŒ–å’Œåˆ©ç”¨å®ƒçš„äººæ˜¯ä¸æ˜¯ä¹Ÿéƒ½ä¸æ˜¯åœ¨åšç§‘å­¦å‘¢ï¼ŸğŸ˜„</p>
<p>é‚£äº›åœ¨å®éªŒå®¤æ¬ç –çš„æ‰“å·¥äººï¼Œé‚£äº›åœ¨æè›‹ç™½çš„ç»“æ„ç”Ÿç‰©å­¦ç ”ç©¶ç”Ÿï¼Œé‚£äº›å°†è¢«æŠ€æœ¯/æœºå™¨å–ä»£çš„ç§‘ç ”å²—ä½ï¼Œä»–ä»¬éƒ½ä¸å±äºç§‘ç ”å—ï¼Ÿ</p>
<p>å­¦æœ¯ï¼Œæ°¸è¿œæ˜¯å¯¹çŸ¥è¯†å’Œåˆ›æ–°æ— ç©·æ¢ç´¢çš„è´¡çŒ®ï¼Œè€Œæ— å…³æ–¹å¼ã€‚</p>
<p>æˆ‘å…¶å®æ„ˆåŠ è®¤è¯†åˆ°ï¼Œå­¦æœ¯ç•Œï¼Œç‰¹åˆ«æ˜¯å›½å†…çš„ï¼Œè¿˜æ˜¯äººçš„æ±Ÿæ¹–ã€‚å…³äºäººï¼Œæˆ‘æ˜¯æ—¢é„™å¤·åˆèµç¾ã€‚ æˆ‘ä¹Ÿä¸çŸ¥é“æœªæ¥å¦‚è½å¶çš„æˆ‘ä¼šé£˜å‘ä½•æ–¹ï¼Œä¸”è¡Œä¸”çœ‹ï¼Œä½†æˆ‘è¶Šæ¥è¶Šæ„Ÿè§‰ï¼Œå°½åŠ›ä¿æŒä¸€é¢—â€œç«¥å¿ƒâ€æ‰èƒ½ä¸è´Ÿç”Ÿå‘½ã€‚</p>



 ]]></description>
  <category>thought</category>
  <category>academic</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-21-how-do-you-think-bioinformatics-in-science/index.html</guid>
  <pubDate>Thu, 20 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-07-20</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-20-journal/index.html</link>
  <description><![CDATA[ 




<p>ä»Šå¤©å¾ˆæ˜¯çŠ¯å›°ğŸ˜ªï¼Œå¾ˆå›°ã€‚</p>
<p>å¯èƒ½å› ä¸ºè¦æ—©èµ·æ‰¾äººç­¾å­—ï¼Œä¸­åˆç¡å¾—æ˜æ˜æ²‰æ²‰ã€‚</p>
<p>å¯èƒ½ä»Šå¤©æ—©ä¸Šä¸‹åˆéƒ½æœ‰ä¼šè®®ï¼Œåä¹…åçš„éº»ç—¹ã€‚</p>
<p>å¯èƒ½ä»Šå¤©ç²¾ç¥å¤ªè¿‡ç´§ç»·ï¼Œç«™ä¸­ç‰¹åˆ«èµ„åŠ©æ²¡ä¸Šï¼Œåˆä¸€ç›´åœ¨ç¼–å†™å’Œæµ‹è¯•åˆ†ææµç¨‹ã€‚</p>
<p>æ€»ä¹‹ï¼Œä»Šå¤©ç¡®å®å¾ˆçŠ¯å›°ã€‚ä¸€å¤©çœ‹æ˜¯ä»€ä¹ˆéƒ½æ²¡åšï¼Œä½†å¥½æ­¹æœ‰äº†è®°å½•ï¼Œè®°å½•ä»Šå¤©å¤§ä½“å‘ç”Ÿè¿‡ä»€ä¹ˆã€‚</p>
<p>ğŸ˜ª</p>



 ]]></description>
  <category>journal</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-20-journal/index.html</guid>
  <pubDate>Wed, 19 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-07-18</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-18-journal/index.html</link>
  <description><![CDATA[ 




<p>Without hard work, nothing grows but weeds.</p>



 ]]></description>
  <category>journal</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-18-journal/index.html</guid>
  <pubDate>Mon, 17 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>Single-cell Workshop 2021 - 01 - scRNASeq åˆ†æåŸºç¡€</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index.html</link>
  <description><![CDATA[ <p>å­¦ä¹ èµ„æ–™ï¼š<a href="https://holab-hku.github.io/Fundamental-scRNA/" class="uri">https://holab-hku.github.io/Fundamental-scRNA/</a></p>
<section id="å‡†å¤‡" class="level2"><h2 class="anchored" data-anchor-id="å‡†å¤‡">å‡†å¤‡</h2>
<section id="è½¯ä»¶åŒ…" class="level3"><h3 class="anchored" data-anchor-id="è½¯ä»¶åŒ…">è½¯ä»¶åŒ…</h3>
<p>è½½å…¥ä¸‹é¢çš„åŒ…ï¼Œå¦‚æœæ²¡æœ‰å°±å…ˆå®‰è£…ä¸‹ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat">Seurat</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Attaching SeuratObject</code></pre>
</div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://hhoeflin.github.io/hdf5r/">hdf5r</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
</section><section id="æ•°æ®" class="level3"><h3 class="anchored" data-anchor-id="æ•°æ®">æ•°æ®</h3>
<p>ä¸‹è½½æ•°æ®ï¼š</p>
<blockquote class="blockquote">
<p>Data used in this material is a 10k PBMC data getting from <a href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">10x Genomics website</a></p>
<p><a href="https://github.com/holab-hku/Fundamental-scRNA/blob/master/data/10k_PBMC.h5" class="uri">https://github.com/holab-hku/Fundamental-scRNA/blob/master/data/10k_PBMC.h5</a></p>
</blockquote>
</section></section><section id="å•ç»†èƒæŠ€æœ¯ä»‹ç»" class="level2"><h2 class="anchored" data-anchor-id="å•ç»†èƒæŠ€æœ¯ä»‹ç»">å•ç»†èƒæŠ€æœ¯ä»‹ç»</h2>
<section id="æŠ€æœ¯æµç¨‹" class="level3"><h3 class="anchored" data-anchor-id="æŠ€æœ¯æµç¨‹">æŠ€æœ¯æµç¨‹</h3>
<p>å•ç»†èƒRNAæµ‹åºï¼ˆscRNA-seqï¼‰åŒ…æ‹¬ä¸€ç³»åˆ—æŠ€æœ¯ï¼Œä»¥äº§ç”Ÿè®¸å¤šå•ä¸ªç»†èƒçš„å…¨åŸºå› ç»„è¡¨è¾¾æ•°æ®ã€‚</p>
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/https:/encyclopedia.pub/media/item_content/202206/62bc1112b6b12biosensors-12-00450-g001.png" class="img-fluid"></p>
</section><section id="ç»†èƒåˆ†ç¦»" class="level3"><h3 class="anchored" data-anchor-id="ç»†èƒåˆ†ç¦»">ç»†èƒåˆ†ç¦»</h3>
<p>æ ¹æ®æŠ€æœ¯ä¸»è¦å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šDroplet-based å’Œ Non droplet-basedã€‚</p>
<p>Droplet-basedï¼š</p>
<ul>
<li>ç»„ç»‡æ ·å“å¿…é¡»è§£ç¦»æˆæ‚¬æµ®æ¶²</li>
<li>ç»†èƒå°†è¢«å•ç‹¬å°è£…æˆä¸€ä¸ªæ²¹åŒ…æ°´æ»´</li>
<li>é«˜é€šé‡ï¼Œä½æˆæœ¬</li>
<li>ç›¸å…³æŠ€æœ¯ï¼šDrop-seq (Macosko et al.&nbsp;2015), inDrop (Klein et al.&nbsp;2015), Chromium 10X (Zheng et al.&nbsp;2017)</li>
</ul>
<p>Non droplet-basedï¼š</p>
<ul>
<li>Smart-seq2 (RamskÃ¶ld et al.&nbsp;2012)ï¼šç”¨å¾®å‹æ¯›ç»†ç®¡ç§»æ¶²å™¨æ‰‹å·¥ç»†èƒå–æ ·</li>
<li>CEL-seq (Hashimshony et al.&nbsp;2012)ï¼šå•ä¸ªç»†èƒè¢«æ·»åŠ åˆ°è¯•ç®¡ä¸­ï¼›ç¬¬ä¸€ä¸ªä»‹ç»äº†æ¡å½¢ç å’ŒRNAèšåˆ</li>
<li>MARS-seq (Jaitin et al.&nbsp;2014)æ˜¯ç¬¬ä¸€ä¸ªä½¿ç”¨FACSå°†å•ç»†èƒåˆ†ç¦»åˆ°å•å­”ä¸­çš„æ–¹æ³•ï¼Œä¼˜åŒ–ç‰ˆMARS-seq2 (Keren-Shaul et al.&nbsp;2019)çš„æ¨å‡ºæˆæœ¬æ›´ä½ï¼Œå¯é‡å¤æ€§æ›´é«˜ï¼Œäº•é—´æ±¡æŸ“æ›´å°‘</li>
</ul>
<p>ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€äº›å¸¸è§çš„å•ç»†èƒåˆ†ç¦»æŠ€æœ¯ï¼ˆHwang, Lee, and Bang 2018ï¼‰</p>
<div style="background-color: white; padding: 10px;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/https:/holab-hku.github.io/Fundamental-scRNA/figs/seq_techs.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Single Cell Isolation (modified from Hwang, Lee, and Bang 2018)</figcaption></figure>
</div>
</div>
</section><section id="æ¡å½¢ç å’Œå”¯ä¸€åˆ†å­æ ‡è¯†ç¬¦umi" class="level3"><h3 class="anchored" data-anchor-id="æ¡å½¢ç å’Œå”¯ä¸€åˆ†å­æ ‡è¯†ç¬¦umi">æ¡å½¢ç å’Œå”¯ä¸€åˆ†å­æ ‡è¯†ç¬¦ï¼ˆUMIï¼‰</h3>
<p>åŒç«¯æµ‹åºè¾“å‡ºä¸¤ä¸ª fastq æ–‡ä»¶ï¼Œåˆ†åˆ«å¯¹åº”æµ‹åºçš„5â€²å’Œ3â€²æ–¹å‘ã€‚ä½¿ç”¨è¿™ç§æµ‹åºæŠ€æœ¯ï¼Œé…å¯¹çš„ç¬¬ä¸€ä¸ªreadæ€»æ˜¯ä¸å¼•ç‰©çš„ç»†èƒï¼ˆæ¡å½¢ç +UMIï¼‰éƒ¨åˆ†ä¸€è‡´ã€‚</p>
<div style="background-color: white; padding: 10px;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/https:/holab-hku.github.io/Fundamental-scRNA/figs/biasedreads.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Biased paired-end reads (David Tse et.al)</figcaption></figure>
</div>
</div>
<p>æ ¹æ®è·å¾—çš„ç»†èƒæ¡å½¢ç ã€UMI å’Œ cDNA çš„ readsï¼Œæˆ‘ä»¬å¯ä»¥ä¼°è®¡è½¬å½•ç‰©çš„ä¸°åº¦ã€‚è¿™å…è®¸ mapping ç®—æ³•åŒºåˆ†å“ªäº›åºåˆ—æ˜¯æ¡å½¢ç ï¼Œå“ªäº›æ˜¯è½¬å½•åºåˆ—ã€‚å› æ­¤ï¼Œåœ¨ç¡®å®šç»†èƒæ¡å½¢ç å’Œ UMI æ¡å½¢ç åºåˆ—çš„é•¿åº¦å’Œä½ç½®æ—¶ï¼Œè¯†åˆ«ç”¨äºæµ‹åºçš„æ–‡åº“åˆ¶å¤‡åŒ–å­¦æ–¹æ³•éå¸¸é‡è¦ã€‚</p>
<p>ä¸ºäº†è·å¾— UMIs çš„è®¡æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é¦–å…ˆé€šè¿‡ç»†èƒæ¡å½¢ç å¯¹ reads è¿›è¡Œåˆ†ç»„ï¼Œç„¶åå¯¹é½ cDNA reads å¹¶ä½¿ç”¨ UMIs å¯¹æ¯ä¸ªç»†èƒæ¯ä¸ªåŸºå› çš„ç‹¬ç‰¹åˆ†å­è¿›è¡Œè®¡æ•°ã€‚</p>
<div style="background-color: white; padding: 10px;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/https:/holab-hku.github.io/Fundamental-scRNA/figs/biasedreads2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Grouping barcodes to assign reads to cells (modified from David Tse et.al)</figcaption></figure>
</div>
</div>
<p>å¯¹ç»†èƒæ¡å½¢ç å’Œ UMIs çš„åˆ†æåŒ…æ‹¬åœ¨æ ¡å‡†è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­ä»‹ç»æ›´å¤šå†…å®¹ã€‚</p>
</section><section id="å¹¿æ³›åº”ç”¨çš„scrna-seqæŠ€æœ¯æ±‡æ€»" class="level3"><h3 class="anchored" data-anchor-id="å¹¿æ³›åº”ç”¨çš„scrna-seqæŠ€æœ¯æ±‡æ€»">å¹¿æ³›åº”ç”¨çš„scRNA-seqæŠ€æœ¯æ±‡æ€»</h3>
<table class="table">
<thead><tr class="header">
<th>Methods</th>
<th>Transcript coverage</th>
<th>UMI possibility</th>
<th>Strand specific</th>
<th>References</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Tang method</td>
<td>Nearly full-length</td>
<td>No</td>
<td>No</td>
<td>Tang et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-tang2009mrna">2009</a>)</td>
</tr>
<tr class="even">
<td>Quartz-Seq</td>
<td>Full-length</td>
<td>No</td>
<td>No</td>
<td>Sasagawa et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-sasagawa2013quartz">2013</a>)</td>
</tr>
<tr class="odd">
<td>SUPeR-seq</td>
<td>Full-length</td>
<td>No</td>
<td>No</td>
<td>X. Fan et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-fan2015single">2015</a>)</td>
</tr>
<tr class="even">
<td>Smart-seq</td>
<td>Full-length</td>
<td>No</td>
<td>No</td>
<td>RamskÃ¶ld et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-ramskold2012full">2012</a>)</td>
</tr>
<tr class="odd">
<td>Smart-seq2</td>
<td>Full-length</td>
<td>No</td>
<td>No</td>
<td>Picelli et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-picelli2013smart">2013</a>)</td>
</tr>
<tr class="even">
<td>MATQ-seq</td>
<td>Full-length</td>
<td>Yes</td>
<td>Yes</td>
<td>Sheng et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-sheng2017effective">2017</a>)</td>
</tr>
<tr class="odd">
<td>STRT-seq STRT/C1</td>
<td>5â€²-only</td>
<td>Yes</td>
<td>Yes</td>
<td>Islam et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-islam2011characterization">2011</a>)</td>
</tr>
<tr class="even">
<td>CEL-seq</td>
<td>3â€²-only</td>
<td>Yes</td>
<td>Yes</td>
<td>Hashimshony et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-hashimshony2012cel">2012</a>)</td>
</tr>
<tr class="odd">
<td>CEL-seq2</td>
<td>3â€²-only</td>
<td>Yes</td>
<td>Yes</td>
<td>Hashimshony et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-hashimshony2016cel">2016</a>)</td>
</tr>
<tr class="even">
<td>MARS-seq</td>
<td>3â€²-only</td>
<td>Yes</td>
<td>Yes</td>
<td>Jaitin et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-jaitin2014massively">2014</a>)</td>
</tr>
<tr class="odd">
<td>CytoSeq</td>
<td>3â€²-only</td>
<td>Yes</td>
<td>Yes</td>
<td>H. C. Fan, Fu, and Fodor (<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-fan2015combinatorial">2015</a>)</td>
</tr>
<tr class="even">
<td>Drop-seq</td>
<td>3â€²-only</td>
<td>Yes</td>
<td>Yes</td>
<td>Macosko et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-macosko2015highly">2015</a>)</td>
</tr>
<tr class="odd">
<td>InDrop</td>
<td>3â€²-only</td>
<td>Yes</td>
<td>Yes</td>
<td>Klein et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-klein2015droplet">2015</a>)</td>
</tr>
<tr class="even">
<td>Chromium</td>
<td>3â€²-only</td>
<td>Yes</td>
<td>Yes</td>
<td>Zheng et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-zheng2017massively">2017</a>)</td>
</tr>
<tr class="odd">
<td>SPLiT-seq</td>
<td>3â€²-only</td>
<td>Yes</td>
<td>Yes</td>
<td>Rosenberg et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-rosenberg2018single">2018</a>)</td>
</tr>
<tr class="even">
<td>sci-RNA-seq</td>
<td>3â€²-only</td>
<td>Yes</td>
<td>Yes</td>
<td>Cao et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-cao2017comprehensive">2017</a>)</td>
</tr>
<tr class="odd">
<td>Seq-Well</td>
<td>3â€²-only</td>
<td>Yes</td>
<td>Yes</td>
<td>Gierahn et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-gierahn2017seq">2017</a>)</td>
</tr>
<tr class="even">
<td>DroNC-seq</td>
<td>3â€²-only</td>
<td>Yes</td>
<td>Yes</td>
<td>Habib et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-habib2017massively">2017</a>)</td>
</tr>
<tr class="odd">
<td>Quartz-Seq2</td>
<td>3â€²-only</td>
<td>Yes</td>
<td>Yes</td>
<td>Sasagawa et al.&nbsp;(<a href="https://holab-hku.github.io/Fundamental-scRNA/background.html#ref-sasagawa2018quartz">2018</a>)</td>
</tr>
</tbody>
</table></section></section><section id="é¢„å¤„ç†å’Œè´¨é‡æ§åˆ¶" class="level2"><h2 class="anchored" data-anchor-id="é¢„å¤„ç†å’Œè´¨é‡æ§åˆ¶">é¢„å¤„ç†å’Œè´¨é‡æ§åˆ¶</h2>
<section id="fastq-æ–‡ä»¶" class="level3"><h3 class="anchored" data-anchor-id="fastq-æ–‡ä»¶">FASTQ æ–‡ä»¶</h3>
<p>åŸå§‹ RNA æµ‹åºæ•°æ®å¯èƒ½åœ¨ <a href="https://sapac.support.illumina.com/bulletins/2016/04/fastq-files-explained.html">FASTQ</a> æ–‡ä»¶ä¸­ã€‚å®ƒæ˜¯ä¸€ç§åŸºäºæ–‡æœ¬çš„æ ¼å¼ï¼Œç”¨äºå­˜å‚¨ç”±å•å­—æ¯ä»£ç è¡¨ç¤ºçš„è¯»åºåˆ—ã€‚ FASTQ æ–‡ä»¶ä¸­çš„åºåˆ—ä»¥<code>@</code>ç¬¦å·å¼€å¤´çš„readIDå¼€å§‹ï¼Œç„¶åæ˜¯åºåˆ—æ•°æ®è¡Œï¼Œä¸€ä¸ªç®€å•çš„åŠ å·<code>+</code>åˆ†éš”ç¬¦å’Œç¢±åŸºè´¨é‡åˆ†æ•°ã€‚</p>
<p>å®ƒä»¥ä»¥ä¸‹æ ¼å¼è¡¨ç¤º:</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb8-1">@ReadID</span>
<span id="cb8-2">READ SEQUENCE</span>
<span id="cb8-3">+</span>
<span id="cb8-4">SEQUENCING QUALITY SCORES</span></code></pre></div>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œfastq æ–‡ä»¶æ˜¯ä½¿ç”¨è´¨é‡æ§åˆ¶å·¥å…·ï¼ˆå¦‚ <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FastQC</a>ï¼‰è¿›è¡Œé¢„å¤„ç†çš„ã€‚è¿™å°†è¾“å‡ºä¸€ç³»åˆ—è¯„ä¼°åºåˆ— reads è´¨é‡çš„æŒ‡æ ‡ã€‚</p>
</section><section id="cell-ranger" class="level3"><h3 class="anchored" data-anchor-id="cell-ranger">Cell Ranger</h3>
<p><a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger">Cell Ranger</a> æ˜¯ä¸€ç»„åˆ†æç®¡é“ï¼Œç”¨äºå¤„ç† Chromium å•ç»†èƒæ•°æ®ä»¥å¯¹é½ readsï¼Œç”Ÿæˆç‰¹å¾æ¡å½¢ç çŸ©é˜µï¼Œæ‰§è¡Œèšç±»å’Œå…¶ä»–äºŒæ¬¡åˆ†æç­‰ç­‰ã€‚ å®ƒå¸®åŠ©æˆ‘ä»¬ç”Ÿæˆ RNA reads è®¡æ•°çŸ©é˜µï¼Œæˆ‘ä»¬å°†åœ¨å­¦ä¹ ä¸­ä½¿ç”¨ã€‚</p>
<p>ä¸€äº›æ¦‚å¿µï¼š</p>
<ul>
<li>GEM å­”ï¼ˆä»¥å‰ç§°ä¸º GEM ç»„ï¼‰ï¼šæ¥è‡ªå•ä¸ª 10x Chromiumâ„¢ èŠ¯ç‰‡é€šé“çš„åˆ†éš”å•å…ƒï¼ˆå‡èƒ¶é¢—ç²’æ‚¬æµ®æ¶²ï¼‰é›†åˆã€‚å¯ä»¥ä»ä¸€ä¸ª GEM å­”ä¸­è·å¾—ä¸€ä¸ªæˆ–å¤šä¸ªæµ‹åºæ–‡åº“ã€‚</li>
<li>æ–‡åº“ï¼ˆæˆ–æµ‹åºæ–‡åº“ï¼‰ï¼šä»å•ä¸ª GEM å­”ä¸­åˆ¶å¤‡çš„å¸¦æœ‰ 10x æ¡å½¢ç çš„æµ‹åºæ–‡åº“ã€‚å€ŸåŠ©ç‰¹å¾æ¡å½¢ç æˆ– V(D)J åˆ†æï¼Œå¯ä»¥ä»åŒä¸€ä¸ª GEM å­”ä¸­åˆ›å»ºå¤šä¸ªæ–‡åº“ã€‚æ–‡åº“ç±»å‹å¯èƒ½åŒ…æ‹¬åŸºå› è¡¨è¾¾ã€æŠ—ä½“æ•è·ã€CRISPR å¼•å¯¼æ•è·ã€TCR å¯Œé›†ç­‰ã€‚</li>
<li>æµ‹åº Runï¼ˆæˆ– Flowcellï¼‰: A flowcell containing data from one sequencing instrument run.ï¼ˆè¿™ä¸ªä»è‹±æ–‡ç›´è¯‘ä¸Šå¾ˆéš¾ç†è§£ï¼Œé€šä¿—çš„è¯´å°±æ˜¯ä¸€æ¬¡ä¸Šæœºæµ‹åºå¾—åˆ°çš„æ•°æ®æµï¼‰</li>
</ul>
<section id="é€šç”¨æµç¨‹" class="level4"><h4 class="anchored" data-anchor-id="é€šç”¨æµç¨‹">é€šç”¨æµç¨‹</h4>
<p>ä» Chromium 10X ç®¡é“è·å¾—çš„å•ç»†èƒæ•°æ®å¯ä»¥ä½¿ç”¨ cellranger é€šè¿‡ä»¥ä¸‹å·¥ä½œæµç¨‹è¿›è¡Œå¤„ç†ã€‚</p>
<div style="background-color: white; padding: 10px;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/https:/holab-hku.github.io/Fundamental-scRNA/figs/cellranger_workflow.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Cellranger Workflow (taken from the cellranger website)</figcaption></figure>
</div>
</div>
</section><section id="è¾“å‡ºæ–‡ä»¶" class="level4"><h4 class="anchored" data-anchor-id="è¾“å‡ºæ–‡ä»¶">è¾“å‡ºæ–‡ä»¶</h4>
<p>ä¸‹é¢æ˜¯æˆ‘ä»¬å°†ä» cellranger è·å¾—çš„è¾“å‡ºæ–‡ä»¶å¤¹ã€‚outs æ–‡ä»¶å¤¹åŒ…å«æœ€ç»ˆçš„ç®¡é“è¾“å‡ºæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬æˆ‘ä»¬éœ€è¦ç”¨äºä¸‹æ¸¸åˆ†æçš„å†…å®¹ã€‚</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/https:/holab-hku.github.io/Fundamental-scRNA/figs/cellranger_output.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Overview of the folder generate from cellranger</figcaption></figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/https:/holab-hku.github.io/Fundamental-scRNA/figs/cellranger_output2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Overview of the outs folder</figcaption></figure>
</div>
<p>ä»¥ä¸Šæ˜¯æˆ‘ä»¬å¯ä»¥åœ¨outsæ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°çš„å†…å®¹ã€‚å®ƒåŒ…å«äº†ä¸€äº›æµ‹åºæ•°æ®çš„æ€»ç»“ä¿¡æ¯ï¼Œæ³¨é‡Šçš„è¯»å–åºåˆ—ï¼Œä»¥åŠæˆ‘ä»¬é€šå¸¸å·¥ä½œçš„åŸºå› è¡¨è¾¾çŸ©é˜µã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬æƒ³çœ‹çš„ä¸€äº›é‡è¦çš„è¾“å‡ºæ–‡ä»¶ã€‚</p>
<ul>
<li><a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/output/matrices">Matrices</a></li>
<li><a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/output/summary">Web Summary .html</a></li>
<li><a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/output/analysis">Secondary Analysis CSV</a></li>
<li><a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/output/bam">BAM</a></li>
<li><a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/output/molecule_info">Molecule Info (h5)</a></li>
<li><a href="https://support.10xgenomics.com/single-cell-gene-expression/software/visualization/latest/what-is-loupe-cell-browser">Loupe File (.cloupe)</a></li>
</ul>
<p><strong>çŸ©é˜µ</strong></p>
<p>æµ‹åºæ—¶ï¼ŒChromium 10X ä¸ä»…å¯¹è½¬å½•ç»„è¿›è¡Œæµ‹åºï¼Œè¿˜å¯¹ä»»ä½•å¯èƒ½çš„åˆ†å­è¿›è¡Œæµ‹åºã€‚è¿™å°±å¯¼è‡´äº†èƒŒæ™¯æ¡å½¢ç çš„å­˜åœ¨ã€‚ç»†èƒç›¸å…³æ¡å½¢ç æ˜¯cellranger è®¤ä¸ºæ ‡è®°æ¥è‡ªçœŸå®ç»†èƒçš„è½¬å½•ç»„è€Œä¸æ˜¯èƒŒæ™¯çš„æ¡å½¢ç ã€‚</p>
<p>å¯¹äºä¸åŒç‰ˆæœ¬çš„cellrangerï¼Œä½¿ç”¨ä¸åŒçš„ç®—æ³•æ¥æ£€æµ‹ç»†èƒç›¸å…³æ¡å½¢ç ã€‚ä¸€èˆ¬çš„æƒ³æ³•æ˜¯ï¼Œç»†èƒçš„æ¡å½¢ç åº”è¯¥æ¯”èƒŒæ™¯æ¡å½¢ç æœ‰æ›´å¤šçš„è½¬å½•æœ¬è®¡æ•°ã€‚æ›´å¤šä¿¡æ¯è¯·è®¿é—®ï¼šhttps://kb.10xgenomics.com/hc/en-us/articles/115003480523-How-are-barcodes-classified-as-cell-associated-ã€‚</p>
<p>cellrangerç®¡é“è¾“å‡ºä¸¤ç§ç±»å‹çš„ç‰¹å¾æ¡å½¢ç çŸ©é˜µï¼š</p>
<ul>
<li>æœªç»è¿‡æ»¤çš„ç‰¹å¾æ¡å½¢ç çŸ©é˜µå­˜å‚¨åœ¨raw_feature_bc_matrixï¼ˆ1-1ï¼‰æ–‡ä»¶å¤¹ä¸‹ã€‚å®ƒåŒ…å«äº†æ¥è‡ªå·²çŸ¥è‰¯å¥½æ¡å½¢ç åºåˆ—å›ºå®šåˆ—è¡¨çš„æ¯ä¸ªæ¡å½¢ç ï¼Œå…¶ä¸­è‡³å°‘æœ‰ä¸€ä¸ªè¯»å–ï¼Œè¿™æ„å‘³ç€å®ƒåŒ…æ‹¬èƒŒæ™¯å’Œä¸ç»†èƒç›¸å…³çš„æ¡å½¢ç ã€‚</li>
<li>ç»è¿‡è¿‡æ»¤çš„ç‰¹å¾æ¡å½¢ç çŸ©é˜µå­˜å‚¨åœ¨filtered_feature_bc_matrixï¼ˆ1-2ï¼‰æ–‡ä»¶å¤¹ä¸‹ã€‚å®ƒåªåŒ…æ‹¬å·²æ£€æµ‹åˆ°çš„ä¸ç»†èƒç›¸å…³çš„æ¡å½¢ç ã€‚</li>
</ul>
<p>raw_feature_bc_matrixå’Œfiltered_feature_bc_matrixæ–‡ä»¶å¤¹ä¸­éƒ½åŒ…å«ä¸‰ä¸ªæ–‡ä»¶ã€‚</p>
<ul>
<li>matrix.mtx.gzæ–‡ä»¶ä»¥ç¨€ç–çŸ©é˜µçš„å½¢å¼å­˜å‚¨ reads è®¡æ•°ï¼Œå…¶ä¸­æ¯ä¸€è¡Œè¡¨ç¤ºscRNA-seqæ•°æ®ä¸­çš„ä¸€ä¸ªåŸºå› ï¼Œæ¯ä¸€åˆ—è¡¨ç¤ºä¸€ä¸ªç»†èƒã€‚è¡Œç´¢å¼•çš„ä¿¡æ¯å­˜å‚¨åœ¨features.tsv.gzæ–‡ä»¶ä¸­ï¼Œè€Œåˆ—ç´¢å¼•çš„ä¿¡æ¯å­˜å‚¨åœ¨barcodes.tsv.gzæ–‡ä»¶ä¸­ã€‚</li>
<li>features.tsv.gzæ–‡ä»¶å¯¹åº”äºè¡Œç´¢å¼•ã€‚åœ¨scRNA-seqæ•°æ®ä¸­ï¼Œâ€œfeaturesâ€å®é™…ä¸ŠæŒ‡çš„æ˜¯åŸºå› ã€‚features.tsv.gzæ–‡ä»¶åŒ…å«ä¸‰åˆ—ï¼šfeature IDï¼šå‚è€ƒGTFæ–‡ä»¶çš„æ³¨é‡Šå­—æ®µä¸­çš„gene_idï¼Œè¡¨ç¤ºç‰¹å¾çš„IDã€‚ nameï¼šå‚è€ƒGTFæ–‡ä»¶çš„æ³¨é‡Šå­—æ®µä¸­çš„gene_nameï¼Œå¦‚æœå‚è€ƒGTFä¸­æ²¡æœ‰gene_nameå­—æ®µï¼Œåˆ™åŸºå› åç§°ç­‰åŒäºåŸºå› IDã€‚ type of featureï¼šæè¿°ç‰¹å¾ç±»å‹ï¼Œå¯ä»¥æ˜¯Gene Expressionã€Antibody Captureã€CRISPRæˆ–CUSTOMä¹‹ä¸€ã€‚å¯¹äºscRNA-seqæ•°æ®ï¼Œå®ƒå°†æ˜¯Gene Expressionï¼ˆåŸºå› è¡¨è¾¾ï¼‰ã€‚</li>
<li>barcodes.tsv.gzå¯¹åº”äºåˆ—ç´¢å¼•ï¼Œå®ƒåŒ…å«äº†æ¯ä¸ªåˆ—çš„æ¡å½¢ç ã€‚æœ‰å…³æ¡å½¢ç åºåˆ—æ ¼å¼çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è€ƒ<a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/output/bam">æ¡å½¢ç BAMéƒ¨åˆ†</a>ã€‚</li>
</ul>
<p><strong>Web Summary .html</strong></p>
<p>ä¸€ä¸ªæ¦‚è¦çš„HTMLæ–‡ä»¶åŒ…å«äº†æ‘˜è¦æŒ‡æ ‡å’Œè‡ªåŠ¨åŒ–äºŒæ¬¡åˆ†æç»“æœã€‚å¦‚æœåœ¨æµç¨‹è¿è¡ŒæœŸé—´æ£€æµ‹åˆ°é—®é¢˜ï¼Œå°†åœ¨æ­¤é¡µé¢ä¸Šæ˜¾ç¤ºè­¦æŠ¥ã€‚</p>
<p>è¯¥HTMLæ–‡ä»¶åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼ŒSUMMARYï¼ˆæ‘˜è¦ï¼‰å’ŒANALYSISï¼ˆåˆ†æï¼‰ã€‚æ‚¨è¿˜å¯ä»¥ç‚¹å‡»æ¯ä¸ªä»ªè¡¨æ¿é¡¶éƒ¨çš„â€œ?â€ä»¥è·å–æœ‰å…³æ¯ä¸ªæŒ‡æ ‡çš„æ›´å¤šä¿¡æ¯ã€‚</p>
<ol type="1">
<li>SUMMARYï¼ˆæ‘˜è¦ï¼‰æŒ‡æ ‡æè¿°äº†æµ‹åºè´¨é‡å’Œæ£€æµ‹åˆ°çš„ç»†èƒçš„å„ç§ç‰¹å¾ã€‚åœ¨é¡µé¢é¡¶éƒ¨é™„è¿‘é†’ç›®åœ°æ˜¾ç¤ºäº†æ£€æµ‹åˆ°çš„ç»†èƒæ•°é‡ã€æ¯ä¸ªç»†èƒçš„å¹³å‡readsæ•°ä»¥åŠæ¯ä¸ªç»†èƒæ£€æµ‹åˆ°çš„åŸºå› çš„ä¸­ä½æ•°ã€‚</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/https:/holab-hku.github.io/Fundamental-scRNA/figs/cells_summary.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Cells dashboard (modified from the cellranger website)</figcaption></figure>
</div>
<ol start="2" type="1">
<li>åœ¨â€œCellsâ€ä»ªè¡¨æ¿ä¸‹çš„â€œBarcode Rank Plotâ€æ˜¾ç¤ºäº†æ¡å½¢ç è®¡æ•°çš„åˆ†å¸ƒä»¥åŠè¢«æ¨æ–­ä¸ç»†èƒç›¸å…³çš„æ¡å½¢ç ã€‚yè½´è¡¨ç¤ºæ¯ä¸ªæ¡å½¢ç æ˜ å°„åˆ°çš„UMIè®¡æ•°ï¼Œxè½´è¡¨ç¤ºä½äºè¯¥å€¼çš„æ¡å½¢ç æ•°é‡ã€‚é™¡å³­çš„ä¸‹é™è¡¨ç¤ºç»†èƒå…³è”çš„æ¡å½¢ç ä¸ä¸ç©ºåˆ†åŒºç›¸å…³çš„æ¡å½¢ç ä¹‹é—´æœ‰è‰¯å¥½çš„åˆ†ç¦»ã€‚æ¡å½¢ç å¯ä»¥é€šè¿‡å…¶UMIè®¡æ•°æˆ–å…¶RNAé…ç½®æ–‡ä»¶ç¡®å®šä¸ºä¸ç»†èƒç›¸å…³ï¼Œå› æ­¤å›¾è¡¨çš„æŸäº›åŒºåŸŸå¯èƒ½åŒæ—¶åŒ…å«ç»†èƒå…³è”å’ŒèƒŒæ™¯å…³è”çš„æ¡å½¢ç ã€‚å›¾è¡¨çš„é¢œè‰²è¡¨ç¤ºä¸ç»†èƒå…³è”çš„æ¡å½¢ç çš„å±€éƒ¨å¯†åº¦ã€‚</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/https:/holab-hku.github.io/Fundamental-scRNA/figs/seq_map.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Sequencing and Mapping dashboards (modified from the cellranger website)</figcaption></figure>
</div>
<p>å…¶ä»–ç”¨äºè¯„ä¼°çš„æŒ‡æ ‡ï¼š</p>
<ul>
<li>
<code>Estimated Number of Cells</code>: 500-10,000</li>
<li>
<code>Mean Reads per Cell</code>: 20,000 reads/cell minimum recommended reads per cell around 10,000</li>
<li>
<code>Valid barcodes</code>: greater than 75%</li>
<li>
<code>Q30 bases in RNA read</code>: ideally greater than 65%</li>
<li>
<code>Reads mapped confidently to transcriptome</code>: ideally greater than 30%</li>
<li>
<code>Reads mapped antisense to gene</code>: ideally smaller than 10%</li>
</ul>
<ol start="3" type="1">
<li>åˆ†æï¼ˆANALYSISï¼‰æŒ‡æ ‡åŒ…æ‹¬ä»¥ä¸‹è‡ªåŠ¨åŒ–çš„äºŒæ¬¡åˆ†æï¼š</li>
</ol>
<ul>
<li>é™ç»´åˆ†æï¼šå°†ç»†èƒæŠ•å½±åˆ°äºŒç»´ç©ºé—´ï¼ˆt-SNEï¼‰ï¼Œä»¥å±•ç¤ºå®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚</li>
<li>è‡ªåŠ¨èšç±»åˆ†æï¼šå°†å…·æœ‰ç›¸ä¼¼è¡¨è¾¾ç‰¹å¾çš„ç»†èƒåˆ†ç»„åœ¨ä¸€èµ·ï¼Œå½¢æˆèšç±»ã€‚</li>
<li>å·®å¼‚è¡¨è¾¾åŸºå› åˆ—è¡¨ï¼šåˆ—å‡ºåœ¨æ‰€é€‰èšç±»ä¹‹é—´è¡¨è¾¾å·®å¼‚æ˜¾è‘—çš„åŸºå› ã€‚</li>
<li>æ˜¾ç¤ºæµ‹åºæ·±åº¦é™ä½å¯¹è§‚å¯Ÿåˆ°çš„æ–‡åº“å¤æ‚æ€§çš„å½±å“çš„å›¾è¡¨ã€‚</li>
<li>æ˜¾ç¤ºæµ‹åºæ·±åº¦é™ä½å¯¹æ¯ä¸ªç»†èƒæ£€æµ‹åˆ°çš„å¹³å‡åŸºå› æ•°çš„å½±å“çš„å›¾è¡¨ã€‚</li>
</ul>
<p><strong>BAM</strong></p>
<p>BAMæ–‡ä»¶ä»¥äºŒè¿›åˆ¶å‹ç¼©æ ¼å¼ä¿å­˜äº†å…³äº mapping reads çš„ä¿¡æ¯ã€‚å®ƒç”±å¯é€‰çš„å¤´éƒ¨éƒ¨åˆ†å’Œå¯¹é½éƒ¨åˆ†ç»„æˆã€‚å¦‚æœå­˜åœ¨å¤´éƒ¨éƒ¨åˆ†ï¼Œå®ƒå°†é€šè¿‡ç¬¬ä¸€åˆ—ä¸­çš„<code>@</code>ä¸å¯¹é½éƒ¨åˆ†åŒºåˆ†ï¼Œå¹¶ä½äºå¯¹é½éƒ¨åˆ†ä¹‹å‰ã€‚</p>
<p>å½“è§£å‹ç¼©æˆSAMæ–‡ä»¶æ—¶ï¼Œä¿¡æ¯ä»¥åˆ¶è¡¨ç¬¦åˆ†éš”çš„è¡¨æ ¼å½¢å¼å­˜å‚¨ï¼Œå…¶ä¸­åŒ…å«ä¸€äº›æ ‡å‡†åˆ—å’Œç”± Cell Ranger è½¯ä»¶ç”Ÿæˆçš„ç‰¹å®šåˆ—ã€‚Cell Rangerç‰¹å®šçš„åˆ—åŒ…å«ä¸ BAM æ¡å½¢ç ã€BAM å¯¹é½å’Œç‰¹å¾æ¡å½¢ç ç›¸å…³çš„ä¿¡æ¯ã€‚æ ‡å‡†åˆ—å¯¹åº”ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code>QNAME : read name (generally will include UMI barcode if applicable)
FLAG : number tag indicating the â€œtypeâ€ of alignment, link to explanation of all possible â€œtypesâ€
RNAME : reference sequence name (i.e. chromosome read is mapped to).
POS : leftmost mapping position
MAPQ : Mapping quality
CIGAR : string indicating the matching/mismatching parts of the read (may include soft-clipping).
RNEXT : reference name of the mate/next read
PNEXT : POS for mate/next read
TLEN : Template length (length of reference region the read is mapped to)
SEQ : read sequence
QUAL : read quality</code></pre>
<p>å¯ä»¥ä½¿ç”¨ SAMtools æŸ¥çœ‹ BAM æ–‡ä»¶ï¼š</p>
<pre><code>samtools view output.bam</code></pre>
<p>ä¸ºäº†è¿›è¡ŒåŸºäº RNA é€Ÿç‡çš„è½¨è¿¹åˆ†æï¼Œéœ€è¦ bam æ–‡ä»¶ã€‚</p>
<p><strong>åˆ†å­ä¿¡æ¯ï¼ˆh5ï¼‰</strong></p>
<p>å®ƒæ˜¯ä¸€ä¸ª HDF5 æ–‡ä»¶ï¼ŒåŒ…å«æœ‰æ•ˆæ¡å½¢ç å’Œæœ‰æ•ˆ UMI çš„æ‰€æœ‰åˆ†å­çš„æ¯åˆ†å­ä¿¡æ¯ï¼Œå¹¶ä»¥é«˜ç½®ä¿¡åº¦åˆ†é…ç»™åŸºå› æˆ–ç‰¹å¾æ¡å½¢ç ã€‚è¯¥ HDF5 æ–‡ä»¶åŒ…å«ä¸è§‚å¯Ÿåˆ°çš„åˆ†å­ç›¸å¯¹åº”çš„æ•°æ®ï¼Œä»¥åŠæœ‰å…³æ‰€ä½¿ç”¨çš„åº“å’Œç‰¹å¾é›†çš„æ•°æ®ã€‚è¿™ä¸ªæ–‡ä»¶çš„ç»“æ„æ˜¯ï¼š</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/https:/holab-hku.github.io/Fundamental-scRNA/figs/hdf5.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">HDF5 File Hierarchy(taken from the cellranger website)</figcaption></figure>
</div>
<p><strong>äºŒçº§åˆ†æ CSV æ–‡ä»¶</strong></p>
<p>åŒ…å«è‡ªåŠ¨è¾…åŠ©åˆ†æç»“æœçš„å‡ ä¸ª CSV æ–‡ä»¶ã€‚å®ƒåŒ…å«æœ‰å…³é™ç»´ã€t-SNEã€UMAPã€èšç±»å’Œå·®åˆ†è¡¨è¾¾çš„ä¿¡æ¯ã€‚å®ƒä¹Ÿé€šè¿‡<code>Web Summary.html</code>æ–‡ä»¶åœ¨ANALYSISåº¦é‡ä¸­å¯è§†åŒ–ã€‚</p>
<p><strong>Loupe æ–‡ä»¶ (.cloupe)</strong></p>
<p>Loupe Browser æ˜¯ä¸€æ¬¾æ¡Œé¢åº”ç”¨ç¨‹åºï¼Œæä¾›ä¸10x Genomicsè§£å†³æ–¹æ¡ˆçš„æ•°æ®è¿›è¡Œäº¤äº’å¼å¯è§†åŒ–åˆ†æçš„åŠŸèƒ½ã€‚å®ƒå¯ä»¥å¸®åŠ©å¯»æ‰¾æ„Ÿå…´è¶£çš„ç»†èƒã€å‘ç°é‡è¦åŸºå› ã€è¯†åˆ«ç»†èƒç±»å‹ã€æ¢ç´¢ç»†èƒäºšç»“æ„ã€ç ”ç©¶ç»†èƒäºšå‹ã€é›†æˆåŸºå› è¡¨è¾¾å’ŒV(D)Jåˆ†æï¼Œå¹¶å…±äº«ç»“æœã€‚</p>
<p>é€šè¿‡ Loupe Browser å¯ä»¥æŸ¥çœ‹ Loupe æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<ul>
<li>æ ·æœ¬ä¸­ç»†èƒçš„åŸºå› è¡¨è¾¾ä¿¡æ¯ã€‚</li>
<li>ç»†èƒçš„å„ç§åŸºäºåŸºå› è¡¨è¾¾çš„èšç±»ä¿¡æ¯ï¼ŒåŒ…æ‹¬t-SNEå’ŒUMAPæŠ•å½±ä»¥åŠå·®å¼‚åŸºå› è¡¨è¾¾æƒ…å†µã€‚</li>
<li>æ¥è‡ªè½¬å½•ç»„å‚è€ƒçš„åŸºå› æ³¨é‡Šä¿¡æ¯ã€‚</li>
</ul></section></section><section id="starsolo" class="level3"><h3 class="anchored" data-anchor-id="starsolo">STARsolo</h3>
<p>STARsoloï¼ˆKaminowï¼ŒYunusovå’ŒDobin 2021ï¼‰æ˜¯ä¸€ä¸ªä¸“ä¸ºæ¶²æ»´å¼å•ç»†èƒRNAæµ‹åºæ•°æ®ï¼ˆä¾‹å¦‚10X Genomics Chromiumç³»ç»Ÿï¼‰è®¾è®¡çš„åˆ†æå·¥å…·ï¼Œç›´æ¥å†…åµŒåœ¨STARä»£ç ä¸­ã€‚STARsoloçš„è¾“å…¥æ˜¯ä¸€ä¸ªFASTQæ–‡ä»¶ï¼Œå®ƒå¯ä»¥ä»¥ä¸Cell Rangerå‡ ä¹ç›¸åŒçš„æ ¼å¼è¾“å‡ºåŸºå› è®¡æ•°ï¼Œä½†é€Ÿåº¦çº¦å¿«10å€ã€‚</p>
<p>STARsolo ç¨‹åºè¾“å‡ºå¤§é‡åæ˜  reads æ¯”å¯¹è¿‡ç¨‹ç»†èŠ‚çš„æ–‡ä»¶ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åªè®¨è®ºå…¶ä¸­ä¸€äº›å…³é”®æ–‡ä»¶ã€‚</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/https:/holab-hku.github.io/Fundamental-scRNA/figs/starsolo.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">STARsolo Output</figcaption></figure>
</div>
<ul>
<li>BAMæ–‡ä»¶åŒ…å«æœ‰å…³æ¯”å¯¹ reads çš„ä¿¡æ¯ï¼Œä¸é€šè¿‡Cell Rangerç”Ÿæˆçš„BAMæ–‡ä»¶éå¸¸ç›¸ä¼¼ã€‚</li>
<li>æ¯”å¯¹æ‘˜è¦æ–‡ä»¶Features.statså’ŒSummary.csvåŒ…å«æœ‰å…³åŸºæœ¬æ¯”å¯¹ç»†èŠ‚çš„ä¿¡æ¯ã€‚è¿™å¯ä»¥ä½œä¸ºå¯¹æ¯”å¯¹è¿‡ç¨‹è¿›è¡Œç®€å•åˆæ­¥è´¨é‡æ§åˆ¶æ£€æŸ¥çš„ä¾¿æ·å·¥å…·ã€‚</li>
<li>ç‰¹å¾çŸ©é˜µæ–‡ä»¶matrix.mtxåŒ…å«æ¯ä¸ªä¸ªä½“ç»†èƒä¸­æ˜ å°„çš„åŸºå› è®¡æ•°ä¿¡æ¯ã€‚åˆ—åå¯¹åº”äºæ¯ä¸ªä¸ªä½“ç»†èƒçš„æ¡å½¢ç ï¼Œè¡Œåå¯¹åº”äºæ‰€æœ‰æ³¨é‡Šçš„åŸºå› ã€‚ç”±äºè¯¥æ•°æ®çš„è§„æ¨¡è¾ƒå¤§ï¼Œå®ƒä»¥ç¨€ç–çŸ©é˜µçš„å½¢å¼å­˜å‚¨ã€‚</li>
<li>è¾…åŠ©æ–‡ä»¶ barcodes.tsv å’Œ features.tsv æä¾›äº†ä¸‹æ¸¸åˆ†ææ‰€éœ€çš„é¢å¤–å…ƒæ•°æ®ã€‚è¿™äº›æ–‡ä»¶è¿åŒçŸ©é˜µæ–‡ä»¶åœ¨åŠŸèƒ½ä¸Šæ‰®æ¼”ç€ä¸Cell Rangerè¾“å‡ºä¸­çš„ Matrices éƒ¨åˆ†ç›¸åŒçš„è§’è‰²ï¼Œå¹¶ä¸”åœ¨é‡‘æ ‡å‡†çš„ scRNA-seq æ•°æ®åˆ†æè½¯ä»¶ seurat ä¸­è¿›è¡Œåˆ†ææ—¶æ˜¯å¿…éœ€çš„ã€‚</li>
</ul></section><section id="doublets" class="level3"><h3 class="anchored" data-anchor-id="doublets">Doublets</h3>
<p>åŒç»†èƒæ˜¯æŒ‡è™½ç„¶è®¾è®¡ä¸ºç”±ä¸€ä¸ªç»†èƒç”Ÿæˆï¼Œä½†å´æ˜¯ç”±ä¸¤ä¸ªç»†èƒç”Ÿæˆçš„äººå·¥æ–‡åº“ã€‚é€šå¸¸è¿™æ˜¯ç”±äºç»†èƒåˆ†é€‰æˆ–æ•è·è¿‡ç¨‹ä¸­çš„é”™è¯¯å¼•èµ·çš„ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨å‡ ç§å®éªŒç­–ç•¥æ¥å»é™¤åŒç»†èƒï¼š</p>
<ul>
<li>åŸºäºä¸åŒä¾›ä½“ä¸ªä½“ä¹‹é—´çš„è‡ªç„¶é—ä¼ å˜å¼‚ï¼ˆKangç­‰äººï¼Œ2018ï¼‰ã€‚</li>
<li>ä½¿ç”¨ä¸ä¸åŒå¯¡æ ¸è‹·é…¸ç»“åˆçš„æŠ—ä½“æ ‡è®°ä¸€ç»„ç»†èƒï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ªä¸€ä¸ªæ ·æœ¬çš„æ‰€æœ‰ç»†èƒï¼‰ã€‚åœ¨æ··åˆåï¼Œè§‚å¯Ÿåˆ°å…·æœ‰ä¸åŒå¯¡æ ¸è‹·é…¸çš„æ–‡åº“è¢«è§†ä¸ºåŒç»†èƒå¹¶ç§»é™¤ï¼ˆBachç­‰äººï¼Œ2017ï¼‰ã€‚</li>
<li>ä»…åŸºäºè¡¨è¾¾è°±çš„è®¡ç®—æ–¹æ³•ï¼ˆå¦‚æ¨¡æ‹Ÿï¼‰æ¨æ–­åŒç»†èƒå¹¶è¿›è¡Œå»é™¤ã€‚</li>
</ul></section></section><section id="ä½¿ç”¨-seurat-è¿›è¡Œåˆ†æ" class="level2"><h2 class="anchored" data-anchor-id="ä½¿ç”¨-seurat-è¿›è¡Œåˆ†æ">ä½¿ç”¨ Seurat è¿›è¡Œåˆ†æ</h2>
<p>æœ¬èŠ‚çš„å†…å®¹æ˜¯æ ¹æ®<a href="https://satijalab.org/seurat/articles/pbmc3k_tutorial.html">Seurat - Guided Clustering Tutorial</a>è¿›è¡Œäº†ä¸€äº›ä¿®æ”¹å’Œé€‚åº”ã€‚æˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®æ˜¯ä»10x Genomicsç½‘ç«™è·å–çš„10k PBMCæ•°æ®ã€‚</p>
<p>æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•è¯»å–10Xæµ‹åºæ•°æ®å¹¶å°†å…¶è½¬æ¢ä¸ºSeuratå¯¹è±¡ï¼Œè¿›è¡Œè´¨æ§å’Œé€‰æ‹©ç”¨äºè¿›ä¸€æ­¥åˆ†æçš„ç»†èƒï¼Œå¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œè¯†åˆ«é«˜å¯å˜ç‰¹å¾ï¼ˆç‰¹å¾é€‰æ‹©ï¼‰ï¼Œå¯¹æ•°æ®è¿›è¡Œç¼©æ”¾ï¼Œè¿›è¡Œçº¿æ€§é™ç»´å’Œå¯è§†åŒ–åˆ†æã€‚</p>
<section id="seurat-å¯¹è±¡" class="level3"><h3 class="anchored" data-anchor-id="seurat-å¯¹è±¡">Seurat å¯¹è±¡</h3>
<p>Seuratå¯¹è±¡å……å½“ä¸€ä¸ªå®¹å™¨ï¼Œå…¶ä¸­åŒ…å«å•ä¸ªå•ç»†èƒæ•°æ®é›†çš„æ•°æ®ï¼ˆå¦‚è®¡æ•°çŸ©é˜µï¼‰å’Œåˆ†æï¼ˆå¦‚PCAæˆ–èšç±»ç»“æœï¼‰ã€‚åœ¨ä½¿ç”¨ Seurat åˆ†æscRNA-seqæ•°æ®ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä»<a href="https://github.com/satijalab/seurat/wiki/Seurat#object-information">è¿™é‡Œ</a>å¯¹Seuratå¯¹è±¡æœ‰ä¸€äº›åŸºæœ¬çš„äº†è§£ã€‚</p>
</section><section id="è®¾ç½®seuratå¯¹è±¡" class="level3"><h3 class="anchored" data-anchor-id="è®¾ç½®seuratå¯¹è±¡">è®¾ç½®Seuratå¯¹è±¡</h3>
<div class="cell">
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat">Seurat</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>æˆ‘ä»¬ä»è¯»å…¥æ•°æ®å¼€å§‹ã€‚<code>Read10X_h5</code>ä»10X CellRanger hdf5æ–‡ä»¶è¯»å–è®¡æ•°çŸ©é˜µï¼Œè¿”å›å”¯ä¸€çš„åˆ†å­è¯†åˆ«ï¼ˆUMIï¼‰è®¡æ•°çŸ©é˜µã€‚è¯¥çŸ©é˜µä¸­çš„å€¼è¡¨ç¤ºæ¯ä¸ªç‰¹å¾ï¼ˆå³åŸºå› ï¼›è¡Œï¼‰åœ¨æ¯ä¸ªç»†èƒï¼ˆåˆ—ï¼‰ä¸­æ£€æµ‹åˆ°çš„è¡¨è¾¾é‡ã€‚å®ƒå¯ç”¨äºè¯»å–scATAC-seqå’ŒscRNA-seqçŸ©é˜µã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨è®¡æ•°çŸ©é˜µæ¥åˆ›å»ºä¸€ä¸ªSeuratå¯¹è±¡ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the PBMC dataset</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc.data</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/Read10X_h5.html">Read10X_h5</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/wsx/Library/CloudStorage/OneDrive-shanghaitech.edu.cn/Public/data/10k_PBMC.h5"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize the Seurat object with the raw (non-normalized data).</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/CreateSeuratObject.html">CreateSeuratObject</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>counts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc.data</span>, project <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pbmc10k"</span>, min.cells <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, min.features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>An object of class Seurat 
22432 features across 10813 samples within 1 assay 
Active assay: RNA (22432 features, 0 variable features)</code></pre>
</div>
</div>
<p>å¦‚æœæˆ‘ä»¬æƒ³ç›´æ¥ä½¿ç”¨ cellranger ç®¡é“ä» 10X è¯»å–æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code><a href="https://satijalab.org/seurat/reference/Read10X.html">Read10X()</a></code>ã€‚</p>
</section><section id="æ ‡å‡†é¢„å¤„ç†æµç¨‹" class="level3"><h3 class="anchored" data-anchor-id="æ ‡å‡†é¢„å¤„ç†æµç¨‹">æ ‡å‡†é¢„å¤„ç†æµç¨‹</h3>
<p>ä»¥ä¸‹æ­¥éª¤åŒ…å«äº† Seurat ä¸­ scRNA-seq æ•°æ®çš„æ ‡å‡†é¢„å¤„ç†å·¥ä½œæµç¨‹ã€‚å®ƒä»¬åŸºäºæˆ‘ä»¬å°†ä» Cell Ranger æˆ– STARsolo è¾“å‡ºä¸­è·å¾—çš„ RNA reads è®¡æ•°çŸ©é˜µã€‚æ ‡å‡†çš„é¢„å¤„ç†å·¥ä½œæµç¨‹ä»£è¡¨äº†åŸºäº QC æŒ‡æ ‡çš„ç»†èƒé€‰æ‹©å’Œè¿‡æ»¤ï¼Œæ•°æ®å½’ä¸€åŒ–å’Œç¼©æ”¾ï¼Œä»¥åŠé«˜åº¦å¯å˜ç‰¹å¾çš„æ£€æµ‹ã€‚</p>
<section id="qc-å’Œç»†èƒè¿‡æ»¤" class="level4"><h4 class="anchored" data-anchor-id="qc-å’Œç»†èƒè¿‡æ»¤">QC å’Œç»†èƒè¿‡æ»¤</h4>
<p>Seurat å…è®¸ä½ æ ¹æ®ä»»ä½•ç”¨æˆ·å®šä¹‰çš„æ ‡å‡†è½»æ¾æ¢ç´¢ QC æŒ‡æ ‡å’Œè¿‡æ»¤ç»†èƒã€‚ç¤¾åŒºå¸¸ç”¨çš„ä¸€äº›è´¨é‡æ§åˆ¶æŒ‡æ ‡ï¼ˆIlicic et al.&nbsp;2016ï¼‰åŒ…æ‹¬ï¼š</p>
<ul>
<li>åœ¨æ¯ä¸ªç»†èƒä¸­æ£€æµ‹åˆ°çš„ç‹¬ç‰¹åŸºå› çš„æ•°é‡
<ul>
<li>ä½è´¨é‡çš„ç»†èƒæˆ–ç©ºæ¶²æ»´é€šå¸¸åªæœ‰å¾ˆå°‘çš„åŸºå› </li>
<li>ç»†èƒåŒèƒèƒæˆ–å¤šèƒèƒå¯èƒ½è¡¨ç°å‡ºå¼‚å¸¸é«˜çš„åŸºå› è®¡æ•°</li>
<li>åŒæ ·ï¼Œç»†èƒå†…æ£€æµ‹åˆ°çš„åˆ†å­æ€»æ•°ï¼ˆä¸ç‹¬ç‰¹çš„åŸºå› å¯†åˆ‡ç›¸å…³ï¼‰</li>
</ul>
</li>
<li>reads å åˆ°çº¿ç²’ä½“åŸºå› ç»„çš„ç™¾åˆ†æ¯”
<ul>
<li>ä½è´¨é‡/å‚æ­»ç»†èƒé€šå¸¸è¡¨ç°å‡ºå¹¿æ³›çš„çº¿ç²’ä½“æ±¡æŸ“</li>
<li>æˆ‘ä»¬ä½¿ç”¨<code><a href="https://satijalab.org/seurat/reference/PercentageFeatureSet.html">PercentageFeatureSet()</a></code>å‡½æ•°è®¡ç®—çº¿ç²’ä½“ QC æŒ‡æ ‡ï¼Œè¯¥å‡½æ•°è®¡ç®—æºè‡ªä¸€ç»„ç‰¹å¾çš„è®¡æ•°ç™¾åˆ†æ¯”</li>
<li>æˆ‘ä»¬ç”¨ MT å¼€å¤´çš„æ‰€æœ‰åŸºå› é›†åˆä½œä¸ºçº¿ç²’ä½“åŸºå› é›†åˆ</li>
</ul>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The [[ operator can add columns to object metadata. This is a great place to stash QC stats</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"percent.mt"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/PercentageFeatureSet.html">PercentageFeatureSet</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, pattern <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^MT-"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>åœ¨ <code><a href="https://mojaveazure.github.io/seurat-object/reference/CreateSeuratObject.html">CreateSeuratObject()</a></code> è¿‡ç¨‹ä¸­è‡ªåŠ¨è®¡ç®—å”¯ä¸€åŸºå› å’Œæ€»åˆ†å­çš„æ•°é‡ã€‚å®ƒä»¬å­˜å‚¨åœ¨å¯¹è±¡å…ƒæ•°æ®ä¸­ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show QC metrics for the first 5 cells in the control group</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">meta.data</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   orig.ident nCount_RNA nFeature_RNA percent.mt
AAACCCAGTATATGGA-1    pbmc10k        860          350 44.1860465
AAACCCAGTATCGTAC-1    pbmc10k       1548          729  0.4521964
AAACCCAGTCGGTGAA-1    pbmc10k       6387         1827 10.4117739
AAACCCAGTTAGAAAC-1    pbmc10k      16664         3744  5.2808449
AAACCCAGTTATCTTC-1    pbmc10k       3352         1464 13.8424821</code></pre>
</div>
</div>
<p>æˆ‘ä»¬å¯ä»¥å¯è§†åŒ– <code>nFeature_RNA</code>, <code>nCount_RNA</code> å’Œ <code>percent.mt</code> ä½œä¸º QC æŒ‡æ ‡ã€‚</p>
<p>ä¸ Cell Ranger è¾“å‡ºä¸€æ ·ï¼Œä»¥ä¸‹ç»“æœä¸­çš„ feature è¡¨ç¤ºåŸºå› ã€‚ nFeature_RNA æ˜¯æ¯ä¸ªç»†èƒä¸­æ£€æµ‹åˆ°çš„åŸºå› æ•°é‡ã€‚ nCount_RNA æ˜¯ç»†èƒå†…æ£€æµ‹åˆ°çš„åˆ†å­æ€»æ•°ã€‚ ä¸‹å›¾ä¸­çš„æ¯ä¸ªç‚¹ä»£è¡¨ä¸€ä¸ªç»†èƒã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualize QC metrics as a violin plot</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nFeature_RNA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"percent.mt"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, </span>
<span>        ncol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, pt.size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0001</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>æˆ‘ä»¬æ¥ç€ä½¿ç”¨ç‚¹å›¾æ¥è¡¨ç¤º 3 è€…ä¹‹é—´çš„å…³ç³»ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># FeatureScatter is typically used to visualize feature-feature relationships, but can be used</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for anything calculated by the object, i.e. columns in object metadata, PC scores etc.</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FeatureScatter.html">FeatureScatter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, feature1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>, feature2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"percent.mt"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>legend.position<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FeatureScatter.html">FeatureScatter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, feature1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>, feature2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nFeature_RNA"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>legend.position<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot2</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è¿‡æ»¤æ‰å…·æœ‰ç‹¬ç‰¹ç‰¹å¾è®¡æ•°ï¼ˆåŸºå› ï¼‰è¶…è¿‡5000æˆ–å°‘äº200çš„ç»†èƒã€‚æˆ‘ä»¬ä¹Ÿè¿‡æ»¤æ‰çº¿ç²’ä½“æ•°é‡å¤§äº15%çš„ç»†èƒã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, subset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nFeature_RNA</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nFeature_RNA</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">percent.mt</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>ç„¶åå†ä¸€æ¬¡ç”¨æç´å›¾æŸ¥çœ‹è¿‡æ»¤åçš„è´¨é‡å›¾ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualize QC metrics as a violin plot</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nFeature_RNA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"percent.mt"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, </span>
<span>        ncol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, pt.size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0001</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FeatureScatter.html">FeatureScatter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, feature1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>, feature2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"percent.mt"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>legend.position<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FeatureScatter.html">FeatureScatter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, feature1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>, feature2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nFeature_RNA"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>legend.position<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot2</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="æ ‡å‡†åŒ–æ•°æ®" class="level4"><h4 class="anchored" data-anchor-id="æ ‡å‡†åŒ–æ•°æ®">æ ‡å‡†åŒ–æ•°æ®</h4>
<p>ä»æ•°æ®é›†ä¸­åˆ é™¤ä¸éœ€è¦çš„ç»†èƒåï¼Œä¸‹ä¸€æ­¥æ˜¯å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ï¼ˆè§„èŒƒåŒ–ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å…¨å±€ç¼©æ”¾å½’ä¸€åŒ–æ–¹æ³•â€œLogNormalizeâ€ï¼Œè¯¥æ–¹æ³•é€šè¿‡æ€»è¡¨è¾¾å¯¹æ¯ä¸ªç»†èƒçš„ç‰¹å¾è¡¨è¾¾å¼æµ‹é‡å€¼è¿›è¡Œå½’ä¸€åŒ–ï¼Œå°†å…¶ä¹˜ä»¥ä¸€ä¸ªæ¯”ä¾‹å› å­ï¼ˆé»˜è®¤ä¸º10,000ï¼‰ï¼Œå¹¶å¯¹ç»“æœè¿›è¡Œå¯¹æ•°å˜æ¢ã€‚æ ‡å‡†åŒ–å€¼å­˜å‚¨åœ¨<code>pbmc[["RNA"]]@data</code>ä¸­ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/NormalizeData.html">NormalizeData</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, </span>
<span>          normalization.method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LogNormalize"</span>, </span>
<span>          scale.factor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä»åŸºå› è¡¨è¾¾çŸ©é˜µä¸­é‡‡æ · 10,000 ä¸ªreadsè®¡æ•°ï¼Œåˆ†åˆ«å¯è§†åŒ–æ ‡å‡†åŒ–å‰åçš„åŸºå› è¡¨è¾¾åˆ†å¸ƒï¼ˆä¸åŒ…æ‹¬é›¶ï¼‰ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set seed and put two plots in one figure</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>mfrow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># original expression distribution</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_geneExp</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RNA'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">counts</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in .sparse2v(x): sparse-&gt;dense coercion: allocating vector of size 1.6
GiB</code></pre>
</div>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_geneExp</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_geneExp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_geneExp</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">raw_geneExp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># expression distribution after normalization</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">logNorm_geneExp</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RNA'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">data</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in .sparse2v(x): sparse-&gt;dense coercion: allocating vector of size 1.6
GiB</code></pre>
</div>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">logNorm_geneExp</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">logNorm_geneExp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">logNorm_geneExp</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">logNorm_geneExp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="è¯†åˆ«é«˜åº¦å¯å˜çš„ç‰¹å¾ç‰¹å¾é€‰æ‹©" class="level4"><h4 class="anchored" data-anchor-id="è¯†åˆ«é«˜åº¦å¯å˜çš„ç‰¹å¾ç‰¹å¾é€‰æ‹©">è¯†åˆ«é«˜åº¦å¯å˜çš„ç‰¹å¾ï¼ˆç‰¹å¾é€‰æ‹©ï¼‰</h4>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¡ç®—æ•°æ®é›†ä¸­è¡¨ç°å‡ºé«˜ç»†èƒé—´å·®å¼‚çš„ç‰¹å¾å­é›†ï¼ˆå³ï¼Œå®ƒä»¬åœ¨ä¸€äº›ç»†èƒä¸­é«˜è¡¨è¾¾ï¼Œè€Œåœ¨å…¶ä»–ç»†èƒä¸­ä½è¡¨è¾¾ï¼‰ã€‚ç ”ç©¶è¡¨æ˜(Brennecke et al.&nbsp;2013)åœ¨ä¸‹æ¸¸åˆ†æä¸­å…³æ³¨è¿™äº›åŸºå› æœ‰åŠ©äºçªå‡ºå•ç»†èƒæ•°æ®é›†ä¸­çš„ç”Ÿç‰©ä¿¡å·ã€‚</p>
<p>Seuratä¸­çš„è¿‡ç¨‹è¯¦ç»†æè¿°åœ¨æ–‡çŒ® Stuart et al.&nbsp;2019 ä¸­ï¼Œ<code><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html">FindVariableFeatures()</a></code>å‡½æ•°ä¸­å®ç°ç›´æ¥å»ºæ¨¡å•ç»†èƒæ•°æ®ä¸­å›ºæœ‰çš„å‡å€¼-æ–¹å·®å…³ç³»æ¥æ”¹è¿›ä»¥å‰çš„ç‰ˆæœ¬ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒSeuratæ¯ä¸ªæ•°æ®é›†è¿”å›2000ä¸ªç‰¹å¾ï¼Œè¿™äº›ç‰¹å¾å°†ç”¨äºä¸‹æ¸¸åˆ†æï¼Œå¦‚PCAã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html">FindVariableFeatures</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, selection.method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vst"</span>, nfeatures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Identify the 10 most highly variable genes</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">top10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/VariableFeatures.html">VariableFeatures</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot variable features with and without labels</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VariableFeaturePlot.html">VariableFeaturePlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>legend.position<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/LabelPoints.html">LabelPoints</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>plot <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot1</span>, points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">top10</span>, repel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>legend.position<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>When using repel, set xnudge and ynudge to 0 for optimal results</code></pre>
</div>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot2</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous x-axis
Transformation introduced infinite values in continuous x-axis</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="ç¼©æ”¾æ•°æ®" class="level4"><h4 class="anchored" data-anchor-id="ç¼©æ”¾æ•°æ®">ç¼©æ”¾æ•°æ®</h4>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åº”ç”¨çº¿æ€§å˜æ¢(â€œç¼©æ”¾â€)ï¼Œè¿™æ˜¯åœ¨PCAç­‰é™ç»´æŠ€æœ¯ä¹‹å‰çš„æ ‡å‡†é¢„å¤„ç†æ­¥éª¤ã€‚å‡½æ•°<code><a href="https://satijalab.org/seurat/reference/ScaleData.html">ScaleData()</a></code>ï¼š</p>
<ul>
<li>ç§»åŠ¨æ¯ä¸ªåŸºå› çš„è¡¨è¾¾ï¼Œä½¿ç»†èƒé—´çš„å¹³å‡è¡¨è¾¾ä¸º 0ã€‚</li>
<li>ç¼©æ”¾æ¯ä¸ªåŸºå› çš„è¡¨è¾¾ï¼Œä½¿ç»†èƒé—´çš„æ–¹å·®ä¸º 1ã€‚è¿™ä¸€æ­¥åœ¨ä¸‹æ¸¸åˆ†æä¸­å…·æœ‰åŒç­‰çš„æƒé‡ï¼Œå› æ­¤é«˜è¡¨è¾¾åŸºå› ä¸ä¼šå ä¸»å¯¼åœ°ä½ã€‚</li>
<li>ç»“æœå­˜å‚¨åœ¨ <code>pbmc[["RNA"]]@scale.data</code>ã€‚</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all.genes</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/ScaleData.html">ScaleData</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all.genes</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>åœ¨ä½¿ç”¨ä¸Šè¿°å‘½ä»¤æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨æ‰€æœ‰åŸºå› æ¥ç¼©æ”¾æ•°æ®ã€‚ç¼©æ”¾æ˜¯ Seurat å·¥ä½œæµç¨‹ä¸­çš„é‡è¦æ­¥éª¤ï¼Œä½†ä»…é™äºå°†ç”¨ä½œ PCA è¾“å…¥çš„åŸºå› ã€‚å› æ­¤ï¼Œ<code><a href="https://satijalab.org/seurat/reference/ScaleData.html">ScaleData()</a></code>ä¸­çš„é»˜è®¤ä»…å¯¹å…ˆå‰ç¡®å®šçš„å¯å˜ç‰¹å¾ï¼ˆé»˜è®¤å€¼ä¸º2000ï¼‰æ‰§è¡Œç¼©æ”¾ã€‚è¿™å°†ä½¿è¿™ä¸€æ­¥æ›´å¿«ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„PCAå’Œèšç±»ç»“æœå°†ä¸å—å½±å“ã€‚ç„¶è€Œï¼ŒSeurat çƒ­å›¾ï¼ˆç”¨<code><a href="https://satijalab.org/seurat/reference/DoHeatmap.html">DoHeatmap()</a></code>ç”Ÿæˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰éœ€è¦å¯¹çƒ­å›¾ä¸­çš„åŸºå› è¿›è¡Œç¼©æ”¾ï¼Œä»¥ç¡®ä¿é«˜è¡¨è¾¾çš„åŸºå› ä¸ä¼šåœ¨çƒ­å›¾ä¸­å ä¸»å¯¼åœ°ä½ã€‚æˆ‘ä»¬åœ¨æœ¬æ•™ç¨‹ä¸­ç¼©æ”¾äº†æ‰€æœ‰åŸºå› ã€‚</p>
<p><code><a href="https://satijalab.org/seurat/reference/ScaleData.html">ScaleData()</a></code>å‡½æ•°è¿˜å…è®¸æˆ‘ä»¬ä»å•ä¸ªå•ç»†èƒæ•°æ®é›†ä¸­åˆ é™¤ä¸éœ€è¦çš„å˜å¼‚æºã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å›å½’ç§»é™¤ç»†èƒå‘¨æœŸé˜¶æ®µæˆ–çº¿ç²’ä½“æ±¡æŸ“ç›¸å…³çš„å¼‚è´¨æ€§ã€‚è¿™ä¸ªç‰¹æ€§å¯ä»¥é€šè¿‡æŒ‡å®š<code>vars.to.regress</code>æ¥å®ç°ã€‚å³ï¼š</p>
<pre><code># skip here
pbmc &lt;- ScaleData(pbmc, vars.to.regress = "percent.mt")</code></pre>
<p>ä½†æ˜¯ï¼Œç‰¹åˆ«æ˜¯å¯¹äºæƒ³è¦ä½¿ç”¨æ­¤åŠŸèƒ½çš„é«˜çº§ç”¨æˆ·ï¼ŒSeurat å»ºè®®ä½¿ç”¨ä»–ä»¬æ–°çš„æ ‡å‡†åŒ–å·¥ä½œæµ <code><a href="https://satijalab.org/seurat/reference/SCTransform.html">SCTransform()</a></code>ã€‚è¯¥æ–¹æ³•åœ¨ Seurat è®ºæ–‡(Hafemeister and Satija 2019)ä¸­è¿›è¡Œäº†æè¿°ï¼Œå¹¶æœ‰ä¸€ä¸ª<a href="https://satijalab.org/seurat/articles/sctransform_vignette.html">å•ç‹¬çš„æŠ€æœ¯æ–‡æ¡£</a>ã€‚ä¸<code><a href="https://satijalab.org/seurat/reference/ScaleData.html">ScaleData()</a></code> ä¸€æ ·ï¼Œå‡½æ•°<code><a href="https://satijalab.org/seurat/reference/SCTransform.html">SCTransform()</a></code>ä¹ŸåŒ…å«ä¸€ä¸ª<code>vars.to.regress</code>å‚æ•°ã€‚</p>
</section></section><section id="æ‰§è¡Œçº¿æ€§é™ç»´" class="level3"><h3 class="anchored" data-anchor-id="æ‰§è¡Œçº¿æ€§é™ç»´">æ‰§è¡Œçº¿æ€§é™ç»´</h3>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¹ç¼©æ”¾åçš„æ•°æ®æ‰§è¡Œ PCAã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåªä½¿ç”¨å…ˆå‰ç¡®å®šçš„å¯å˜ç‰¹å¾ä½œä¸ºè¾“å…¥ï¼Œä½†æ˜¯å¦‚æœä½ å¸Œæœ›é€‰æ‹©ä¸åŒçš„å­é›†ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ features å‚æ•°å®šä¹‰ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb34" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/RunPCA.html">RunPCA</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/VariableFeatures.html">VariableFeatures</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>object <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>Seuratæä¾›äº†å‡ ç§æœ‰ç”¨çš„æ–¹æ³•æ¥å¯è§†åŒ–å®šä¹‰ PCA çš„ç»†èƒå’Œç‰¹å¾ï¼ŒåŒ…æ‹¬<code><a href="https://satijalab.org/seurat/reference/VizDimLoadings.html">VizDimLoadings()</a></code>ã€<code><a href="https://satijalab.org/seurat/reference/DimPlot.html">DimPlot()</a></code> å’Œ <code><a href="https://satijalab.org/seurat/reference/DimHeatmap.html">DimHeatmap()</a></code>ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb35" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Examine and visualize PCA results a few different ways</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, nfeatures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PC_ 1 
Positive:  LTB, IL32, TRAC, CD3D, TRBC2 
Negative:  FCN1, FGL2, CST3, IFI30, TYMP 
PC_ 2 
Positive:  MS4A1, CD79A, BANK1, IGHM, NIBAN3 
Negative:  IL32, GZMM, CD3D, CD7, CD247 
PC_ 3 
Positive:  GZMB, CLIC3, NKG7, GNLY, KLRD1 
Negative:  CCR7, LEF1, TRABD2A, TCF7, LTB 
PC_ 4 
Positive:  CD79B, MS4A1, GNLY, CD79A, LINC00926 
Negative:  LILRA4, CLEC4C, SERPINF1, TPM2, SCT 
PC_ 5 
Positive:  CDKN1C, HES4, CTSL, TCF7L2, BATF3 
Negative:  S100A12, ITGAM, VCAN, CES1, MGST1 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb37" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VizDimLoadings.html">VizDimLoadings</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, reduction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb38" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimPlot.html">DimPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, reduction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>ç‰¹åˆ«æ˜¯ `DimHeatmap() å…è®¸è½»æ¾åœ°æ¢ç´¢æ•°æ®é›†ä¸­å¼‚æ„çš„ä¸»è¦æ¥æºï¼Œå¹¶ä¸”åœ¨è¯•å›¾å†³å®šå°†å“ªäº›pcåŒ…æ‹¬åœ¨è¿›ä¸€æ­¥çš„ä¸‹æ¸¸åˆ†æä¸­æ—¶éå¸¸æœ‰ç”¨ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb39" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimHeatmap.html">DimHeatmap</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, cells <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, balanced <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb40" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimHeatmap.html">DimHeatmap</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, cells <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, balanced <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>ä¸ºäº†å…‹æœscRNA-seqæ•°æ®ä¸­ä»»ä½•å•ä¸ªç‰¹å¾ä¸­å¹¿æ³›çš„æŠ€æœ¯å™ªå£°ï¼ŒSeuratåŸºäºå®ƒä»¬çš„PCAåˆ†æ•°å¯¹ç»†èƒè¿›è¡Œèšç±»ï¼Œæ¯ä¸ª PC æœ¬è´¨ä¸Šä»£è¡¨ä¸€ä¸ªâ€œå…ƒç‰¹å¾â€ï¼Œè¯¥å…ƒç‰¹å¾ç»“åˆäº†ç›¸å…³ç‰¹å¾é›†ä¸­çš„ä¿¡æ¯ã€‚å› æ­¤ï¼Œé¡¶éƒ¨ä¸»æˆåˆ†ä»£è¡¨äº†æ•°æ®é›†çš„é²æ£’å‹ç¼©ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©å‰20 ä¸ª PCã€‚</p>
</section><section id="ç»†èƒèšç±»" class="level3"><h3 class="anchored" data-anchor-id="ç»†èƒèšç±»">ç»†èƒèšç±»</h3>
<p>Seurat v3é‡‡ç”¨äº†åŸºäºå›¾çš„èšç±»æ–¹æ³•ï¼ŒåŸºäº(Macoskoç­‰äººï¼Œ2015)ä¸­çš„åˆå§‹ç­–ç•¥è¿›è¡Œæ”¹è¿›ã€‚é‡è¦çš„æ˜¯ï¼Œé©±åŠ¨èšç±»åˆ†æçš„è·ç¦»åº¦é‡ï¼ˆåŸºäºå…ˆå‰ç¡®å®šçš„ä¸»æˆåˆ†ï¼‰ä¿æŒä¸å˜ã€‚ç„¶è€Œï¼ŒSeuratåœ¨å°†ç»†èƒè·ç¦»çŸ©é˜µåˆ’åˆ†ä¸ºèšç±»çš„æ–¹æ³•æœ‰äº†æ˜¾è‘—æ”¹è¿›ã€‚è¿™ç§æ–¹æ³•å—åˆ°æœ€è¿‘ä¸€äº›ç ”ç©¶çš„å¯å‘ï¼Œè¿™äº›ç ”ç©¶å°†åŸºäºå›¾çš„èšç±»æ–¹æ³•åº”ç”¨äºscRNA-seqæ•°æ®ï¼ˆXuå’ŒSuï¼Œ2015ï¼‰å’ŒCyTOFæ•°æ®ï¼ˆLevineç­‰äººï¼Œ2015ï¼‰ã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¿™äº›æ–¹æ³•å°†ç»†èƒåµŒå…¥åˆ°ä¸€ä¸ªå›¾ç»“æ„ä¸­ï¼Œä¾‹å¦‚Kæœ€è¿‘é‚»ï¼ˆKNNï¼‰å›¾ï¼Œå…¶ä¸­ç±»ä¼¼ç‰¹å¾è¡¨è¾¾æ¨¡å¼çš„ç»†èƒä¹‹é—´æœ‰è¾¹è¿æ¥ï¼Œç„¶åå°è¯•å°†è¯¥å›¾åˆ’åˆ†ä¸ºé«˜åº¦ç›¸äº’è¿æ¥çš„â€œæ‹Ÿå›¢â€æˆ–â€œç¤¾åŒºâ€ã€‚</p>
<p>å°±åƒPhenoGraphä¸€æ ·ï¼Œé¦–å…ˆæ ¹æ®PCAç©ºé—´ä¸­çš„æ¬§æ°è·ç¦»æ„å»ºäº†ä¸€ä¸ªKæœ€è¿‘é‚»å›¾ï¼Œç„¶åæ ¹æ®å±€éƒ¨é‚»åŸŸä¸­çš„é‡å æƒ…å†µï¼ˆJaccardç›¸ä¼¼æ€§ï¼‰è°ƒæ•´ä»»æ„ä¸¤ä¸ªç»†èƒä¹‹é—´çš„è¾¹æƒé‡ã€‚è¿™ä¸ªæ­¥éª¤æ˜¯ä½¿ç”¨<code><a href="https://satijalab.org/seurat/reference/FindNeighbors.html">FindNeighbors()</a></code>å‡½æ•°å®Œæˆçš„ï¼Œå®ƒçš„è¾“å…¥æ˜¯ä¹‹å‰å®šä¹‰çš„æ•°æ®é›†çš„ç»´åº¦ï¼ˆå‰20ä¸ªä¸»æˆåˆ†ï¼‰ã€‚</p>
<p>ä¸ºäº†å¯¹ç»†èƒè¿›è¡Œèšç±»ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åº”ç”¨æ¨¡å—åº¦ä¼˜åŒ–æŠ€æœ¯ï¼Œå¦‚Louvainç®—æ³•ï¼ˆé»˜è®¤ï¼‰æˆ–SLMï¼ˆBlondelç­‰äººï¼Œ2008ï¼‰ï¼Œä»¥è¿­ä»£åœ°å°†ç»†èƒåˆ†ç»„åœ¨ä¸€èµ·ï¼Œç›®æ ‡æ˜¯ä¼˜åŒ–æ ‡å‡†çš„æ¨¡å—åº¦å‡½æ•°ã€‚<code><a href="https://satijalab.org/seurat/reference/FindClusters.html">FindClusters()</a></code>å‡½æ•°å®ç°äº†è¿™ä¸ªè¿‡ç¨‹ï¼Œå¹¶åŒ…å«ä¸€ä¸ªåˆ†è¾¨ç‡å‚æ•°ï¼Œç”¨äºè®¾ç½®ä¸‹æ¸¸èšç±»çš„â€œç²’åº¦â€ï¼Œå¢å¤§çš„å€¼ä¼šå¯¼è‡´æ›´å¤šçš„èšç±»ã€‚æˆ‘ä»¬å‘ç°ï¼Œåœ¨å¤§çº¦3Kä¸ªç»†èƒçš„å•ç»†èƒæ•°æ®é›†ä¸­ï¼Œå°†æ­¤å‚æ•°è®¾ç½®åœ¨ 0.4-1.2 ä¹‹é—´é€šå¸¸ä¼šå¾—åˆ°è‰¯å¥½çš„ç»“æœã€‚å¯¹äºæ›´å¤§çš„æ•°æ®é›†ï¼Œé€šå¸¸éœ€è¦å¢åŠ æœ€ä½³åˆ†è¾¨ç‡ã€‚å¯ä»¥ä½¿ç”¨<code><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html">Idents()</a></code>å‡½æ•°æ‰¾åˆ°è¿™äº›èšç±»ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb41" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html">FindNeighbors</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindClusters.html">FindClusters</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, resolution <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb42" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Look at cluster IDs of the first 5 cells</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html">Idents</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AAACCCAGTATCGTAC-1 AAACCCAGTCGGTGAA-1 AAACCCAGTTAGAAAC-1 AAACCCAGTTATCTTC-1 
                 2                  4                  2                  8 
AAACCCAGTTGCCGAC-1 
                 0 
Levels: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15</code></pre>
</div>
</div>
</section><section id="è¿è¡Œéçº¿æ€§é™ç»´-umaptsne" class="level3"><h3 class="anchored" data-anchor-id="è¿è¡Œéçº¿æ€§é™ç»´-umaptsne">è¿è¡Œéçº¿æ€§é™ç»´ UMAP/tSNE</h3>
<p>Seuratæä¾›å¤šç§éçº¿æ€§é™ç»´æŠ€æœ¯ï¼Œä¾‹å¦‚tSNEå’ŒUMAPï¼Œç”¨äºå¯è§†åŒ–å’Œæ¢ç´¢è¿™äº›æ•°æ®é›†ã€‚è¿™äº›ç®—æ³•çš„ç›®æ ‡æ˜¯å­¦ä¹ æ•°æ®çš„æ½œåœ¨æµå½¢ï¼Œä»¥ä¾¿å°†ç›¸ä¼¼çš„ç»†èƒæ”¾ç½®åœ¨ä½ç»´ç©ºé—´ä¸­çš„ä¸€èµ·ã€‚åœ¨ä¸Šè¿°åŸºäºå›¾çš„èšç±»ä¸­ç¡®å®šçš„ç»†èƒåº”åœ¨è¿™äº›é™ç»´å›¾ä¸­å…±åŒå®šä½ã€‚ä½œä¸ºUMAPå’ŒtSNEçš„è¾“å…¥ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ä¸èšç±»åˆ†æç›¸åŒçš„ä¸»æˆåˆ†ä½œä¸ºè¾“å…¥ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb44" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/RunUMAP.html">RunUMAP</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric
To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'
This message will be shown once per session</code></pre>
</div>
</div>
<p>ç„¶åå¾—åˆ°å•ç»†èƒèšç±»ç»“æœçš„UMAPå›¾ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb46" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimPlot.html">DimPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, reduction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"umap"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>ç±»ä¼¼åœ°ï¼ŒtSNEã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb47" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/RunTSNE.html">RunTSNE</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimPlot.html">DimPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, reduction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tsne"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>è´´ä¸Šèšç±»æ ‡ç­¾ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb48" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimPlot.html">DimPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, reduction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"umap"</span>, label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb49" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimPlot.html">DimPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>object <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/LabelClusters.html">LabelClusters</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>plot <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>, id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ident'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>æ˜¯æ—¶å€™ä¿å­˜æˆ‘ä»¬çš„åˆ†æç»“æœäº†ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb50" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, </span>
<span>file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/wsx/Library/CloudStorage/OneDrive-shanghaitech.edu.cn/Public/data/pbmc_processed.rds"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>


</section></section> ]]></description>
  <category>note</category>
  <category>scRNA-seq</category>
  <category>R</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index.html</guid>
  <pubDate>Wed, 12 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-07-13</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-13-journal/index.html</link>
  <description><![CDATA[ 




<p>ä»Šå¤©è¿˜æ˜¯æ‘˜è¦ä¹¦ä¸­çœ‹åˆ°çš„è¯ã€‚</p>
<blockquote class="blockquote">
<p>æˆ‘ä»¬é¢ä¸´çš„ï¼Œå°±æ˜¯ä¸¤ä¸ªåˆ†ç¦»çš„ä¸–ç•Œï¼šä¸€ä¸ªä¸–ç•Œæ˜¯æˆ‘ä»¬çœŸå®çš„ä¸–ç•Œã€çœ‹å¾—è§æ‘¸å¾—ç€çš„ç‰©ç†ä¸–ç•Œã€‚ åœ¨è¿™é‡Œï¼Œä¸€åˆ‡éƒ½æŒ‰ç…§è‡ªç„¶è§„å¾‹æœ‰æ¡ä¸ç´Šåœ°è¿›è¡Œç€ã€‚å¦ä¸€ä¸ªæ˜¯çœ‹ä¸è§ã€æ‘¸ä¸ç€çš„è§‚å¿µä¸–ç•Œã€‚ åœ¨é‚£é‡Œï¼Œäººä»¬æ—¶åˆ»åœ¨å½¢æˆã€æ¯”è¾ƒã€äº¤æ¢å’Œä¿®æ­£å¯¹æœªæ¥çš„é¢„æœŸã€‚</p>
</blockquote>
<blockquote class="blockquote">
<p>æ¯ä¸ªäººç”Ÿæ´»åœ¨ä¸–ç•Œä¸Šï¼Œéƒ½è‡³å°‘é¢ä¸´å››ç§æœ€åŸºæœ¬çš„çº¦æŸï¼Œé‚£å°±æ˜¯ï¼š ä¸œè¥¿ä¸å¤Ÿã€æ—¶é—´æœ‰é™ã€ç›¸äº’ä¾èµ–ã€éœ€è¦åè°ƒã€‚</p>
</blockquote>
<p>â€”â€”ã€Šè–›å…†ä¸°ç»æµå­¦è®²ä¹‰ã€‹</p>



 ]]></description>
  <category>journal</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-13-journal/index.html</guid>
  <pubDate>Wed, 12 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-07-12</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-12-journal/index.html</link>
  <description><![CDATA[ 




<p>åœ¨çœ‹æ–‡çŒ®çš„æ—¶å€™å‘ç°ä¸€ä¸ªè‡ªç›‘ç£å­¦ä¹ ï¼Œæˆ‘çœ‹è‹±æ–‡æœ‰ä¸ª superviseï¼Œä»¥ä¸ºè¿™æ˜¯å¸¦æ ‡ç­¾çš„å­¦ä¹ ï¼Œäº†è§£åå‘ç°åŸæ¥å¹¶éå¦‚æ­¤ã€‚è¿™é‡Œè®°å½•ä¸‹ ChatGPT å…³äºè‡ªç›‘ç£å­¦ä¹ å’Œç›‘ç£å­¦ä¹ çš„å›ç­”ã€‚ä»¥åæœ‰æœºä¼šå®è·µæ·±å…¥äº†è§£ä¸‹ã€‚</p>
<p>è‡ªç›‘ç£å­¦ä¹ å’Œç›‘ç£å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ ä¸­ä¸¤ç§ä¸åŒçš„æ–¹æ³•ã€‚</p>
<p>ç›‘ç£å­¦ä¹ æ˜¯ä¸€ç§å¸¸è§çš„æœºå™¨å­¦ä¹ æ–¹æ³•ï¼Œå…¶ä¸­æ¨¡å‹é€šè¿‡ä½¿ç”¨å¸¦æœ‰æ ‡ç­¾çš„è®­ç»ƒæ•°æ®è¿›è¡Œè®­ç»ƒã€‚åœ¨ç›‘ç£å­¦ä¹ ä¸­ï¼Œè¾“å…¥å’Œç›¸åº”çš„è¾“å‡ºä¹‹é—´å­˜åœ¨ä¸€ä¸ªæ˜ç¡®çš„æ˜ å°„å…³ç³»ã€‚è®­ç»ƒæ•°æ®åŒ…å«äº†è¾“å…¥æ ·æœ¬åŠå…¶å¯¹åº”çš„é¢„æœŸè¾“å‡ºæ ‡ç­¾ã€‚æ¨¡å‹æ ¹æ®è¿™äº›æ ‡ç­¾æ¥è°ƒæ•´è‡ªèº«çš„å‚æ•°ï¼Œä»¥ä½¿é¢„æµ‹ç»“æœå°½å¯èƒ½æ¥è¿‘äºçœŸå®æ ‡ç­¾ã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾åƒåˆ†ç±»ä»»åŠ¡ä¸­ï¼Œç›‘ç£å­¦ä¹ ä¼šä½¿ç”¨å¸¦æœ‰æ ‡ç­¾çš„å›¾åƒæ¥è®­ç»ƒæ¨¡å‹ï¼Œä½¿å…¶èƒ½å¤Ÿæ ¹æ®è¾“å…¥å›¾åƒæ­£ç¡®åœ°é¢„æµ‹å…¶æ‰€å±çš„ç±»åˆ«ã€‚</p>
<p>è‡ªç›‘ç£å­¦ä¹ åˆ™æ˜¯ä¸€ç§æ— ç›‘ç£å­¦ä¹ çš„å½¢å¼ï¼Œå…¶ä¸­æ¨¡å‹åœ¨æ²¡æœ‰äººå·¥æ ‡ç­¾çš„æƒ…å†µä¸‹è¿›è¡Œè®­ç»ƒã€‚ç›¸åï¼Œè‡ªç›‘ç£å­¦ä¹ åˆ©ç”¨è¾“å…¥æ•°æ®ä¸­çš„æŸç§è‡ªåŠ¨ç”Ÿæˆçš„æ ‡ç­¾æˆ–ä¿¡æ¯æ¥è¿›è¡Œè®­ç»ƒã€‚è¿™äº›è‡ªåŠ¨ç”Ÿæˆçš„æ ‡ç­¾å¯ä»¥æ˜¯è¾“å…¥æ•°æ®çš„æŸç§å˜æ¢ã€éƒ¨åˆ†ä¿¡æ¯æˆ–å…¶ä»–æ–¹å¼ç”Ÿæˆçš„ã€‚ä¾‹å¦‚ï¼Œåœ¨è‡ªæˆ‘å¯¹æ¯”å­¦ä¹ ä¸­ï¼Œæ¨¡å‹ä¼šå°†è¾“å…¥æ•°æ®åˆ†ä¸ºä¸¤ä¸ªè§†å›¾ï¼Œå¹¶é¼“åŠ±æ¨¡å‹å°†å®ƒä»¬è§†ä¸ºç›¸ä¼¼ã€‚é€šè¿‡æœ€å¤§åŒ–è¿™ä¸¤ä¸ªè§†å›¾ä¹‹é—´çš„ç›¸ä¼¼æ€§åº¦é‡ï¼Œæ¨¡å‹å¯ä»¥å­¦ä¹ åˆ°æ•°æ®çš„æœ‰ç”¨è¡¨ç¤ºã€‚è‡ªç›‘ç£å­¦ä¹ çš„ç›®æ ‡æ˜¯é€šè¿‡å­¦ä¹ æ•°æ®ä¸­çš„å†…åœ¨ç»“æ„æˆ–æ¨¡å¼æ¥è®­ç»ƒæ¨¡å‹ï¼Œè€Œæ— éœ€äººå·¥æ ‡ç­¾ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œç›‘ç£å­¦ä¹ ä¾èµ–äºå¸¦æœ‰äººå·¥æ ‡ç­¾çš„è®­ç»ƒæ•°æ®ï¼Œè€Œè‡ªç›‘ç£å­¦ä¹ åˆ™é€šè¿‡åˆ©ç”¨æ•°æ®ä¸­çš„æŸç§è‡ªåŠ¨ç”Ÿæˆçš„æ ‡ç­¾æˆ–ä¿¡æ¯æ¥è¿›è¡Œè®­ç»ƒã€‚è‡ªç›‘ç£å­¦ä¹ åœ¨æ— æ³•è·å¾—å¤§é‡å¸¦æœ‰æ ‡ç­¾çš„æ•°æ®æ—¶å°¤ä¸ºæœ‰ç”¨ï¼Œå¹¶ä¸”å·²ç»åœ¨å¤šä¸ªé¢†åŸŸä¸­å–å¾—äº†æ˜¾è‘—çš„ç ”ç©¶è¿›å±•ã€‚</p>



 ]]></description>
  <category>journal</category>
  <category>machine-learning</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-12-journal/index.html</guid>
  <pubDate>Tue, 11 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>scrna æ ¸å¿ƒå·¥å…·</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-10-scrna-recom/index.html</link>
  <description><![CDATA[ 




<p>Repo {<a href="https://github.com/WXlab-NJMU/scrna-recom">scrna-recom</a>} å•ç»†èƒç»¼è¿°æ–‡ç« å…³äºå•ç»†èƒè½¬å½•ç»„åˆ†æçš„æµç¨‹ã€è½¯ä»¶ã€å®‰è£…ç­‰çš„ä¸€äº›è¯´æ˜ã€‚è¿™é‡Œæˆ‘ä¸»è¦æ˜¯æ‹·è´ä¸‹å…¶ä¸­å…³äºæ ¸å¿ƒå·¥å…·çš„æ•´ç†ï¼Œé˜²æ­¢è¿·å¤±ã€‚</p>

<style>
    table {
        border-collapse: collapse;
        width: 100%;
        font-family: Arial, sans-serif;
    }

    th,
    td {
        border: 1px solid #ddd;
        padding: 8px;
    }

    th {
        background-color: #f2f2f2;
    }

    a {
        text-decoration: underline;
    }
</style>
<table>
<thead>
<tr>
<th>
</th>
<th>
Package
</th>
<th>
Tutorial
</th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="1">
Raw Data Processing
</td>
<td>
Cell Ranger
</td>
<td>
<a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger">https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger</a>
</td>
</tr>
<tr>
<td rowspan="3">
Quality Control
</td>
<td>
DoubletFinder
</td>
<td>
<a href="https://github.com/chris-mcginnis-ucsf/DoubletFinder">https://github.com/chris-mcginnis-ucsf/DoubletFinder</a>
</td>
</tr>
<tr>
<td>
Seurat
</td>
<td>
<a href="https://satijalab.org/seurat/articles/pbmc3k_tutorial.html">https://satijalab.org/seurat/articles/pbmc3k_tutorial.html</a>
</td>
</tr>
<tr>
<td>
SoupX
</td>
<td>
<a href="https://rawcdn.githack.com/constantAmateur/SoupX/204b602418df12e9fdb4b68775a8b486c6504fe4/inst/doc/pbmcTutorial.html">https://rawcdn.githack.com/constantAmateur/SoupX/204b602418df12e9fdb4b68775a8b486c6504fe4/inst/doc/pbmcTutorial.html</a>
</td>
</tr>
<tr>
<td rowspan="1">
Normalization
</td>
<td>
Seurat
</td>
<td>
<a href="https://satijalab.org/seurat/articles/pbmc3k_tutorial.html#normalizing-the-data-1">https://satijalab.org/seurat/articles/pbmc3k_tutorial.html#normalizing-the-data-1</a>
</td>
</tr>
<tr>
<td rowspan="3">
Integration
</td>
<td>
Seurat:CCA,RPCA
</td>
<td>
<a href="https://satijalab.org/seurat/articles/integration_rpca.html">https://satijalab.org/seurat/articles/integration_rpca.html</a>
</td>
</tr>
<tr>
<td>
Liger
</td>
<td>
<a href="https://github.com/welch-lab/liger">https://github.com/welch-lab/liger</a>
</td>
</tr>
<tr>
<td>
Harmony
</td>
<td>
<a href="https://github.com/immunogenomics/harmony">https://github.com/immunogenomics/harmony</a>
</td>
</tr>
<tr>
<td rowspan="1">
Dimensional Reduction
</td>
<td>
Seurat:PCA,UMAP
</td>
<td>
<a href="https://satijalab.org/seurat/articles/pbmc3k_tutorial.html#perform-linear-dimensional-reduction-1">https://satijalab.org/seurat/articles/pbmc3k_tutorial.html#perform-linear-dimensional-reduction-1</a>
</td>
</tr>
<tr>
<td rowspan="1">
Clustering
</td>
<td>
Seurat
</td>
<td>
<a href="https://satijalab.org/seurat/articles/pbmc3k_tutorial.html#cluster-the-cells-1">https://satijalab.org/seurat/articles/pbmc3k_tutorial.html#cluster-the-cells-1</a>
</td>
</tr>
<tr>
<td rowspan="2">
Cell type annotation
</td>
<td>
SingleR
</td>
<td>
<a href="https://github.com/dviraran/SingleR">https://github.com/dviraran/SingleR</a>
</td>
</tr>
<tr>
<td>
scCATCH
</td>
<td>
<a href="https://github.com/ZJUFanLab/scCATCH">https://github.com/ZJUFanLab/scCATCH</a>
</td>
</tr>
<tr>
<td rowspan="1">
Regulon analysis
</td>
<td>
SCENIC
</td>
<td>
<a href="https://pyscenic.readthedocs.io/en/latest/">https://pyscenic.readthedocs.io/en/latest/</a>
</td>
</tr>
<tr>
<td rowspan="2">
Trajectory inference
</td>
<td>
Monocle3
</td>
<td>
<a href="https://cole-trapnell-lab.github.io/monocle3/">https://cole-trapnell-lab.github.io/monocle3/</a>
</td>
</tr>
<tr>
<td>
scVelo
</td>
<td>
<a href="https://github.com/theislab/scvelo">https://github.com/theislab/scvelo</a>
</td>
</tr>
<tr>
<td rowspan="1">
Cell communication
</td>
<td>
CellChat
</td>
<td>
<a href="https://github.com/sqjin/CellChat">https://github.com/sqjin/CellChat</a>
</td>
</tr>
<tr>
<td rowspan="2">
Metabolic analysis
</td>
<td>
scMetabolism
</td>
<td>
<a href="https://github.com/wu-yc/scMetabolism">https://github.com/wu-yc/scMetabolism</a>
</td>
</tr>
<tr>
<td>
scFEA
</td>
<td>
<a href="https://github.com/changwn/scFEA">https://github.com/changwn/scFEA</a>
</td>
</tr>
</tbody>

</table>
<p>Workflow:</p>
<p><img src="https://shixiangwang.github.io/posts/2023-07-10-scrna-recom/https:/raw.githubusercontent.com/WXlab-NJMU/scrna-recom/main/img/workflow.png" class="img-fluid"></p>



 ]]></description>
  <category>note</category>
  <category>scRNA-seq</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-10-scrna-recom/index.html</guid>
  <pubDate>Sun, 09 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-07-10</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-10-journal/index.html</link>
  <description><![CDATA[ 




<p>ä»Šå¤©ç»ˆäºçœ‹å®Œäº†ã€Šç™Œç”Ÿç‰©å­¦ã€‹ï¼Œå…·ä½“è€Œè¨€ï¼Œæ˜¯ã€Œç æ±Ÿè‚¿ç˜¤ã€å…¬ä¼—å·æ•´ç†çš„ä¸­æ–‡ç‰ˆã€Šç™Œç”Ÿç‰©å­¦ã€‹çš„å†…å®¹ã€‚</p>
<p>å½“å¹´é˜…è¯»è®¡åˆ’å•ä¸Šç»ˆäºå¯ä»¥åˆ’å»ä¸€é¡¹äº†ï¼Œç¨ç¨æ¾äº†ä¸€å£æ°”ã€‚è¿™å‡ å¹´ï¼Œè™½ç„¶æˆ‘è¯»å®Œäº†ä¸å°‘â€œé—²ä¹¦â€å’Œç½‘æ–‡å°è¯´ï¼Œä½†é˜…è¯»ï¼Œç‰¹åˆ«æ˜¯ è¯»å®Œçš„å·¥ä½œé¢†åŸŸç›¸å…³å›¾ä¹¦å‡ ä¹æ˜¯æ²¡æœ‰çš„ã€‚æ•™ç§‘ä¹¦ç±»å­—å°‘ï¼Œä½†ç†è§£ã€æ€è€ƒå´éå¸¸è´¹æ—¶è´¹åŠ›ï¼Œå……æ»¡æŒ‘æˆ˜ã€‚ è¿™é‡Œéœ€è¦æ„Ÿè°¢å…¬ä¼—å·çš„ä½œè€…çš„æ‚‰å¿ƒæ•´ç†ï¼Œå½“ç„¶ä¹Ÿç‰¹åˆ«æ„Ÿè°¢å›¾ä¹¦çš„ä½œè€…å’Œè¯‘è€…ã€‚</p>
<blockquote class="blockquote">
<ul>
<li><p>å…¬ä¼—å·<a href="https://mp.weixin.qq.com/s/J8pCYKlkM9t0k2_IiJYd3A">ç™Œç”Ÿç‰©å­¦æ±‡æ€»å¸–</a></p></li>
<li><p><a href="https://www.aliyundrive.com/s/LH337LnhkzX">ç™Œç”Ÿç‰©å­¦PDF.pdf</a></p></li>
</ul>
</blockquote>
<p>å¾ˆå¤šå†…å®¹è¯»çš„å¾ˆæµ…ï¼Œæœ‰äº›å†…å®¹ä¹Ÿè·³è¯»äº†ï¼Œä½†ç¿»å®Œäº†ï¼Œå¿ƒé‡Œå¥½åƒâ€œé´å­è½åœ°â€äº†ã€‚è¿™ä¹Ÿç»™äº†æˆ‘è‡ªä¿¡å’Œæ—¶é—´å»å…³æ³¨å’Œå®Œæˆå…¶ä»–çš„äº‹æƒ…ã€‚</p>
<p>è¿™ä¸¤å¹´ï¼Œæˆ‘åœ¨ç”Ÿæ´»å’Œå·¥ä½œä¸­éƒ½é‡åˆ°äº†å¿ƒé‡Œéš¾ä»¥è¨€è¡¨çš„å›°éš¾ï¼Œè¿™ç§å›°éš¾æ¥è‡ªæ„Ÿå—ï¼Œä¹Ÿéƒ¨åˆ†æ¥è‡ªç‰©è´¨ã€‚åˆ‡å®åœ°èå…¥ç”Ÿæ´»ï¼Œæ‰å‘ç”Ÿç”Ÿæ´»æœ‰é‚£ä¹ˆå¤šçš„çäº‹ï¼Œå¾ˆå¤šäº‹æƒ…éœ€è¦è€—è´¹å¿ƒåŠ›ï¼Œå´æ„Ÿå—ä¸Šâ€œæ†‹â€çš„å¾ˆã€‚æˆ‘å¸¸å¸¸ä¼šæƒ³åœ¨å¿ƒé‡Œæ‰¾ä¸ªè§’è½èº²èµ·æ¥ã€‚ä¹Ÿæœ‰æ—¶ä¼šåœ¨æ¸¸æˆã€å°è¯´å’Œå¿ƒçµçš„å­¤ç‹¬ä¸­æ”¾é€è‡ªæˆ‘ã€‚ äººä¸æ˜¯æœºå™¨ï¼Œå®ƒä¸èƒ½ä¸€ç›´äº§ç”Ÿæ­£èƒ½é‡ã€‚æˆ‘ä»¬éƒ½æ˜¯å¤§å¤§å®‡å®™ä¸­å°å°åœ°çƒä¸Šä¸€ä¸ªä¸ªæ´»ç€çš„å‘å¾®çš„äººï¼Œæˆ‘ä»¬æƒ³è¦è¯‰æ±‚ä¼Ÿå¤§ï¼Œä½†è·Œå…¥çš„æ˜¯ç»Ÿè®¡çš„æ·±æ¸Šã€‚</p>
<p>ä¸ç®¡æ€æ ·ï¼Œæˆ‘ä»¬çš„é“è·¯ï¼Œå°±æ˜¯è¦å®Œæˆä¸€ä¸ªä¸€ä¸ªæƒ³åšçš„äº‹æƒ…ï¼Œç„¶åç»§ç»­å‘å‰ã€‚</p>



 ]]></description>
  <category>journal</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-10-journal/index.html</guid>
  <pubDate>Sun, 09 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>might &amp; right</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-10-might-and-right/index.html</link>
  <description><![CDATA[ 




<p>æ‘˜å½•ä¸€å¥è¯ã€‚</p>
<p>èƒ½åŠ›ï¼šmight</p>
<p>æƒåˆ©ï¼šright</p>
<p>èƒ½åŠ›å–å†³äºè‡ªå·±èƒ½å¤Ÿå æœ‰å¤šå°‘ï¼Œè€Œæƒåˆ©å–å†³äºç¤¾ä¼šä¸Šå…¶ä»–äººæ„¿æ„ç»™ä½ å¤šå°‘ã€‚</p>
<hr>
<p>æ‰€ä»¥ï¼Œè¯¥è¿½æ±‚å“ªç§å‘¢ï¼Ÿ</p>



 ]]></description>
  <category>note</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-10-might-and-right/index.html</guid>
  <pubDate>Sun, 09 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-07-06</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-06-journal/index.html</link>
  <description><![CDATA[ 




<p>é¡¾ç¥æ˜¨å¤©å…¬ä¼—å·<a href="https://mp.weixin.qq.com/s/ke-ko1A7MdOBxSS9lxIsGg">åæ§½ä»–çš„æµ·å¤–ä¼˜é’æ²¡æœ‰ä¸Šä¼š</a>ï¼Œæˆ‘æ·±è¡¨é—æ†¾ã€‚</p>
<p>æˆ‘æ ¹æ®è¿™å‡ å¹´é€æ­¥å¯¹å­¦æœ¯ç•Œçš„äº†è§£å’Œé¢†ä¼šï¼Œåˆ†æå¯èƒ½æœ‰ä»¥ä¸‹ä¸€äº›åŸå› ï¼š</p>
<ol type="1">
<li>ç¼ºä¹å¤§å­åˆŠåŠä»¥ä¸Šçš„ä¸€ä½œå’Œé€šè®¯ï¼›</li>
<li>å›½å†…ç¼ºä¹ç”Ÿç‰©åŒ»å­¦å„ç§å±±å¤´çš„ç¡¬çš„åˆä½œå’Œå…³ç³»ï¼›</li>
<li>çº¯ç”Ÿä¿¡åŸºç¡€è®¾æ–½çš„ç ”ç©¶å·¥ä½œä¸è¢«è¯„å®¡äººè®¤å¯ï¼Œæˆ‘è‡ªå·±ç”³è¯·å›½è‡ªç„¶åŸºé‡‘æ—¶å°±æ„Ÿè§‰ç”Ÿä¿¡å·¥ä½œå¦‚æœæ‰¯ä¸ä¸Šâ€œåˆ†å­æœºåˆ¶â€å°±è¢«è®¤ä¸ºä¸æ˜¯â€œè‡ªç„¶ç§‘å­¦â€ï¼›</li>
<li>åŸºé‡‘æœ¬å­æ²¡æœ‰çªå‡ºä¼˜åŠ¿ï¼Œä¸Šä¼šä¹‹å‰åº”è¯¥æ˜¯æœ‰å¤šä¸ªè¯„å®¡äººåŸºäºä¸åŒçš„æ–¹é¢è¯„ä¼°ç­‰çº§ï¼Œæ‰€ä»¥å¾ˆå¯èƒ½å†™çš„æœ¬å­ä¸å¯¹å›½å†…çš„â€œå£å‘³â€ã€‚</li>
</ol>
<p>å›½å†…çš„å­¦æœ¯æ¡ä»¶ç¡®å®åœ¨è¶Šæ¥è¶Šå¥½ï¼Œè¿™å¸å¼•äº†è¶Šæ¥è¶Šå¤šæµ·å¤–ä¼˜ç§€çš„é’å¹´å›å›½å‘å±•ã€‚ ä½†ç›®å‰å›½å†…é•¿æœŸä¸æ­£å¸¸çš„å­¦æœ¯åœŸå£¤ä¸ºç¥¸å°¤çƒˆï¼Œå¸Œæœ›æœªæ¥åœ¨æ”¿åºœçš„å¼•å¯¼ä¸‹ã€æœ‰è¯†ä¹‹å£«çš„å»ºè®¾ä¸‹ æœç€è‰¯å¥½çš„æ–¹å‘å‰è¿›ã€‚å­¦æœ¯æ˜¯åˆ›æ–°æ¢ç´¢ï¼Œä¹Ÿæ˜¯èµ„æºçš„åˆ†é…ï¼Œå¸Œæœ›ä»¥åèµ„æºèƒ½å¤Ÿæ›´ä¸»åŠ¨åœ°åˆ†é… åˆ°ä¸åŒé¢†åŸŸçš„å„ä¸ªè§’è½ï¼Œè€Œä¸æ˜¯å„å¤§é—¨æ´¾å±±å¤´ã€‚</p>



 ]]></description>
  <category>journal</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-06-journal/index.html</guid>
  <pubDate>Wed, 05 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>ç”Ÿç‰©åŒ»å­¦èƒ½ç¦»å¼€ç”Ÿç‰©ä¿¡æ¯å­¦å—ï¼Ÿ</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-06-can-biology-live-without-bioinformatics/index.html</link>
  <description><![CDATA[ 




<p>ä¸èƒ½ã€‚</p>
<p>æ•´ä¸ªç”Ÿç‰©åŒ»å­¦é¢†åŸŸï¼Œå·²ç»ç”±å®éªŒç§‘å­¦è¿›å…¥äº†æ•°æ®ç§‘å­¦çš„å±‚æ¬¡ï¼Œè€Œè¿™ä¸€ç‚¹æ— æ³•å†å€’é€€ã€‚ ç”Ÿç‰©ä¿¡æ¯å­¦è€…/å®¶ï¼ˆbioinformatian/computational biologistï¼‰ï¼Œå·²ç»æˆä¸ºäº†è¯¥é¢†åŸŸä¸å¯æˆ–ç¼ºçš„å­˜åœ¨ã€‚æ— è®ºæ˜¯ç‹­ä¹‰çš„ç»„å­¦ï¼Œè¿˜æ˜¯æ›´å¹¿ä¹‰çš„åˆ†å­ç»“æ„è®¡ç®—/å›¾å½¢å¤„ç†ç­‰ï¼Œç”Ÿç‰©ä¿¡æ¯å­¦è€…å·²ç»æˆä¸ºäº†ç§‘å­¦å‘ç°/æŠ€æœ¯åˆ›é€ çš„ä¸­é—´åŠ›é‡ã€‚è¿™ä¹Ÿæ­£æ˜¯ä¸ºä»€ä¹ˆä»äº‹ç”Ÿç‰©ä¿¡æ¯å­¦çš„äººèƒ½ä»è‡´è°¢åå•ä¸­èµ°åˆ°ä½œè€…åˆ—è¡¨ï¼Œèµ°åˆ°ç¬¬ä¸€/é€šè®¯ä½œè€…çš„æ ¹æœ¬åŸå› ã€‚</p>
<p>å¦‚æœä½ æ˜¯ä¸€ä¸ªçº¯æ¹¿å®éªŒçš„ç ”ç©¶è€…ï¼Œä½ è¿˜åœ¨å¿ƒé‡Œé„™å¤·è¿™ä¸ªè¡Œä¸šï¼Œä½ å°±åº”è¯¥åæ€äº†ï¼Œæ—¶ä»£çš„è¿›æ­¥ä¸ä¼šç­‰å¾…ä½ çš„è½åã€‚</p>



 ]]></description>
  <category>thought</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-06-can-biology-live-without-bioinformatics/index.html</guid>
  <pubDate>Wed, 05 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>åšå®¢ links</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-02-links/index.html</link>
  <description><![CDATA[ 




<p>ä¹‹å‰åœ¨æ„å»ºä¸ªäººåŸŸåç½‘ç«™ &lt;shixiangwang.work&gt; æ—¶ï¼ŒæŠŠæµè§ˆå™¨ä¹¦ç­¾çš„æ‰€æœ‰åšå®¢é“¾æ¥éƒ½è¿›è¡Œäº†æ•´ç†ã€‚</p>
<p>ç”±äºäº‘æœåŠ¡å™¨çš„æ—¶é—´æœ‰é™ï¼Œè¿ç»´å®é™…æˆæœ¬æƒ³äº†æƒ³è¿˜æ˜¯è›®é«˜çš„ï¼Œæ²¡å¤šä¹…åä¹Ÿæ²¡è€ƒè™‘å†ç»´æŠ¤äº†ã€‚ è¿™é‡ŒæŠŠä¹‹å‰æ•´ç†çš„é“¾æ¥å¤‡ä»½ä¸€ä¸‹ï¼Œä»¥æ–¹ä¾¿æŸ¥æ‰¾å¤ç”¨ï¼Œå¦‚æœå¯¹ä¸€äº›è¯»è€…æœ‰å¸®åŠ©ä¹Ÿæ˜¯æå¥½çš„äº†ã€‚</p>
<p><a href="å‹é“¾ _ ç‹è¯—ç¿” NetSpace.html">ç‚¹å‡»æŸ¥çœ‹é“¾æ¥</a></p>



 ]]></description>
  <category>note</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-02-links/index.html</guid>
  <pubDate>Sat, 01 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-07-02</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-02-journal/index.html</link>
  <description><![CDATA[ 




<p>ä»Šå¤©æ‘˜å½•ä»ä¹¦ä¸­çœ‹åˆ°çš„ä¸€å¥è¯ã€‚</p>
<blockquote class="blockquote">
<p>æˆ‘ä»¬åº”è¯¥åˆ©ç”¨è‡ªå·±æœ‰é™çš„æ—¶é—´ã€æœ‰é™çš„ç²¾åŠ›ï¼Œåœ¨è‡ªå·±æ‰€èƒ½æ¶‰åŠçš„æ‰€æœ‰é¢†åŸŸã€æ‰€æœ‰æ´»åŠ¨ã€æ‰€æœ‰é€‰é¡¹ä¸­ï¼Œ æ ¹æ®è¾¹é™…å¹³è¡¡çš„è§„å¾‹æ¥åˆ†é…æ—¶é—´ã€é‡‘é’±ã€ç²¾åŠ›å’Œå…¶ä»–èµ„æºï¼Œä»è€Œä½¿æ€»æ•ˆç”¨è¾¾åˆ°æœ€å¤§ã€‚</p>
</blockquote>
<p>è¿™æ¦‚æ‹¬äº†ç”Ÿå‘½ä¸€ç”Ÿçš„æ‰€æœ‰åŠªåŠ›ã€‚</p>



 ]]></description>
  <category>journal</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-02-journal/index.html</guid>
  <pubDate>Sat, 01 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-06-28</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-06-28-journal/index.html</link>
  <description><![CDATA[ 




<p>åšæŒå­¦ä¹ ï¼ŒåšæŒåŒä¸€ç§å†…å®¹çš„å­¦ä¹ ã€‚</p>
<p>å·¥ä½œã€ç”Ÿæ´»è¶Šæ¥è¶Šè®©æ—¶é—´ç¢ç‰‡åŒ–ï¼Œæˆ‘å¸¸å¸¸åœ¨å›å®¶åå¿˜è®°æƒ³è¦åšçš„å·¥ä½œå’Œå­¦ä¹ å†…å®¹ï¼Œåœ¨ä¸Šç­çš„ç©ºé—²æ—¶é—´ä¹Ÿå¸¸å¿˜è®°å®¶é‡Œè¦å¤„ç†çš„æ‚äº‹ï¼Œæ¯”å¦‚è´­ç½®ä¸€äº›ç¼ºå°‘çš„ç”Ÿæ´»ç”¨å“ã€‚å¯è§ï¼Œè¿™ç§ç¢ç‰‡åŒ–éå¸¸å½±å“è®°å¿†ï¼Œè‡ªç„¶å°±å½±å“æ—¥å¸¸çš„å­¦ä¹ è¿›åº¦äº†ã€‚</p>
<p>ä¸ºäº†æŠµæŠ—è¿™ç§æƒ…å†µï¼Œå°±è¦è‡ªå¾‹ï¼Œä¸è®ºå„ç§äº‹æƒ…ï¼Œåªè¦å®šä¸‹äº†è¿‘æœŸçš„å­¦ä¹ ç›®æ ‡ï¼Œåœ¨ä¸€ä¸¤å¤©å†…å¿…é¡»è¦æœ‰è·Ÿè¿›ã€‚å¦‚æœæ”¾åˆ°ä¸€å‘¨åå†æ¥åšï¼Œå¯èƒ½è¦åšä»€ä¹ˆéƒ½è¦å›æƒ³åŠä¸ªå°æ—¶ã€‚ä¹‹å‰å†™ Python åŸºç¡€æ•™ç¨‹ä¹¦æœŸé—´æˆ‘å°±æœ‰åŠå¹´å› ä¸ºè¿™ç§äº‹æƒ…è€Œç„¦è™‘ã€‚</p>
<p>äººæœ€å¯è´µçš„æ˜¯æ€è€ƒå¹¶ä»˜è¯¸äºè¡ŒåŠ¨ï¼Œä¸æ˜¯å—ï¼Ÿ</p>



 ]]></description>
  <category>journal</category>
  <guid>https://shixiangwang.github.io/posts/2023-06-28-journal/index.html</guid>
  <pubDate>Tue, 27 Jun 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-06-27</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-06-27-journal/index.html</link>
  <description><![CDATA[ 




<p>ä»Šå¤©è®°å½•åœ¨ã€Šç»æµå­¦è®²ä¹‰ã€‹ä¸­çœ‹åˆ°çš„ä¸€å¥è¯ï¼š</p>
<blockquote class="blockquote">
<p>ä½ æ‹¥æœ‰ä½ çš„ç”Ÿå‘½ï¼Œä½†æ˜¯ä½ çš„ç”Ÿå‘½æ˜¯æ€ä¹ˆåº¦è¿‡çš„ï¼Œä½ çš„èŒä¸šæ˜¯æ€æ ·é€‰æ‹©çš„ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ç”±ç¤¾ä¼šä¸Šå…¶ä»–äººå†³å®šçš„ã€‚</p>
</blockquote>



 ]]></description>
  <category>journal</category>
  <guid>https://shixiangwang.github.io/posts/2023-06-27-journal/index.html</guid>
  <pubDate>Mon, 26 Jun 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-06-26</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-06-26-journal/index.html</link>
  <description><![CDATA[ 




<p>ç–«æƒ…ä¹‹åæŠ—æ„Ÿå†’èƒ½åŠ›ç¡®å®å˜å¾—æ›´åŠ ç³Ÿç³•äº†ï¼Œä¸Šä¸€æ¬¡äºŒé˜³ï¼ˆæœ¬ä»¥ä¸ºæ˜¯é‡æ„Ÿå†’ï¼‰åå¤šå¤©ä¹‹ååœ¨ç«¯åˆä¹‹å‰ç»ˆäºæ„Ÿè§‰åˆ°å·®ä¸å¤šå¥½äº†ï¼Œç«¯åˆå»äº†è¶Ÿæ·±åœ³å›å®¶åˆæ„Ÿè§‰ä¸å¥½äº†ï¼Œç‰¹åˆ«æ˜¯å‰å¤©æ™šä¸Šç¡è§‰æ—¶çªç„¶æ„Ÿè§‰å–‰å’™å¾ˆç—’ï¼Œé¢‘ç¹å’³å—½ï¼ŒæŠŠè‡ªå·±å’³èµ·æ¥å»å–æ°´ã€‚</p>
<p>å·¥ä½œåè€æ˜¯æ„Ÿè§‰æ—¶é—´å°‘ï¼Œåšä»€ä¹ˆéƒ½ä¸å¤Ÿç”¨ä¼¼çš„ï¼Œè€Œä¸”èº«ä½“åœ¨å˜å½¢å’Œèµ°ä¸‹å¡è·¯ã€‚æ‰€ä»¥ï¼Œ<strong>æˆå¹´äººéœ€è¦åˆç†åœ°ç®¡ç†è‡ªå·±çš„æ—¶é—´</strong>ï¼šèº«ä½“ã€å·¥ä½œã€ç”Ÿæ´»ã€å®¶äººï¼ˆé™ªä¼´ï¼‰ã€ä¼‘é—²å¨±ä¹ã€‚å…¶å®ï¼Œäººç”Ÿå­˜åœ¨å¾ˆå¼ºçš„æ‚–è®ºï¼Œè¦ä¿æŒç†æ€§è¿½æ±‚èŒä¸šä¸Šå‡çš„åŒæ—¶ï¼Œåˆè¦æŠŠå…³è‡ªèº«çš„æ„Ÿæ€§çš„ä½“æ€é¢è²Œå¥åº·/å¿«ä¹æ¸´æœ›ï¼Œå¾ˆéš¾åšåˆ°ï¼ŒçœŸçš„å¾ˆéš¾åšåˆ°ã€‚</p>
<p>æˆ‘æ€»æ˜¯åœ¨æƒ³èµ·æˆ‘è‡ªå·±å¸¸æƒ³çš„ä¸€å¥è¯ï¼šæˆ‘ä»¬æ˜¯çœ‹ç€åˆ«äººåœ¨è¿‡è‡ªå·±çš„äººç”Ÿã€‚è¿™ä¹Ÿæ˜¯éå¸¸çŸ›ç›¾çš„ï¼Œåˆç†çš„æŠŠæ¡è‡³å…³é‡è¦ã€‚åœ¨å¹³è¡¡è¿™æ–¹é¢ï¼Œæˆ‘ä»¬å›½å®¶çš„å“²å­¦ç†è®ºå®åœ¨æ˜¯ä¸€è¨€è”½ä¹‹â€”â€”<strong>é˜´é˜³</strong>ï¼</p>



 ]]></description>
  <category>journal</category>
  <guid>https://shixiangwang.github.io/posts/2023-06-26-journal/index.html</guid>
  <pubDate>Sun, 25 Jun 2023 16:00:00 GMT</pubDate>
</item>
</channel>
</rss>
