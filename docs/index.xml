<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Reasoning</title>
<link>https://shixiangwang.github.io/index.html</link>
<atom:link href="https://shixiangwang.github.io/index.xml" rel="self" type="application/rss+xml"/>
<description>Reasoning is a blog dedicated to exploring the intersection of data science, bioinformatics, and personal insights.</description>
<generator>quarto-1.3.361</generator>
<lastBuildDate>Sun, 08 Oct 2023 16:00:00 GMT</lastBuildDate>
<item>
  <title>ç»“åˆ quarto å‡ºç‰ˆç³»ç»Ÿå’Œ webr æŠ€æœ¯</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-10-09-webr-in-quarto/index.html</link>
  <description><![CDATA[ <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs/loader.js"></script><script type="module" id="webr-monaco-editor-init">

  // Configure the Monaco Editor's loader
  require.config({
    paths: {
      'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs'
    }
  });
</script><p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œç›´æ¥é€šè¿‡æµè§ˆå™¨è¿è¡Œ <a href="https://docs.r-wasm.org/webr/latest/">webr æŠ€æœ¯</a>æ¥å®æ—¶è¿è¡Œ R ä»£ç ã€‚ä½ è¿˜å¯ä»¥å®æ—¶ä¿®æ”¹ä»£ç è¿›è¡Œäº¤äº’å¼æ¢ç´¢ï¼</p>
<button class="btn btn-default btn-webr" disabled="" type="button" id="webr-run-button-1">ğŸŸ¡ Loading
  webR...</button>
<div id="webr-editor-1"></div>
<div id="webr-code-output-1" aria-live="assertive">
  <pre style="visibility: hidden"></pre>
</div>
<script type="module">
  // Retrieve webR code cell information
  const runButton = document.getElementById("webr-run-button-1");
  const outputDiv = document.getElementById("webr-code-output-1");
  const editorDiv = document.getElementById("webr-editor-1");

  // Add a light grey outline around the code editor
  editorDiv.style.border = "1px solid #eee";

  // Load the Monaco Editor and create an instance
  let editor;
  require(['vs/editor/editor.main'], function () {
    editor = monaco.editor.create(editorDiv, {
      value: `fit = lm(mpg ~ am, data = mtcars)
summary(fit)`,
      language: 'r',
      theme: 'vs-light',
      automaticLayout: true,           // TODO: Could be problematic for slide decks
      scrollBeyondLastLine: false,
      minimap: {
        enabled: false
      },
      fontSize: '17.5rem',               // Bootstrap is 1 rem
      renderLineHighlight: "none",     // Disable current line highlighting
      hideCursorInOverviewRuler: true  // Remove cursor indictor in right hand side scroll bar
    });

    // Dynamically modify the height of the editor window if new lines are added.
    let ignoreEvent = false;
    const updateHeight = () => {
      const contentHeight = editor.getContentHeight();
      // We're avoiding a width change
      //editorDiv.style.width = `${width}px`;
      editorDiv.style.height = `${contentHeight}px`;
      try {
        ignoreEvent = true;

        // The key to resizing is this call
        editor.layout();
      } finally {
        ignoreEvent = false;
      }
    };

    // Helper function to check if selected text is empty
    function isEmptyCodeText(selectedCodeText) {
      return (selectedCodeText === null || selectedCodeText === undefined || selectedCodeText === "");
    }

    // Registry of keyboard shortcuts that should be re-added to each editor window
    // when focus changes.
    const addWebRKeyboardShortCutCommands = () => {
      // Add a keydown event listener for Shift+Enter to run all code in cell
      editor.addCommand(monaco.KeyMod.Shift | monaco.KeyCode.Enter, () => {

        // Retrieve all text inside the editor
        executeCode(editor.getValue());
      });

      // Add a keydown event listener for CMD/Ctrl+Enter to run selected code
      editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter, () => {

        // Get the selected text from the editor
        const selectedText = editor.getModel().getValueInRange(editor.getSelection());
        // Check if no code is selected
        if (isEmptyCodeText(selectedText)) {
          // Obtain the current cursor position
          let currentPosition = editor.getPosition();
          // Retrieve the current line content
          let currentLine = editor.getModel().getLineContent(currentPosition.lineNumber);

          // Propose a new position to move the cursor to
          let newPosition = new monaco.Position(currentPosition.lineNumber + 1, 1);

          // Check if the new position is beyond the last line of the editor
          if (newPosition.lineNumber > editor.getModel().getLineCount()) {
            // Add a new line at the end of the editor
            editor.executeEdits("addNewLine", [{
            range: new monaco.Range(newPosition.lineNumber, 1, newPosition.lineNumber, 1),
            text: "\n", 
            forceMoveMarkers: true,
            }]);
          }
          
          // Run the entire line of code.
          executeCode(currentLine);

          // Move cursor to new position
          editor.setPosition(newPosition);
        } else {
          // Code to run when Ctrl+Enter is pressed with selected code
          executeCode(selectedText);
        }
      });
    }

    // Register an on focus event handler for when a code cell is selected to update
    // what keyboard shortcut commands should work.
    // This is a workaround to fix a regression that happened with multiple
    // editor windows since Monaco 0.32.0 
    // https://github.com/microsoft/monaco-editor/issues/2947
    editor.onDidFocusEditorText(addWebRKeyboardShortCutCommands);

    // Register an on change event for when new code is added to the editor window
    editor.onDidContentSizeChange(updateHeight);

    // Manually re-update height to account for the content we inserted into the call
    updateHeight();
  });

  // Function to execute the code (accepts code as an argument)
  async function executeCode(codeToRun) {
    // Disable run button for code cell active
    runButton.disabled = true;

    // Disallowing execution of other code cells
    document.querySelectorAll(".btn-webr").forEach((btn) => {
      btn.disabled = true;
    });

    // Emphasize the active code cell
    runButton.innerHTML = '<i class="fa-solid fa-spinner fa-spin" style="color: #7894c4;"></i> <span>Run Code</span>';

    // Create a canvas variable for graphics
    let canvas = undefined;

    // Initialize webR
    await globalThis.webR.init();

    // Setup a webR canvas by making a namespace call into the {webr} package
    await webR.evalRVoid("webr::canvas(width=504, height=360)");

    // Capture output data from evaluating the code
    const result = await webRCodeShelter.captureR(codeToRun, {
      withAutoprint: true,
      captureStreams: true,
      captureConditions: false//,
      // env: webR.objs.emptyEnv, // maintain a global environment for webR v0.2.0
    });

    // Start attempting to parse the result data
    try {

      // Stop creating images
      await webR.evalRVoid("dev.off()");

      // Merge output streams of STDOUT and STDErr (messages and errors are combined.)
      const out = result.output.filter(
        evt => evt.type == "stdout" || evt.type == "stderr"
      ).map((evt) => evt.data).join("\n");

      // Clean the state
      const msgs = await webR.flush();

      // Output each image stored
      msgs.forEach(msg => {
        // Determine if old canvas can be used or a new canvas is required.
        if (msg.type === 'canvas'){
          // Add image to the current canvas
          if (msg.data.event === 'canvasImage') {
            canvas.getContext('2d').drawImage(msg.data.image, 0, 0);
          } else if (msg.data.event === 'canvasNewPage') {
            // Generate a new canvas element
            canvas = document.createElement("canvas");
            canvas.setAttribute("width", 2 * 504);
            canvas.setAttribute("height", 2 * 360);
            canvas.style.width = "700px";
            canvas.style.display = "block";
            canvas.style.margin = "auto";
          }
        }
      });

      // Nullify the outputDiv of content
      outputDiv.innerHTML = "";

      // Design an output object for messages
      const pre = document.createElement("pre");
      if (/\S/.test(out)) {
        // Display results as text
        const code = document.createElement("code");
        code.innerText = out;
        pre.appendChild(code);
      } else {
        // If nothing is present, hide the element.
        pre.style.visibility = "hidden";
      }
      outputDiv.appendChild(pre);

      // Place the graphics on the canvas
      if (canvas) {
        const p = document.createElement("p");
        p.appendChild(canvas);
        outputDiv.appendChild(p);
      }
    } finally {
      // Clean up the remaining code
      webRCodeShelter.purge();
    }

    // Switch to allowing execution of code
    document.querySelectorAll(".btn-webr").forEach((btn) => {
      btn.disabled = false;
    });

    // Revert to the initial code cell state
    runButton.innerHTML = '<i class="fa-solid fa-play" style="color: #0d9c29;"></i> <span>Run Code</span>';
  }

  // Add a click event listener to the run button
  runButton.onclick = function () {
    executeCode(editor.getValue());
  };
</script><button class="btn btn-default btn-webr" disabled="" type="button" id="webr-run-button-2">ğŸŸ¡ Loading
  webR...</button>
<div id="webr-editor-2"></div>
<div id="webr-code-output-2" aria-live="assertive">
  <pre style="visibility: hidden"></pre>
</div>
<script type="module">
  // Retrieve webR code cell information
  const runButton = document.getElementById("webr-run-button-2");
  const outputDiv = document.getElementById("webr-code-output-2");
  const editorDiv = document.getElementById("webr-editor-2");

  // Add a light grey outline around the code editor
  editorDiv.style.border = "1px solid #eee";

  // Load the Monaco Editor and create an instance
  let editor;
  require(['vs/editor/editor.main'], function () {
    editor = monaco.editor.create(editorDiv, {
      value: `par(bg = "#f7f7f7")

plot(x = mtcars$mpg, y = mtcars$am)`,
      language: 'r',
      theme: 'vs-light',
      automaticLayout: true,           // TODO: Could be problematic for slide decks
      scrollBeyondLastLine: false,
      minimap: {
        enabled: false
      },
      fontSize: '17.5rem',               // Bootstrap is 1 rem
      renderLineHighlight: "none",     // Disable current line highlighting
      hideCursorInOverviewRuler: true  // Remove cursor indictor in right hand side scroll bar
    });

    // Dynamically modify the height of the editor window if new lines are added.
    let ignoreEvent = false;
    const updateHeight = () => {
      const contentHeight = editor.getContentHeight();
      // We're avoiding a width change
      //editorDiv.style.width = `${width}px`;
      editorDiv.style.height = `${contentHeight}px`;
      try {
        ignoreEvent = true;

        // The key to resizing is this call
        editor.layout();
      } finally {
        ignoreEvent = false;
      }
    };

    // Helper function to check if selected text is empty
    function isEmptyCodeText(selectedCodeText) {
      return (selectedCodeText === null || selectedCodeText === undefined || selectedCodeText === "");
    }

    // Registry of keyboard shortcuts that should be re-added to each editor window
    // when focus changes.
    const addWebRKeyboardShortCutCommands = () => {
      // Add a keydown event listener for Shift+Enter to run all code in cell
      editor.addCommand(monaco.KeyMod.Shift | monaco.KeyCode.Enter, () => {

        // Retrieve all text inside the editor
        executeCode(editor.getValue());
      });

      // Add a keydown event listener for CMD/Ctrl+Enter to run selected code
      editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter, () => {

        // Get the selected text from the editor
        const selectedText = editor.getModel().getValueInRange(editor.getSelection());
        // Check if no code is selected
        if (isEmptyCodeText(selectedText)) {
          // Obtain the current cursor position
          let currentPosition = editor.getPosition();
          // Retrieve the current line content
          let currentLine = editor.getModel().getLineContent(currentPosition.lineNumber);

          // Propose a new position to move the cursor to
          let newPosition = new monaco.Position(currentPosition.lineNumber + 1, 1);

          // Check if the new position is beyond the last line of the editor
          if (newPosition.lineNumber > editor.getModel().getLineCount()) {
            // Add a new line at the end of the editor
            editor.executeEdits("addNewLine", [{
            range: new monaco.Range(newPosition.lineNumber, 1, newPosition.lineNumber, 1),
            text: "\n", 
            forceMoveMarkers: true,
            }]);
          }
          
          // Run the entire line of code.
          executeCode(currentLine);

          // Move cursor to new position
          editor.setPosition(newPosition);
        } else {
          // Code to run when Ctrl+Enter is pressed with selected code
          executeCode(selectedText);
        }
      });
    }

    // Register an on focus event handler for when a code cell is selected to update
    // what keyboard shortcut commands should work.
    // This is a workaround to fix a regression that happened with multiple
    // editor windows since Monaco 0.32.0 
    // https://github.com/microsoft/monaco-editor/issues/2947
    editor.onDidFocusEditorText(addWebRKeyboardShortCutCommands);

    // Register an on change event for when new code is added to the editor window
    editor.onDidContentSizeChange(updateHeight);

    // Manually re-update height to account for the content we inserted into the call
    updateHeight();
  });

  // Function to execute the code (accepts code as an argument)
  async function executeCode(codeToRun) {
    // Disable run button for code cell active
    runButton.disabled = true;

    // Disallowing execution of other code cells
    document.querySelectorAll(".btn-webr").forEach((btn) => {
      btn.disabled = true;
    });

    // Emphasize the active code cell
    runButton.innerHTML = '<i class="fa-solid fa-spinner fa-spin" style="color: #7894c4;"></i> <span>Run Code</span>';

    // Create a canvas variable for graphics
    let canvas = undefined;

    // Initialize webR
    await globalThis.webR.init();

    // Setup a webR canvas by making a namespace call into the {webr} package
    await webR.evalRVoid("webr::canvas(width=504, height=360)");

    // Capture output data from evaluating the code
    const result = await webRCodeShelter.captureR(codeToRun, {
      withAutoprint: true,
      captureStreams: true,
      captureConditions: false//,
      // env: webR.objs.emptyEnv, // maintain a global environment for webR v0.2.0
    });

    // Start attempting to parse the result data
    try {

      // Stop creating images
      await webR.evalRVoid("dev.off()");

      // Merge output streams of STDOUT and STDErr (messages and errors are combined.)
      const out = result.output.filter(
        evt => evt.type == "stdout" || evt.type == "stderr"
      ).map((evt) => evt.data).join("\n");

      // Clean the state
      const msgs = await webR.flush();

      // Output each image stored
      msgs.forEach(msg => {
        // Determine if old canvas can be used or a new canvas is required.
        if (msg.type === 'canvas'){
          // Add image to the current canvas
          if (msg.data.event === 'canvasImage') {
            canvas.getContext('2d').drawImage(msg.data.image, 0, 0);
          } else if (msg.data.event === 'canvasNewPage') {
            // Generate a new canvas element
            canvas = document.createElement("canvas");
            canvas.setAttribute("width", 2 * 504);
            canvas.setAttribute("height", 2 * 360);
            canvas.style.width = "700px";
            canvas.style.display = "block";
            canvas.style.margin = "auto";
          }
        }
      });

      // Nullify the outputDiv of content
      outputDiv.innerHTML = "";

      // Design an output object for messages
      const pre = document.createElement("pre");
      if (/\S/.test(out)) {
        // Display results as text
        const code = document.createElement("code");
        code.innerText = out;
        pre.appendChild(code);
      } else {
        // If nothing is present, hide the element.
        pre.style.visibility = "hidden";
      }
      outputDiv.appendChild(pre);

      // Place the graphics on the canvas
      if (canvas) {
        const p = document.createElement("p");
        p.appendChild(canvas);
        outputDiv.appendChild(p);
      }
    } finally {
      // Clean up the remaining code
      webRCodeShelter.purge();
    }

    // Switch to allowing execution of code
    document.querySelectorAll(".btn-webr").forEach((btn) => {
      btn.disabled = false;
    });

    // Revert to the initial code cell state
    runButton.innerHTML = '<i class="fa-solid fa-play" style="color: #0d9c29;"></i> <span>Run Code</span>';
  }

  // Add a click event listener to the run button
  runButton.onclick = function () {
    executeCode(editor.getValue());
  };
</script><button class="btn btn-default btn-webr" disabled="" type="button" id="webr-run-button-3">ğŸŸ¡ Loading
  webR...</button>
<div id="webr-editor-3"></div>
<div id="webr-code-output-3" aria-live="assertive">
  <pre style="visibility: hidden"></pre>
</div>
<script type="module">
  // Retrieve webR code cell information
  const runButton = document.getElementById("webr-run-button-3");
  const outputDiv = document.getElementById("webr-code-output-3");
  const editorDiv = document.getElementById("webr-editor-3");

  // Add a light grey outline around the code editor
  editorDiv.style.border = "1px solid #eee";

  // Load the Monaco Editor and create an instance
  let editor;
  require(['vs/editor/editor.main'], function () {
    editor = monaco.editor.create(editorDiv, {
      value: `par(bg = "#f7f7f7")

set.seed(2)
x <- rnorm(100)
boxplot(x)`,
      language: 'r',
      theme: 'vs-light',
      automaticLayout: true,           // TODO: Could be problematic for slide decks
      scrollBeyondLastLine: false,
      minimap: {
        enabled: false
      },
      fontSize: '17.5rem',               // Bootstrap is 1 rem
      renderLineHighlight: "none",     // Disable current line highlighting
      hideCursorInOverviewRuler: true  // Remove cursor indictor in right hand side scroll bar
    });

    // Dynamically modify the height of the editor window if new lines are added.
    let ignoreEvent = false;
    const updateHeight = () => {
      const contentHeight = editor.getContentHeight();
      // We're avoiding a width change
      //editorDiv.style.width = `${width}px`;
      editorDiv.style.height = `${contentHeight}px`;
      try {
        ignoreEvent = true;

        // The key to resizing is this call
        editor.layout();
      } finally {
        ignoreEvent = false;
      }
    };

    // Helper function to check if selected text is empty
    function isEmptyCodeText(selectedCodeText) {
      return (selectedCodeText === null || selectedCodeText === undefined || selectedCodeText === "");
    }

    // Registry of keyboard shortcuts that should be re-added to each editor window
    // when focus changes.
    const addWebRKeyboardShortCutCommands = () => {
      // Add a keydown event listener for Shift+Enter to run all code in cell
      editor.addCommand(monaco.KeyMod.Shift | monaco.KeyCode.Enter, () => {

        // Retrieve all text inside the editor
        executeCode(editor.getValue());
      });

      // Add a keydown event listener for CMD/Ctrl+Enter to run selected code
      editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter, () => {

        // Get the selected text from the editor
        const selectedText = editor.getModel().getValueInRange(editor.getSelection());
        // Check if no code is selected
        if (isEmptyCodeText(selectedText)) {
          // Obtain the current cursor position
          let currentPosition = editor.getPosition();
          // Retrieve the current line content
          let currentLine = editor.getModel().getLineContent(currentPosition.lineNumber);

          // Propose a new position to move the cursor to
          let newPosition = new monaco.Position(currentPosition.lineNumber + 1, 1);

          // Check if the new position is beyond the last line of the editor
          if (newPosition.lineNumber > editor.getModel().getLineCount()) {
            // Add a new line at the end of the editor
            editor.executeEdits("addNewLine", [{
            range: new monaco.Range(newPosition.lineNumber, 1, newPosition.lineNumber, 1),
            text: "\n", 
            forceMoveMarkers: true,
            }]);
          }
          
          // Run the entire line of code.
          executeCode(currentLine);

          // Move cursor to new position
          editor.setPosition(newPosition);
        } else {
          // Code to run when Ctrl+Enter is pressed with selected code
          executeCode(selectedText);
        }
      });
    }

    // Register an on focus event handler for when a code cell is selected to update
    // what keyboard shortcut commands should work.
    // This is a workaround to fix a regression that happened with multiple
    // editor windows since Monaco 0.32.0 
    // https://github.com/microsoft/monaco-editor/issues/2947
    editor.onDidFocusEditorText(addWebRKeyboardShortCutCommands);

    // Register an on change event for when new code is added to the editor window
    editor.onDidContentSizeChange(updateHeight);

    // Manually re-update height to account for the content we inserted into the call
    updateHeight();
  });

  // Function to execute the code (accepts code as an argument)
  async function executeCode(codeToRun) {
    // Disable run button for code cell active
    runButton.disabled = true;

    // Disallowing execution of other code cells
    document.querySelectorAll(".btn-webr").forEach((btn) => {
      btn.disabled = true;
    });

    // Emphasize the active code cell
    runButton.innerHTML = '<i class="fa-solid fa-spinner fa-spin" style="color: #7894c4;"></i> <span>Run Code</span>';

    // Create a canvas variable for graphics
    let canvas = undefined;

    // Initialize webR
    await globalThis.webR.init();

    // Setup a webR canvas by making a namespace call into the {webr} package
    await webR.evalRVoid("webr::canvas(width=504, height=360)");

    // Capture output data from evaluating the code
    const result = await webRCodeShelter.captureR(codeToRun, {
      withAutoprint: true,
      captureStreams: true,
      captureConditions: false//,
      // env: webR.objs.emptyEnv, // maintain a global environment for webR v0.2.0
    });

    // Start attempting to parse the result data
    try {

      // Stop creating images
      await webR.evalRVoid("dev.off()");

      // Merge output streams of STDOUT and STDErr (messages and errors are combined.)
      const out = result.output.filter(
        evt => evt.type == "stdout" || evt.type == "stderr"
      ).map((evt) => evt.data).join("\n");

      // Clean the state
      const msgs = await webR.flush();

      // Output each image stored
      msgs.forEach(msg => {
        // Determine if old canvas can be used or a new canvas is required.
        if (msg.type === 'canvas'){
          // Add image to the current canvas
          if (msg.data.event === 'canvasImage') {
            canvas.getContext('2d').drawImage(msg.data.image, 0, 0);
          } else if (msg.data.event === 'canvasNewPage') {
            // Generate a new canvas element
            canvas = document.createElement("canvas");
            canvas.setAttribute("width", 2 * 504);
            canvas.setAttribute("height", 2 * 360);
            canvas.style.width = "700px";
            canvas.style.display = "block";
            canvas.style.margin = "auto";
          }
        }
      });

      // Nullify the outputDiv of content
      outputDiv.innerHTML = "";

      // Design an output object for messages
      const pre = document.createElement("pre");
      if (/\S/.test(out)) {
        // Display results as text
        const code = document.createElement("code");
        code.innerText = out;
        pre.appendChild(code);
      } else {
        // If nothing is present, hide the element.
        pre.style.visibility = "hidden";
      }
      outputDiv.appendChild(pre);

      // Place the graphics on the canvas
      if (canvas) {
        const p = document.createElement("p");
        p.appendChild(canvas);
        outputDiv.appendChild(p);
      }
    } finally {
      // Clean up the remaining code
      webRCodeShelter.purge();
    }

    // Switch to allowing execution of code
    document.querySelectorAll(".btn-webr").forEach((btn) => {
      btn.disabled = false;
    });

    // Revert to the initial code cell state
    runButton.innerHTML = '<i class="fa-solid fa-play" style="color: #0d9c29;"></i> <span>Run Code</span>';
  }

  // Add a click event listener to the run button
  runButton.onclick = function () {
    executeCode(editor.getValue());
  };
</script><p>æŠ€æœ¯è¯¦æƒ…å¯ä»¥å‚é˜… <a href="https://quarto-webr.thecoatlessprofessor.com/">quarto-webr æ‹“å±•æ–‡æ¡£</a>ã€‚ ç›®å‰è¯¥æ’ä»¶ï¼ˆåŒ…æ‹¬ webRï¼‰è¿˜åœ¨ç§¯æçš„å¼€å‘ä¸­ï¼ŒæœŸå¾…æœªæ¥æ›´åŠ æˆç†Ÿç¨³å®šï¼Œè·Ÿæœ¬åœ°æ‰§è¡Œä»£ç ä¸€æ ·æ–¹ä¾¿å’Œå®¹æ˜“ï¼Œ æˆ‘ç›¸ä¿¡è¿™ä¼šæå¤§åœ°æ”¹å˜å¼€å‘è€…å’Œä½¿ç”¨è€…çš„äº¤äº’æ–¹å¼ã€‚</p>



 ]]></description>
  <category>R</category>
  <guid>https://shixiangwang.github.io/posts/2023-10-09-webr-in-quarto/index.html</guid>
  <pubDate>Sun, 08 Oct 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023 å¹´è¯ºè´å°”ç”Ÿç†æˆ–åŒ»å­¦å¥–æˆäºˆ KK</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-10-09-kk-nobel/index.html</link>
  <description><![CDATA[ 




<p>åŒˆç‰™åˆ©ç§‘å­¦å®¶Katalin KarikÃ³å’Œç¾å›½ç§‘å­¦å®¶Drew Weissmanè·å¾—äº†2023å¹´è¯ºè´å°”ç”Ÿç†å­¦å¥–æˆ–åŒ»å­¦å¥–ï¼Œå› ä¸ºä»–ä»¬åœ¨æ ¸è‹·é…¸ç¢±åŸºä¿®é¥°æ–¹é¢çš„å‘ç°ï¼Œä½¿å¾—å¼€å‘å‡ºé’ˆå¯¹COVID-19çš„æœ‰æ•ˆmRNAç–«è‹—æˆä¸ºå¯èƒ½ã€‚</p>
<p>è™½ç„¶å¤„äºç”Ÿç‰©åŒ»å­¦é¢†åŸŸï¼Œä½†å¯¹äº mRNA ç–«è‹—ä¹Ÿåªæ˜¯è€³é—»ï¼Œè€Œæ²¡æœ‰ç»†è‡´å»äº†è§£è¿‡ã€‚çœŸæ­£è®©æˆ‘ç€åŠ›å†™ä¸‹è¿™ç¯‡è®°å½•çš„ï¼Œæ˜¯Katalin KarikÃ³å‡ åå¹´è·Œå®•èµ·ä¼çš„ç§‘ç ”ç”Ÿæ¶¯ï¼Œè¿™ç»™äºˆæˆ‘è«å¤§çš„éœ‡æ’¼å’Œæ„ŸåŠ¨ã€‚ åœ¨æµé‡çš„æ¨èä¸‹æˆ‘ä¹Ÿåˆ·åˆ°äº†ä¸¤ä½è·å¥–è€…çš„é‡‡è®¿è§†é¢‘ï¼Œç›¸æ¯”äºDrew Weissmançš„æ²‰ç¨³å†·é™ï¼ŒKKæº¢äºè¨€è¡¨çš„çƒ­æƒ…å’Œç¬‘å®¹è®©æˆ‘å†æ¬¡æ·±åˆ»æ„Ÿå—åˆ°ç§‘å­¦ç ”ç©¶çš„é­…åŠ›ã€‚</p>
<p>æˆ‘ä¼¼ä¹èƒ½å¤Ÿé€šè¿‡é™„ç€åœ¨KKèº«ä¸Šçš„å²æœˆç—•è¿¹å»çª¥æ¢æœªæ¥æˆ‘å¯èƒ½çš„å‘½è¿ï¼Œå½“ç„¶ï¼Œæˆ‘å¹¶ä¸æ˜¯è¯´æˆ‘èƒ½å¤Ÿäº§ç”Ÿå·¨å¤§çš„ç§‘å­¦è´¡çŒ®å¹¶å¹¸è¿åœ°è£è·è¿™ç±»ç§‘å­¦å¤§å¥–ã€‚ æˆ‘åœ¨æ€è€ƒçš„æ˜¯ï¼Œæˆ‘è¯¥ç”¨å¦‚ä½•çš„æ€åº¦å»é¢å¯¹æœªæ¥ä¸ç¡®å®šçš„èŒä¸šé“è·¯ï¼Œå¦‚ä½•å»æ¢å¯»å’ŒåšæŒæœªæ¥æƒ³åšçš„å·¥ä½œã€å»æ„Ÿå—ç”Ÿæ´»çš„èµ·è½ã€å»é™ªä¼´çˆ±äººå®¶äººã€å»æ•™è‚²å­å¥³ã€‚ äººæ˜¯ä¸€ç§å¤æ‚çš„å¤šç»†èƒç”Ÿç‰©ï¼Œåœ¨å²æœˆçš„æˆé•¿ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº†å¤ªå¤šç‰©è´¨ä¸ç²¾ç¥çš„å˜é‡ï¼Œä½†æ‰€è°“â€œä¸å¿˜åˆå¿ƒâ€çš„ï¼Œä¸æ˜¯å›åˆ°å¤šå°‘å¹´å‰æŸä¸ªå¹¼ç¨šçš„æ€è€ƒã€å……æ»¡å¤©çœŸæ¢¦æƒ³çš„æ—¶åˆ»ï¼Œ è€Œæ˜¯åšæŒä¸€ç§è´¯ç©¿èº«å¿ƒä¸æ—¶ç©ºçš„ä¿¡å¿µå’ŒåŠ›é‡ï¼Œè®©è‡ªæˆ‘çš„â€œç¥è¿¹â€ç»½æ”¾åœ¨å¿ƒçµçš„æ²ƒé‡ï¼Œå®Œæˆä¸€åœºè¶…è„±è‡ªæˆ‘çš„â€œæˆä½›â€ä¹‹æ—…ã€‚</p>
<p>æœ€åç”¨ KK è®²è¿°çš„ä¸€æ®µè¯ä½œä¸ºä½ æˆ‘çš„å…±å‹‰ï¼š</p>
<blockquote class="blockquote">
<p>æ¶‰è¶³ç§‘å­¦é¢†åŸŸï¼Œä½ ä¼šç»å¸¸åœ¨æ¯«æ— æŠŠæ¡çš„æƒ…å†µä¸‹å·¥ä½œã€‚æˆ‘ç»å¸¸æŠŠåšç§‘å­¦æ¯”ä½œæˆ‘å¥³å„¿çš„åˆ’èˆ¹ï¼šä½ åœ¨ä¸€è‰˜å‘åè¡Œé©¶çš„èˆ¹ä¸Šï¼Œçœ‹ä¸æ¸…é±¼é³çº¿æœ‰å¤šè¿œï¼ˆå¡é‡Œç§‘çš„å¥³å„¿è‹çŠÂ·å¼—æœ—è¥¿äºšæ˜¯ä¸¤å±Šå¥¥è¿ä¼šèµ›è‰‡å† å†›å’Œé‡‘ç‰Œå¾—ä¸»ï¼‰ã€‚æ‰€ä»¥æˆ‘è®¤ä¸ºï¼Œæ¿€æƒ…ã€ä¸“æ³¨å’Œä½¿å‘½æ„Ÿæ˜¯åœ¨ç ”ç©¶ç”Ÿæ¶¯ä¸­å–å¾—æˆå°±çš„å…³é”®å› ç´ ã€‚</p>
</blockquote>



 ]]></description>
  <category>academic</category>
  <category>news</category>
  <category>personal</category>
  <guid>https://shixiangwang.github.io/posts/2023-10-09-kk-nobel/index.html</guid>
  <pubDate>Sun, 08 Oct 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>ShowMeAI é€ŸæŸ¥è¡¨</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-10-07-show-me-ai-cheatsheet/index.html</link>
  <description><![CDATA[ 




<p>#åˆ†äº«# #AI# ä»Šå¤©çœ‹åˆ° showmeAIï¼ˆ<a href="https://github.com/ShowMeAI-Hub" class="uri">https://github.com/ShowMeAI-Hub</a>ï¼‰ï¼Œæœ‰ä¸€äº›é€ŸæŸ¥è¡¨éå¸¸ä¸é”™ï¼Œè¿™é‡Œæ•´ç†åˆ†äº«ç»™å¤§å®¶ã€‚ <a href="https://www.aliyundrive.com/s/mogzKzDSinf" class="uri">https://www.aliyundrive.com/s/mogzKzDSinf</a> ç‚¹å‡»é“¾æ¥ä¿å­˜ï¼Œæˆ–è€…å¤åˆ¶æœ¬æ®µå†…å®¹ï¼Œæ‰“å¼€ã€Œé˜¿é‡Œäº‘ç›˜ã€APP ï¼Œæ— éœ€ä¸‹è½½æé€Ÿåœ¨çº¿æŸ¥çœ‹ï¼Œè§†é¢‘åŸç”»å€é€Ÿæ’­æ”¾ã€‚</p>



 ]]></description>
  <category>machine-learning</category>
  <category>Python</category>
  <category>resource</category>
  <guid>https://shixiangwang.github.io/posts/2023-10-07-show-me-ai-cheatsheet/index.html</guid>
  <pubDate>Fri, 06 Oct 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>Shiny å¼€å‘å­¦ä¹ è·¯å¾„</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-09-13-shiny-learning-path-for-bioinformatics/index.html</link>
  <description><![CDATA[ 




<p>ç”Ÿä¿¡é¢†åŸŸè¶Šæ¥è¶Šå¤šçš„æ•°æ®åº“/ç½‘é¡µå·¥å…·é‡‡ç”¨ <a href="https://shiny.posit.co/">Shiny</a> æ¡†æ¶è¿›è¡Œæ­å»ºï¼ŒShiny çš„æµè¡Œåº¦/æ‹“å±•æ€§åœ¨éšç€æ—¶é—´å¢åŠ ã€‚å› æ­¤ï¼ŒæŒæ¡ Shiny æœåŠ¡äºè‡ªå·±çš„é¡¹ç›®/è¯¾é¢˜æˆä¸ºç”Ÿä¿¡äººçš„ä¸€ä¸ªæ–°çš„æŠ€èƒ½ã€‚ åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œä½œä¸ºä¸€ä¸ªæœ‰ç»éªŒçš„ Shiny å­¦ä¹ è€…å’Œ Shiny å·¥å…·çš„å¼€å‘è€…ï¼Œæˆ‘å°†ä»‹ç»å­¦ä¹ å’ŒæŒæ¡ Shiny è¿›è¡Œå¼€å‘çš„æ ¸å¿ƒè·¯å¾„å’Œç›¸å…³æ¨èçš„ï¼ˆå…è´¹ï¼‰èµ„æ–™ã€‚å¯¹äºæ¯ä¸€ä¸ªå…³å¡ï¼ˆæŠ€èƒ½ç‚¹ï¼‰ï¼Œ æˆ‘ä¼šç»™å‡ºå¤§è‡´çš„ï¼ˆ<strong>å…¨èŒå­¦ä¹ </strong>ï¼‰æ—¶é—´ä¼°è®¡ï¼ˆä»¥å‘¨ä¸ºå•ä½ï¼‰ã€‚</p>
<blockquote class="blockquote">
<p>ç½‘ç»œä¸Šçš„èµ„æ–™å¯¹äºä¸ªäººæ¥è¯´æ˜¯æ— ç©·å°½çš„ï¼Œæˆ‘ä¼šå°½é‡é€‰æ‹©æˆ‘è®¤å¯çš„æœ€æ ¸å¿ƒè¯»ç‰©ï¼Œæ–¹ä¾¿å¤§å®¶è¿›è¡Œç›¸å…³çš„å­¦ä¹ ã€‚å½“ç„¶ï¼Œ ä¸ªäººçš„èƒ½åŠ›æœ‰é™ï¼Œæ¬¢è¿è®¨è®ºå’Œè¡¥å……ã€‚</p>
<p>æ³¨æ„ï¼ŒShiny ç°åœ¨å·²ç»æ”¯æŒäº† Python çš„å®ç°ï¼Œä½†æœ¬æ–‡åªä»‹ç»ä»¥ R ä¸ºåŸºç¡€çš„å­¦ä¹ è·¯å¾„ã€‚</p>
</blockquote>
<section id="å…³å¡1r-åŸºç¡€2-3-å‘¨" class="level2">
<h2 class="anchored" data-anchor-id="å…³å¡1r-åŸºç¡€2-3-å‘¨">å…³å¡1ï¼šR åŸºç¡€ï¼ˆ2-3 å‘¨ï¼‰</h2>
<p>å­¦ä¹  <a href="https://r4ds.had.co.nz/"><em>R for Data Science</em></a>ã€‚</p>
<p><img src="https://shixiangwang.github.io/posts/2023-09-13-shiny-learning-path-for-bioinformatics/https:/d33wubrfki0l68.cloudfront.net/b88ef926a004b0fce72b2526b0b5c4413666a4cb/24a30/cover.png" class="img-fluid"></p>
<p>è¦æ±‚æŒæ¡ 1-21 ç« çš„å…¨éƒ¨å†…å®¹ï¼Œåç»­ç« èŠ‚åˆå­¦è€…ä»¥äº†è§£ä¸ºä¸»ï¼Œæ ¹æ®å…´è¶£å’Œæ—¶é—´è¿›è¡Œå®è·µã€‚</p>
<p>æ ¸å¿ƒè¦ç‚¹ï¼š</p>
<ul>
<li>tidyverse çš„æ•°æ®å¤„ç†ç†å¿µ</li>
<li>readr è¯»å–æ“ä½œ</li>
<li>dplyr æ•°æ®å¤„ç†ç†å¿µå’Œæ ¸å¿ƒæ“ä½œ</li>
<li>ggplot2 å¯è§†åŒ–ç†å¿µå’Œæ ¸å¿ƒæ“ä½œ</li>
</ul>
<p>è¯»è€…ç›®æ ‡è‡ªæŸ¥ï¼šå¯ä»¥ç‹¬è‡ªå®Œæˆä»ç£ç›˜è¯»å–æ–‡ä»¶ã€è¿‡æ»¤/è½¬æ¢æ•°æ®ã€åˆ†ç»„å¤„ç†/èšåˆæ•°æ®ã€ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨ã€‚</p>
</section>
<section id="å…³å¡2-ç½‘é¡µåŸºç¡€-html5css-0.5-1-å‘¨" class="level2">
<h2 class="anchored" data-anchor-id="å…³å¡2-ç½‘é¡µåŸºç¡€-html5css-0.5-1-å‘¨">å…³å¡2: ç½‘é¡µåŸºç¡€ HTML5/CSS ï¼ˆ0.5-1 å‘¨ï¼‰</h2>
<p>é˜…è¯»ä¸€é <a href="https://www.runoob.com/html/html-tutorial.html">HTML æ•™ç¨‹</a> å’Œ <a href="https://www.runoob.com/css/css-tutorial.html">CSS æ•™ç¨‹</a>ã€‚</p>
<p>HTML æ•™ç¨‹æ˜¯é‡ç‚¹ï¼Œå»ºè®®èŠ±å¤šä¸€äº›æ—¶é—´é˜…è¯»ï¼›CSS èµ·åˆ°è¾…åŠ©å’Œç¾åŒ–çš„ä½œç”¨ï¼Œå¯¹äºåˆå­¦è€…ï¼Œäº†è§£å…¶åŸºæœ¬è¯­æ³•ã€å¦‚ä½•è®¾å®šå³å¯ã€‚</p>
<p>æ ¸å¿ƒè¦ç‚¹ï¼š</p>
<ul>
<li>ç½‘é¡µç»“æ„</li>
<li>ç½‘é¡µæ ‡ç­¾è¯­æ³•ä»¥åŠæ¡ç›®</li>
<li>CSS çš„è®¾å®š</li>
</ul>
<p>è¯»è€…ç›®æ ‡è‡ªæŸ¥ï¼šå¯ä»¥å¾’æ‰‹å†™ä¸€ä¸ªç®€å•çš„ç½‘é¡µï¼Œå¹¶é€šè¿‡ CSS å¼•å…¥ä¸€äº›æ ¼å¼åŒ–ã€‚</p>
</section>
<section id="å…³å¡3shiny-å­¦ä¹ 2-3-å‘¨" class="level2">
<h2 class="anchored" data-anchor-id="å…³å¡3shiny-å­¦ä¹ 2-3-å‘¨">å…³å¡3ï¼šShiny å­¦ä¹ ï¼ˆ2-3 å‘¨ï¼‰</h2>
<p>å­¦ä¹  <a href="https://mastering-shiny.org/"><em>Mastering Shiny</em></a>ã€‚</p>
<p><img src="https://shixiangwang.github.io/posts/2023-09-13-shiny-learning-path-for-bioinformatics/https:/d33wubrfki0l68.cloudfront.net/0c97eee3d8fc820f3a8d670c08b286e8a524257b/e426c/cover.png" class="img-fluid"></p>
<p>è¦æ±‚è®¤çœŸé˜…è¯»å…¨éƒ¨å†…å®¹ï¼Œå¹¶æ ¹æ®è¯»ç‰©çš„ä»£ç è¿›è¡Œå®è·µï¼Œè¾¹å­¦è¾¹ç»ƒã€‚</p>
<p>æ ¸å¿ƒè¦ç‚¹ï¼š</p>
<ul>
<li>Shiny app ç»“æ„</li>
<li>Shiny ç½‘é¡µå¸ƒå±€</li>
<li>Shiny reactivity</li>
<li>Shiny module</li>
</ul>
<p>è¯»è€…ç›®æ ‡è‡ªæŸ¥ï¼šå¯ä»¥åœ¨å…³å¡1çš„åŸºç¡€ä¸Šï¼Œå°†å¯è§†åŒ–å±•ç¤ºé€šè¿‡ Shiny app å®ç°ï¼Œå¹¶æä¾›å¤šä¸ªé€‰é¡¹ç”¨äºæ§åˆ¶å›¾å½¢çš„è¾“å‡ºå±•ç¤ºã€‚</p>
</section>
<section id="å…³å¡4-å­¦ä¹ å¦‚ä½•ç»„ç»‡-shiny-app-ä»£ç 1-å‘¨ä»¥ä¸Š" class="level2">
<h2 class="anchored" data-anchor-id="å…³å¡4-å­¦ä¹ å¦‚ä½•ç»„ç»‡-shiny-app-ä»£ç 1-å‘¨ä»¥ä¸Š">å…³å¡4: å­¦ä¹ å¦‚ä½•ç»„ç»‡ Shiny app ä»£ç ï¼ˆ1 å‘¨ä»¥ä¸Šï¼‰</h2>
<p>å¥½çš„ä»£ç ç»“æ„ï¼Œä¼šæå¤§åœ°æ–¹ä¾¿è¿ç»´å’Œæ‹“å±•ä½ å†™çš„ Shiny appã€‚ ä¸‹é¢æœ‰å‡ ç§æ¨èçš„ä»£ç ç»„ç»‡å½¢å¼ï¼Œè¯»è€…å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å‚è€ƒè®¾å®šï¼Œä¹Ÿå¯ä»¥æ ¹æ®ç½—åˆ—çš„èµ„æ–™é€æ­¥å­¦ä¹ ã€‚</p>
<ul>
<li>Shiny é»˜è®¤çš„ä»£ç éƒ¨ç½²æ–¹å¼
<ul>
<li>ä½¿ç”¨ä¸€ä¸ª <code>app.R</code> æ–‡ä»¶å­˜å‚¨å…¨éƒ¨çš„å‰åç«¯ä»£ç ï¼Œé€‚åˆéå¸¸å°çš„åº”ç”¨ã€‚</li>
<li>ä½¿ç”¨å•ç‹¬çš„ <code>ui.R</code> å’Œ <code>server.R</code> æ–‡ä»¶æ”¾å‰åç«¯ä»£ç ï¼Œé€‚åˆç¨å¾®å¤æ‚ä¸€ç‚¹çš„å°åº”ç”¨ã€‚</li>
<li>åœ¨ä»¥ä¸Šä¸¤ç§è®¾å®šçš„åŸºç¡€ä¸Šï¼Œå°†å¤æ‚çš„æ“ä½œé€»è¾‘ç»Ÿç»Ÿæ•´ç†ä¸ºå‡½æ•°ï¼Œæ”¾åˆ°å•ç‹¬çš„ <code>R/</code> ç›®å½•ä¸‹æˆ–è€…ä¸€ä¸ª <code>functions.R</code> æ–‡ä»¶ä¸­æ–¹ä¾¿è°ƒç”¨å’Œç»´æŠ¤ã€‚å¦‚æœæ›´å¤æ‚ä¸€ç‚¹ï¼Œå¯ä»¥æ•´ç†ä¸ºä¸€ä¸ª R åŒ…ï¼Œéœ€è¦é€šè¿‡ <a href="https://r-pkgs.org/"><em>R Packages</em></a> å­¦ä¹ å¦‚ä½•å¼€å‘ R åŒ…ã€‚</li>
</ul></li>
<li>ä½¿ç”¨ <a href="https://github.com/ThinkR-open/golem">golem</a> æ¡†æ¶ï¼Œå­¦ä¹  <a href="https://engineering-shiny.org/index.html"><em>Engineering Production-Grade Shiny Apps</em></a></li>
<li>ä½¿ç”¨ <a href="https://github.com/Appsilon/rhino">rhino</a> æ¡†æ¶ï¼Œé€šè¿‡ <a href="https://appsilon.github.io/rhino/">å®˜æ–¹å„ç§æ–‡æ¡£</a> å­¦ä¹ ã€‚</li>
</ul>
<p>è¯»è€…ç›®æ ‡è‡ªæŸ¥ï¼šç†è§£å’Œç†Ÿç»ƒæŒæ¡ Shiny é»˜è®¤çš„ä»£ç éƒ¨ç½²æ–¹å¼ã€‚</p>
</section>
<section id="å…³å¡5-å­¦ä¹ å¦‚ä½•éƒ¨ç½²-shiny-app1-2-å‘¨" class="level2">
<h2 class="anchored" data-anchor-id="å…³å¡5-å­¦ä¹ å¦‚ä½•éƒ¨ç½²-shiny-app1-2-å‘¨">å…³å¡5: å­¦ä¹ å¦‚ä½•éƒ¨ç½² Shiny appï¼ˆ1-2 å‘¨ï¼‰</h2>
<p>å½“ä½ å¼€å‘çš„ app å¯ç”¨æ—¶ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¿›è¡Œéƒ¨ç½²ï¼Œæ–¹ä¾¿è‡ªå·±æµ‹è¯•æˆ–è€…ä»–äººä½¿ç”¨ã€‚æœ‰ä»¥ä¸‹å‡ ç§éƒ¨ç½²çš„æ–¹å¼ï¼š</p>
<ol type="1">
<li>é€šè¿‡ Posit å…¬å¸æä¾›çš„ <a href="https://www.shinyapps.io/">shinyapps æœåŠ¡</a>ã€‚æ¨èåˆå­¦è€…å°è¯•å’Œæ‘¸ç´¢ã€‚</li>
<li>è‡ªå·±åœ¨æœ¬åœ°çš„/äº‘æœåŠ¡å•†çš„ Linux æœåŠ¡å™¨ä¸Šè¿›è¡Œéƒ¨ç½²ï¼Œéœ€è¦äº†è§£ Linux ç³»ç»Ÿå¹¶æŒæ¡ Linux çš„åŸºæœ¬æ“ä½œï¼ˆé˜…è¯» <a href="https://seankross.com/the-unix-workbench/">The Unix Workbench</a>ï¼‰ã€‚å…·ä½“çš„éƒ¨ç½²å¯ä»¥å‚è€ƒä»¥ä¸‹å‡ ç¯‡æ–‡ç« ï¼š
<ol type="1">
<li><a href="https://mp.weixin.qq.com/s/f8QWD8RH6MTfvHSd57t2FQ"><em>åœ¨UbuntuæœåŠ¡å™¨ä¸Šé…ç½®Shinyåº”ç”¨</em></a></li>
<li><a href="https://www.linode.com/docs/guides/how-to-deploy-rshiny-server-on-ubuntu-and-debian"><em>How to Deploy Interactive R Apps with Shiny Server</em></a></li>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-shiny-server-on-ubuntu-20-04"><em>How To Set Up Shiny Server on Ubuntu 20.04</em></a></li>
</ol></li>
</ol>
<p>è¯»è€…ç›®æ ‡è‡ªæŸ¥ï¼šæŒæ¡ç¬¬ 1 ç§åº”ç”¨éƒ¨ç½²æ–¹å¼ï¼›æ¢ç´¢ç¬¬ 2 ç§éƒ¨ç½²æ–¹å¼å¹¶èƒ½è§£å†³é‡åˆ°çš„é—®é¢˜ã€‚</p>
</section>
<section id="å…³å¡6-å­¦ä¹ å’Œé‡ç°å®Œæ•´çš„-shiny-app2å‘¨ä»¥ä¸Š" class="level2">
<h2 class="anchored" data-anchor-id="å…³å¡6-å­¦ä¹ å’Œé‡ç°å®Œæ•´çš„-shiny-app2å‘¨ä»¥ä¸Š">å…³å¡6: å­¦ä¹ å’Œé‡ç°å®Œæ•´çš„ Shiny appï¼ˆ2å‘¨ä»¥ä¸Šï¼‰</h2>
<p>è¿™æ˜¯æœ€åä¸€é“å…³å£ï¼Œé—¯å…³æ„å‘³ç€ä½ å…·å¤‡äº†ç‹¬ç«‹å®Œæˆ app å¼€å‘çš„èƒ½åŠ›ã€‚å¤§å®¶ï¼ˆç‰¹åˆ«æ˜¯åˆå­¦è€…ï¼‰éœ€è¦è°¨è®°ï¼Œä¸€ä¸ªå¥½çš„ app åœ¨äºå®ƒçš„ä»£ç ç»“æ„æ¸…æ™°ã€èƒ½å¤Ÿå®Œæˆä»»åŠ¡ï¼Œä¸åœ¨äºæ¼‚äº®çš„ UIã€‚ æ‰€æœ‰çš„åŠŸèƒ½å®ç°åº”å½“æŠŠå®Œæˆåˆ†æ/å¯è§†åŒ–ç›®æ ‡ä¸ºç¬¬ä¸€ä½ï¼Œç„¶åå†èŠ±æ—¶é—´æ¢ç´¢å…·ä½“çš„ UI ç¾åŒ–ã€‚</p>
<p>ç”±äºå„ç±»è¯»è€…èƒŒæ™¯å’Œéœ€æ±‚ä¸ä¸€è‡´ï¼Œæˆ‘è¿™é‡Œåªåšä¸€äº›é€šç”¨çš„å­¦ä¹ èµ„æ–™æ¨èï¼Œé’ˆå¯¹è¯»è€…æ‰€åœ¨é¢†åŸŸçš„ app å¼€å‘ï¼Œéœ€è¦è¯»è€…è‡ªè¡Œäº†è§£å’ŒæŒæ¡ç›¸å…³çŸ¥è¯†èƒŒæ™¯ã€åˆ†ææŠ€èƒ½ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå¯»æ‰¾ä¸€äº›å·²ç»é€šè¿‡ Shiny å®ç°çš„æ•°æ®åº“/å·¥å…·çš„æºä»£ç ä»“åº“è¿›è¡Œå­¦ä¹ ã€‚</p>
<ul>
<li>Shiny examples: <a href="https://github.com/rstudio/shiny-examples" class="uri">https://github.com/rstudio/shiny-examples</a></li>
<li>Shiny galleryï¼š<a href="https://shiny.posit.co/r/gallery/" class="uri">https://shiny.posit.co/r/gallery/</a>ã€‚å®˜æ–¹æä¾›äº†å¾ˆå¤šåŠŸèƒ½ç‰¹æ€§çš„ app å®ç°ã€‚</li>
<li>Shiny Data Portal: <a href="https://github.com/SebKrantz/shiny-data-portal" class="uri">https://github.com/SebKrantz/shiny-data-portal</a>ã€‚A free Shiny Application to host, filter, aggregate and and download data in various formats.</li>
<li>machLearn, Machine learning dashboard created with R/shiny: <a href="https://github.com/davesteps/machLearn" class="uri">https://github.com/davesteps/machLearn</a></li>
<li>Shiny app for customizing Raincloud plots: <a href="https://github.com/gabrifc/raincloud-shiny" class="uri">https://github.com/gabrifc/raincloud-shiny</a></li>
</ul>
</section>
<section id="æ¨èèµ„æ–™" class="level2">
<h2 class="anchored" data-anchor-id="æ¨èèµ„æ–™">æ¨èèµ„æ–™</h2>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°½é‡é¿å…æ¨èæ¯”è¾ƒå¤šçš„èµ„æ–™ï¼Œå› ä¸ºå¯¹äºåˆå­¦è€…è¿‡å¤šçš„èµ„æ–™å¸¦æ¥çš„æ˜¯æ··æ·†ä¸å‹åŠ›ã€‚æˆ‘å¸Œæœ›ä½ èƒ½å¤Ÿé€šè¿‡ä¸Šè¿°çš„å…³å¡çœŸæ­£æœ‰æ•ˆåœ°å­¦ä¹ å’ŒæŒæ¡ Shiny å¼€å‘çš„çŸ¥è¯†è¦ç‚¹ï¼Œå¹¶åº”ç”¨äºä½ æ„Ÿå…´è¶£çš„é¡¹ç›®ä¸­å»ã€‚ ä½œä¸ºæœ¬æ–‡çš„æœ€åä¸€éƒ¨åˆ†ï¼Œæˆ‘å°†æä¾›ä¸€äº›éå¸¸é‡è¦çš„èµ„æºåœ°å€ï¼Œå¸Œæœ›åœ¨ä½ å›°æƒ‘æˆ–è€…æƒ³è¦å­¦ä¹ æ›´å¤šå†…å®¹æ—¶æ‰¾åˆ°çµæ„Ÿï¼</p>
<ul>
<li><a href="https://github.com/veeps/shiny_workshop" class="uri">https://github.com/veeps/shiny_workshop</a></li>
<li><a href="https://github.com/grabear/awesome-rshiny" class="uri">https://github.com/grabear/awesome-rshiny</a></li>
<li><a href="https://github.com/nanxstats/awesome-shiny-extensions" class="uri">https://github.com/nanxstats/awesome-shiny-extensions</a></li>
<li><a href="https://github.com/davidruvolo51/shinyAppTutorials" class="uri">https://github.com/davidruvolo51/shinyAppTutorials</a></li>
<li><a href="https://github.com/daattali/advanced-shiny" class="uri">https://github.com/daattali/advanced-shiny</a></li>
</ul>
<p>Enjoy playing with Shiny!</p>


</section>

 ]]></description>
  <category>shiny</category>
  <category>R</category>
  <category>bioinformatics</category>
  <guid>https://shixiangwang.github.io/posts/2023-09-13-shiny-learning-path-for-bioinformatics/index.html</guid>
  <pubDate>Tue, 12 Sep 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>æ£€æŸ¥ CPU çš„ä½¿ç”¨é‡</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-09-13-check-cpu-usage/index.html</link>
  <description><![CDATA[ 




<p>åœ¨ Linux æœåŠ¡å™¨ä¸Šæœ‰æ—¶å€™éœ€è¦æ£€æŸ¥ä¸‹ CPU çš„ä½¿ç”¨é‡ï¼Œç°åœ¨ä¸€èˆ¬ server çš„ CPU éƒ½æ¯”è¾ƒå¤šï¼Œè€Œåœ¨è®¡ç®—çš„æ—¶å€™ CPU ä¹Ÿæ˜¯åœ¨åŠ¨æ€åˆ‡æ¢çš„ï¼Œåƒ htop è¿™ç§å‘½ä»¤è¾“å‡ºå¯ä»¥ç›´è§‚çš„çœ‹å¤§ä½“æœ‰å¤šå°‘è¢«å ç”¨ï¼Œä½†æ²¡æ³•å¾—åˆ°å…·ä½“çš„æ•°å€¼ã€‚ è€Œä¼ ç»Ÿçš„æŒ‡æ ‡ cpu loadï¼Œä¸€èˆ¬ä¹Ÿä¸å¤ªä¼šå»çœ‹ï¼Œæˆ‘ä»¬åœ¨è¿ç®—æ—¶æƒ³çš„æ˜¯å°½é‡å ç”¨å‰©ä½™çš„ CPUï¼Œæ‰€ä»¥å¦‚æœèƒ½å¤Ÿå¾—åˆ°æ¯”è¾ƒç›´è§‚çš„æ•°å­—æ¯”è¾ƒå¥½ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª bash å‡½æ•°ï¼Œå¯ä»¥æ”¾åˆ° <code>~/.bashrc</code> ä¸­å»ã€‚ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ Shell ä¸­è¿è¡Œã€‚</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cpu()</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-2">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">top</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-bn2</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'%Cpu'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-P</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'(....|...) id,'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print "CPU Usage: " 100-$8 "%"}'</span></span>
<span id="cb1-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>å…·ä½“çš„è§£é‡Šå¯ä»¥çœ‹æ¥æºæ–‡ç« ï¼šhttps://www.baeldung.com/linux/get-cpu-usage</p>



 ]]></description>
  <category>Linux</category>
  <category>bioinformatics</category>
  <category>note</category>
  <guid>https://shixiangwang.github.io/posts/2023-09-13-check-cpu-usage/index.html</guid>
  <pubDate>Tue, 12 Sep 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>MAPQï¼ˆæ˜ å°„è´¨é‡ï¼‰ä¸-ASï¼ˆæ¯”å¯¹å¾—åˆ†ï¼‰</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-09-12-mapq-and-as/index.html</link>
  <description><![CDATA[ 




<p>ä»Šå¤©çœ‹ bwa mem çš„ <code>-q</code> é€‰é¡¹ï¼Œéå¸¸å›°æƒ‘ï¼šâ€œ-q, Donâ€™t reduce the mapping quality of split alignment of lower alignment scoreâ€ã€‚ ä¸æˆ‘åŸæ¥æƒ³è±¡ä¸­ mapping quality å’Œ alignment score ä¸¤ä¸ªä¸œè¥¿åº”è¯¥ç›¸åŒæ‰€ä¸åŒçš„æ˜¯ï¼Œæˆ‘æŸ¥è¯¢åå‘ç°è¿™çš„ç¡®æ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µã€‚</p>
<p>mapping quality (MAPQ) æ˜¯å‘Šè¯‰ä½ æŸä¸€ä¸ª read æ¥è‡ªæŸä¸€ä¸ªåŸºå› ç»„åŒºåŸŸçš„å¯é ç¨‹åº¦ï¼ˆå¯ä¿¡åº¦ï¼‰ï¼Œè€Œ alignment scoreï¼ˆASï¼‰å‘Šè¯‰ä½ çš„æ˜¯è¿™ä¸ªåºåˆ—ä¸å‚è€ƒåºåˆ—æœ‰å¤šç›¸ä¼¼ï¼ˆç”Ÿä¿¡å›¾ä¹¦/æ•™ç¨‹ä¸­ä¸€èˆ¬è¯´çš„æ¯”å¯¹ç®—æ³•å¾—åˆ†å°±æ˜¯è¿™ä¸ªï¼‰ï¼ŒåŒ¹é…çš„å¤šå¾—åˆ†å°±é«˜ã€‚</p>
<p>å¦‚æœä½ çš„ reads å®Œç¾çš„åŒ¹é…åˆ°äº†å¤šä¸ªåŸºå› ç»„åŒºåŸŸï¼Œé‚£ AS å°±ä¼šé«˜ä½†æ˜¯ MAPQ ä¼šä½ï¼Œå¦‚æœä½ çš„ reads æœ‰ä¸€äº›é”™é…ä¹‹ç±»çš„ï¼Œä½†åŒ¹é…åˆ°æŸäº›ä½ç‚¹çš„å¯ä¿¡åº¦æ¯”å…¶ä»–ä½ç‚¹é«˜ï¼Œé‚£ä¹ˆ AS ä¼šä½ï¼Œä½† MAPQ ä¼šé«˜ã€‚</p>
<blockquote class="blockquote">
<p>å‚è€ƒï¼š https://www.biostars.org/p/179457/</p>
</blockquote>
<section id="æ›´å¤šé˜…è¯»" class="level3">
<h3 class="anchored" data-anchor-id="æ›´å¤šé˜…è¯»">æ›´å¤šé˜…è¯»</h3>
<ul>
<li>https://genome.cshlp.org/content/suppl/2008/09/26/gr.078212.108.DC1/maq-supp.pdf</li>
<li>https://bioinformatics.stackexchange.com/questions/2417/meaning-of-bwa-mem-mapq-scores</li>
<li>https://maq.sourceforge.net/qual.shtml</li>
<li>https://support.illumina.com/content/dam/illumina-support/help/Illumina_DRAGEN_Bio_IT_Platform_v3_7_1000000141465/Content/SW/Informatics/Dragen/TPipelineMAPQ_fDG.htm</li>
<li>https://blog.csdn.net/tanzuozhev/article/details/89115080</li>
</ul>


</section>

 ]]></description>
  <category>bioinformatics</category>
  <guid>https://shixiangwang.github.io/posts/2023-09-12-mapq-and-as/index.html</guid>
  <pubDate>Mon, 11 Sep 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>discourse on the method</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-09-04-discourse-on-the-method/index.html</link>
  <description><![CDATA[ 




<p>ç¬›å¡å°”åœ¨ã€Šæ–¹æ³•è®ºã€‹ä¸­æ­ç¤ºäº†ç§‘å­¦ç ”ç©¶å’Œå‘æ˜åˆ›é€ çš„æ™®é€‚æ–¹æ³•ï¼Œå¹¶æ¦‚æ‹¬ä¸º 4 ä¸ªæ­¥éª¤ï¼š</p>
<ol type="1">
<li>ä¸ç›²ä»ï¼Œä¸æ¥å—ä»»ä½•è‡ªå·±ä¸æ¸…æ¥šçš„çœŸç†ã€‚ä¸ç®¡ä»€ä¹ˆæƒå¨çš„ç»“è®ºï¼Œåªè¦æ²¡æœ‰ç»è¿‡è‡ªå·±çš„ç ”ç©¶ï¼Œéƒ½å¯ä»¥æ€€ç–‘ã€‚</li>
<li>åŒ–ç¹ä¸ºç®€ã€åŒ–æ•´ä¸ºé›¶ã€‚</li>
<li>è§£å†³å°é—®é¢˜æ—¶ï¼ŒæŒ‰ç…§å…ˆæ˜“åéš¾çš„æ¬¡åºï¼Œé€æ­¥è§£å†³ã€‚</li>
<li>è§£å†³å…¨éƒ¨å°é—®é¢˜åï¼Œç»¼åˆçœ‹æ˜¯å¦è§£å†³äº†åŸæ¥çš„é—®é¢˜ã€‚</li>
</ol>
<p>ç§‘å­¦å‘å±•çš„è§„å¾‹ä¸ºï¼š</p>
<ol type="1">
<li>æå‡ºé—®é¢˜</li>
<li>è¿›è¡Œå®éªŒ</li>
<li>ä»å®éªŒä¸­å¾—åˆ°ç»“è®ºå¹¶è§£é‡Š</li>
<li>å°†ç»“è®ºæ¨å¹¿å¹¶æ™®éåŒ–</li>
<li>åœ¨å®è·µä¸­æ‰¾å‡ºæ–°çš„é—®é¢˜</li>
</ol>
<blockquote class="blockquote">
<p>æ¥æºï¼š å´å†› â€”â€” ã€Šå…¨çƒç§‘æŠ€é€šå²ã€‹</p>
</blockquote>



 ]]></description>
  <category>academic</category>
  <category>note</category>
  <category>thought</category>
  <guid>https://shixiangwang.github.io/posts/2023-09-04-discourse-on-the-method/index.html</guid>
  <pubDate>Sun, 03 Sep 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>circRNAé‰´å®šæµç¨‹-ä½¿ç”¨æ‰‹å†Œ</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/index.html</link>
  <description><![CDATA[ 




<p>æœ¬ç³»ç»Ÿæä¾›äº†ä¸€ä¸ªä½¿ç”¨å››ç§æ–¹æ³•ï¼ˆCIRIquantã€Circexplorer2ã€find_circå’ŒcircRNA_finderï¼‰ä»è½¬å½•ç»„åŒç«¯æµ‹åºçš„FASTQæ–‡ä»¶ä¸­è½»æ¾ä¸”å¯é‡å¤åœ°æ£€æµ‹ç¯çŠ¶RNAï¼ˆcircRNAï¼‰çš„è®¡ç®—æµç¨‹ã€‚</p>
<section id="åŠŸèƒ½ç‰¹æ€§" class="level2">
<h2 class="anchored" data-anchor-id="åŠŸèƒ½ç‰¹æ€§">åŠŸèƒ½ç‰¹æ€§</h2>
<ul>
<li>å¤šæ–¹æ³•é‰´å®šå’Œæ•´åˆ</li>
<li>å¹¶è¡Œè®¡ç®—æ”¯æŒ</li>
<li>æ–­ç‚¹ç»­è·‘</li>
<li>ç»“æœæ•´åˆå’Œè§„æ•´åŒ–è¾“å‡º</li>
<li>æ—¥å¿—è®°å½•</li>
</ul>
</section>
<section id="å‡†å¤‡å·¥ä½œ" class="level2">
<h2 class="anchored" data-anchor-id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</h2>
<section id="æ“ä½œç³»ç»Ÿç¯å¢ƒ" class="level3">
<h3 class="anchored" data-anchor-id="æ“ä½œç³»ç»Ÿç¯å¢ƒ">æ“ä½œç³»ç»Ÿç¯å¢ƒ</h3>
<p>æœ¬ç³»ç»Ÿéœ€è¦è¿è¡Œåœ¨ Linux ç³»ç»Ÿç¯å¢ƒä¸­ï¼ˆä¸é™å‘è¡Œç‰ˆæœ¬ï¼Œæµ‹è¯•ç³»ç»ŸåŒ…æ‹¬ Ubuntuã€CentOSï¼‰ã€‚ éœ€è¦ç”¨æˆ·çŸ¥é“å¦‚ä½•æ“ä½œ Linux ç³»ç»Ÿã€‚</p>
</section>
<section id="æ­¥éª¤1.-å®‰è£…æ‰€éœ€çš„condaç¯å¢ƒ" class="level3">
<h3 class="anchored" data-anchor-id="æ­¥éª¤1.-å®‰è£…æ‰€éœ€çš„condaç¯å¢ƒ">æ­¥éª¤1. å®‰è£…æ‰€éœ€çš„condaç¯å¢ƒ</h3>
<ol type="1">
<li><p>ï¼ˆå¯é€‰ï¼‰åˆ›å»ºä¸€ä¸ªåä¸ºâ€™circrnaâ€™çš„ç‹¬ç«‹Linuxå¸æˆ·ï¼Œç”¨äºéƒ¨ç½²å’Œè¿è¡Œå¾ªç¯RNAè¯†åˆ«æµç¨‹ã€‚</p></li>
<li><p>å®‰è£…<a href="https://docs.conda.io/en/latest/miniconda.html">miniconda3</a>åˆ°é»˜è®¤è·¯å¾„ï¼Œå³<code>~/miniconda3</code>ã€‚ å¦‚æœæŒ‰ç…§ä¸Šè¿°æ¨èè®¾ç½®ï¼Œcondaåº”è¯¥å¯åœ¨<code>/home/circrna/miniconda3</code>å¤„ä½¿ç”¨ã€‚</p></li>
<li><p>ä½¿ç”¨<code>conda install -n base --override-channels -c conda-forge mamba 'python_abi=*=*cp*'</code>å°†<a href="https://mamba.readthedocs.io/en/latest/installation.html">mamba</a>å®‰è£…åˆ°<code>base</code>ç¯å¢ƒä¸­ã€‚</p></li>
<li><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…<a href="https://just.systems/">just</a>ï¼š<code>curl --proto '=https' --tlsv1.2 -sSf https://just.systems/install.sh | bash -s -- --to ~/bin</code>ã€‚è¯·å°†<code>~/bin</code>æ·»åŠ åˆ°æ‚¨çš„<code>$PATH</code>ä¸­ã€‚ æ‚¨å¯ä»¥å°†<code>~/bin</code>æ›´æ”¹ä¸ºä»»ä½•ä½ç½®ï¼Œä½†åœ¨è¿›å…¥ç»ˆç«¯æ—¶éœ€è¦ä½¿<code>just</code>å¯ç”¨ã€‚</p></li>
<li><p>å®‰è£…<a href="https://github.com/shenwei356/rush">rush</a>å¹¶å°†å…¶è·¯å¾„æ·»åŠ åˆ°<code>$PATH</code>ï¼Œç±»ä¼¼äº<code>just</code>ã€‚</p></li>
<li><p>ï¼ˆå¯é€‰ï¼‰å¦‚æœéœ€è¦ï¼Œè®¾ç½®condaå’Œpypiï¼ˆpipï¼‰çš„æ³¨å†Œè¡¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨åœ¨ä¸­å›½ï¼Œæˆ‘å»ºè®®ä½¿ç”¨ä»¥ä¸‹é“¾æ¥è¿›è¡Œè®¾ç½®ï¼š<a href="https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/">https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/</a> å’Œ <a href="https://mirrors.tuna.tsinghua.edu.cn/help/pypi/">https://mirrors.tuna.tsinghua.edu.cn/help/pypi/</a>ã€‚</p></li>
<li><p>ä½¿ç”¨æœ¬è½¯è‘—æä¾›çš„ä»£ç ï¼Œå¹¶åˆ‡æ¢åˆ°ä»£ç ç›®å½•ã€‚</p></li>
<li><p>æŒ‰é¡ºåºå®‰è£…condaç¯å¢ƒã€‚</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> circrna-pipeline</span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> CIRIquant</span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">just</span> install</span>
<span id="cb1-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../FindCirc</span>
<span id="cb1-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">just</span> install</span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../Circexplorer2</span>
<span id="cb1-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">just</span> install</span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../circRNA_finder</span>
<span id="cb1-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">just</span> install</span></code></pre></div></li>
</ol>
<p>è¯·ç¡®ä¿å·²åˆ›å»ºæ‰€æœ‰condaç¯å¢ƒå¹¶å®‰è£…äº†æ‰€éœ€çš„è½¯ä»¶ã€‚</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903160124763.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image-20230903160124763</figcaption>
</figure>
</div>
</section>
<section id="æ­¥éª¤2.-å‡†å¤‡æ¯”å¯¹ç´¢å¼•å‚è€ƒæ–‡ä»¶å’Œé…ç½®æ–‡ä»¶" class="level3">
<h3 class="anchored" data-anchor-id="æ­¥éª¤2.-å‡†å¤‡æ¯”å¯¹ç´¢å¼•å‚è€ƒæ–‡ä»¶å’Œé…ç½®æ–‡ä»¶">æ­¥éª¤2. å‡†å¤‡æ¯”å¯¹ç´¢å¼•ã€å‚è€ƒæ–‡ä»¶å’Œé…ç½®æ–‡ä»¶</h3>
<p>è¦è¿è¡Œæµç¨‹ï¼Œéœ€è¦å‡†å¤‡å¥½ä¸€äº›å‚è€ƒæ•°æ®æ–‡ä»¶ã€‚</p>
<ol type="1">
<li><p>å‡†å¤‡åŸºå› ç»„fastaæ–‡ä»¶å’Œgtfæ–‡ä»¶ã€‚æˆ‘ä»¬ä½¿ç”¨<code>GRCh38.primary_assembly.genome.fa</code>å’Œ<code>gencode.v34.annotation.gtf</code>ã€‚</p></li>
<li><p>å¯¹äºCircexplorer2ï¼Œæ‚¨éœ€è¦ä½¿ç”¨<code>Circexplorer2</code>ç¯å¢ƒä¸­çš„<code>fetch_ucsc.py</code>è„šæœ¬ä¸‹è½½å‚è€ƒæ–‡ä»¶<code>hg38_ref_all.txt</code>ï¼ˆåº”ä¸æ‚¨çš„å‚è€ƒåŸºå› ç»„ç›¸å¯¹åº”ï¼‰ã€‚</p></li>
<li><p>å‡†å¤‡æ¯”å¯¹ç´¢å¼•ï¼Œ<a href="config_zhou.sh">config_zhou.sh</a>ä¸­è®°å½•äº†å‘½ä»¤å’Œé…ç½®ï¼Œæˆªå›¾å¦‚ä¸‹ã€‚</p>
<img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903160258992.png" class="img-fluid" alt="image-20230903160258992">
<p>è¯·æ³¨æ„ï¼Œåœ¨è¿è¡Œç´¢å¼•å‘½ä»¤ä¹‹å‰ï¼Œæ‚¨éœ€è¦æ¿€æ´»ç›¸åº”çš„ç¯å¢ƒã€‚</p>
<p>ä¾‹å¦‚ï¼Œä¸ºCIRIquantå‡†å¤‡ç´¢å¼•ã€‚ <code>sh  source activate CIRIquant  bwa index -a bwtsw -p /path/to/GRCh38.primary_assembly.genome.fa /path/to/GRCh38.primary_assembly.genome.fa  hisat2-build -p 40 /path/to/GRCh38.primary_assembly.genome.fa /path/to/GRCh38.primary_assembly.genome.fa</code></p></li>
<li><p>å¯¹äºCIRIquantï¼Œéœ€è¦ä¸€ä¸ª<code>yml</code>æ–‡ä»¶æ¥è®¾ç½®è½¯ä»¶å’Œæ–‡ä»¶çš„è·¯å¾„ï¼Œä¾‹å¦‚hg38.yml (CIRIquant/hg38.ymlï¼Œæˆªå›¾å¦‚ä¸‹)ã€‚æ‚¨éœ€è¦ä¿®æ”¹å†…å®¹ä»¥é€‚åº”æ‚¨çš„è®¾ç½®ï¼ˆä¹Ÿå¯ä»¥åˆ›å»ºå¦ä¸€ä¸ª<code>yml</code>æ–‡ä»¶ï¼‰ã€‚</p>
<img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903160451460.png" class="img-fluid" alt="image-20230903160451460"></li>
<li><p>è®¾ç½®ä¸€ä¸ª<code>config.sh</code>æ–‡ä»¶ï¼Œå®ƒä½¿ç”¨SHELLå˜é‡è®¾ç½®äº†æ‰€æœ‰å¿…éœ€çš„è®¾ç½®ï¼Œconfig_zhou.sh (config_zhou.sh) æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å‚è€ƒï¼ˆå½“ç„¶ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹å…¶å†…å®¹ï¼‰ã€‚</p>
<img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903160258992.png" class="img-fluid" alt="image-20230903160258992"></li>
</ol>
</section>
</section>
<section id="ä½¿ç”¨æµç¨‹" class="level2">
<h2 class="anchored" data-anchor-id="ä½¿ç”¨æµç¨‹">ä½¿ç”¨æµç¨‹</h2>
<section id="é¢„å¤„ç†è½¬å½•ç»„åŒç«¯æµ‹åºçš„-fastq-æ–‡ä»¶" class="level3">
<h3 class="anchored" data-anchor-id="é¢„å¤„ç†è½¬å½•ç»„åŒç«¯æµ‹åºçš„-fastq-æ–‡ä»¶">é¢„å¤„ç†è½¬å½•ç»„åŒç«¯æµ‹åºçš„ fastq æ–‡ä»¶</h3>
<p>è¿™ä¸€éƒ¨åˆ†çš„ä»£ç å­˜å‚¨åœ¨ qc å’Œcommonç›®å½•ä¸‹é¢ï¼Œæˆ‘ä»¬æä¾›äº† <code>md5check.sh</code> æ–¹ä¾¿ç”¨æˆ·å¯¹è‡ªå·±çš„æ•°æ®è¿›è¡Œ md5 å®Œæ•´æ€§æ£€æŸ¥ï¼Œç¡®ä¿æ•°æ®å®Œæ•´åå¯ä»¥å¼€å§‹è¿›è¡Œæ•°æ®çš„é¢„å¤„ç†æ­¥éª¤ï¼ŒåŒ…æ‹¬è´¨æ§ã€å»é™¤åŒç«¯çš„äººä¸ºæ ‡è®°åºåˆ—ï¼ˆadaptersï¼‰ã€‚ç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶åç¼€éœ€è¦ç¡®ä¿ä¸º<code>_1.fastq.gz</code>å’Œ<code>_2.fastq.gz</code>ã€‚ç¤ºä¾‹æ–‡ä»¶åˆ—è¡¨æˆªå›¾å¦‚ä¸‹ï¼Œçº¢è‰²æ¡†é€‰äº†æ–‡ä»¶åç¼€ã€‚</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903160856615.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image-20230903160856615</figcaption>
</figure>
</div>
<p>å®Œæˆåå¯ä»¥è¿›è¡Œé¢„å¤„ç†æ“ä½œï¼Œä¸‹é¢æä¾›äº†ç¤ºä¾‹çš„ Shell è„šæœ¬ã€‚</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/usr/bin/env bash</span></span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># æŒ‡å®šè½¯ä»¶è·¯å¾„</span></span>
<span id="cb2-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">py</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/home/circrna/miniconda3/bin/python3</span>
<span id="cb2-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/home/circrna/miniconda3/bin/fastp</span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># æŒ‡å®šä»£ç ç›®å½•</span></span>
<span id="cb2-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PIPELINE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/home/circrna/circrna-pipeline</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># æŒ‡å®šè¾“å…¥ã€è¾“å‡ºè·¯å¾„</span></span>
<span id="cb2-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fqfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>./sample_list.txt</span>
<span id="cb2-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">indir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/path/to/input</span>
<span id="cb2-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oudir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/path/to/output</span>
<span id="cb2-13"></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># é…ç½® CPU æ•°ç›®</span></span>
<span id="cb2-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nthreads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>20</span>
<span id="cb2-16"></span>
<span id="cb2-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># è°ƒç”¨è„šæœ¬ç”Ÿæˆè¾“å…¥ç›®å½•ä¸‹çš„æ ·æœ¬ ID åˆ—è¡¨</span></span>
<span id="cb2-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${py}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PIPELINE}</span>/common/ll_fq.py <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${indir}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fqfile}</span></span>
<span id="cb2-19"></span>
<span id="cb2-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># è°ƒç”¨é¢„å¤„ç†å‘½ä»¤åˆ°åå°è¿è¡Œï¼Œå¹¶å°†è¿è¡Œçš„æ—¥å¿—å¯¼å‡ºåˆ° test_qc.log</span></span>
<span id="cb2-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nohup</span> bash <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PIPELINE}</span>/qc/fp.sh <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fqfile}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${indir}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${oudir}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${nthreads}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fp}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;</span> test_qc.log <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">&amp;</span></span></code></pre></div>
<p>ä¸‹é¢æˆªå›¾å±•ç¤ºäº†é¢„å¤„ç†çš„æ—¥å¿—ä¿¡æ¯ï¼Œæœ€ç»ˆä¼šç”Ÿæˆæ ·æœ¬çš„è´¨é‡æ£€æµ‹æŠ¥å‘Šï¼ˆhtmlæ–‡ä»¶ï¼‰ã€‚</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903161015118.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image-20230903161015118</figcaption>
</figure>
</div>
<p>æŠ¥å‘Šæ–‡ä»¶æˆªå›¾ï¼š</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903161412806.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image-20230903161412806</figcaption>
</figure>
</div>
</section>
<section id="è¿è¡Œæ£€æµ‹æµç¨‹" class="level3">
<h3 class="anchored" data-anchor-id="è¿è¡Œæ£€æµ‹æµç¨‹">è¿è¡Œæ£€æµ‹æµç¨‹</h3>
<p>åˆ›å»ºä¸€ä¸ªåŒ…å«ä»¥ä¸‹è®¾ç½®å’Œå‘½ä»¤çš„shellè„šæœ¬ã€‚</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># æŒ‡å®šè¾“å…¥ã€è¾“å‡ºè·¯å¾„</span></span>
<span id="cb3-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fqfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>./sample_list.txt</span>
<span id="cb3-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">indir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/path/include/paired/fastq/files</span>
<span id="cb3-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">oudir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/path/to/output</span>
<span id="cb3-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nthreads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>20</span>
<span id="cb3-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">config</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/path/to/your/config.sh</span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">common/ll_fq.py</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${indir}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fqfile}</span></span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nohup</span> bash caller.sh <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fqfile}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${indir}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${oudir}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${nthreads}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${config}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;</span> run.log <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">&amp;</span></span></code></pre></div>
<blockquote class="blockquote">
<p>å¿…é¡»åœ¨conda <code>base</code>ç¯å¢ƒä¸­ï¼ˆæˆ–å·²å®‰è£…<code>python3</code>çš„æƒ…å†µä¸‹ï¼‰æ‰§è¡Œè¯¥è„šæœ¬ã€‚ å¦‚æœæ‚¨å·²ç»è‡ªå·±å‡†å¤‡äº†<code>sample_list.txt</code>æ–‡ä»¶ã€‚ æ‚¨å¯ä»¥æ³¨é‡Šæ‰<code>common/ll_fq.py</code>è¿™ä¸€è¡Œï¼Œç„¶åå¯ä»¥åœ¨bashä¸­è¿è¡Œè¯¥è„šæœ¬ è€Œæ— éœ€ä»»ä½•å…¶ä»–è¦æ±‚ï¼ˆä¾‹å¦‚ï¼Œä¸éœ€è¦ä»<code>base</code>ç¯å¢ƒä¸­å®‰è£…<code>python3</code>ï¼‰ã€‚</p>
</blockquote>
<p>æˆ‘å»ºè®®ä½¿ç”¨2ä¸ªæ ·æœ¬æµ‹è¯•æµç¨‹ã€‚å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œç„¶åè¿è¡Œæ‚¨æ‹¥æœ‰çš„æ‰€æœ‰æ•°æ®æ–‡ä»¶ã€‚æµç¨‹å°†è·³è¿‡å·²ç”Ÿæˆç»“æœæ–‡ä»¶çš„æ ·æœ¬ã€‚</p>
<p>æ—¥å¿—æˆªå›¾ï¼š</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903162126629.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image-20230903162126629</figcaption>
</figure>
</div>
<p>å¦‚æœè¿è¡Œå‡ºç°ä¸­æ–­ï¼Œå†æ¬¡è¿è¡Œè„šæœ¬/å‘½ä»¤å³å¯ï¼Œæµç¨‹ä¼šè‡ªåŠ¨è·³è¿‡å·²æ£€æµ‹å®Œæˆçš„æ ·æœ¬ã€‚</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903162238611.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image-20230903162238611</figcaption>
</figure>
</div>
</section>
<section id="æ£€æŸ¥æ£€æµ‹è¾“å‡ºç»“æœ" class="level3">
<h3 class="anchored" data-anchor-id="æ£€æŸ¥æ£€æµ‹è¾“å‡ºç»“æœ">æ£€æŸ¥æ£€æµ‹è¾“å‡ºç»“æœ</h3>
<p>è¾“å‡ºç›®å½•åŒ…å«æ ¹æ®æ ·æœ¬åç§°å’Œæ–¹æ³•ç»„åˆçš„ç»“æœæ–‡ä»¶ã€‚</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903161627392.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image-20230903161627392</figcaption>
</figure>
</div>
<p>ç»“æœæ–‡ä»¶é€šå¸¸åŒ…å«å¾ªç¯RNAçš„ä½ç½®å’Œè®¡æ•°å€¼ã€‚</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903161702141.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image-20230903161702141</figcaption>
</figure>
</div>
</section>
<section id="èšåˆç»“æœ" class="level3">
<h3 class="anchored" data-anchor-id="èšåˆç»“æœ">èšåˆç»“æœ</h3>
<p>ä¸Šè¿°ç”Ÿæˆäº† 4 ç§æ£€æµ‹æ–¹æ³•çš„å•ç‹¬ç»“æœï¼Œæˆ‘ä»¬ä¸‹ä¸€æ­¥éœ€è¦å¯¹ç»“æœè¿›è¡Œèšåˆï¼Œç›¸å…³ä»£ç æ”¾åœ¨ aggr ç›®å½•ä¸‹ã€‚</p>
<p><code>aggr_beds.R</code> æä¾›äº†å¯¹æ–¹æ³•ç»“æœèšåˆçš„ä»£ç ï¼Œç¤ºä¾‹è¿è¡Œå‘½ä»¤ä¸ºï¼š</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">./aggr/aggr_dataset.R</span> /path/to/result /path/to/aggr_output</span></code></pre></div>
<p>è¿™æ ·æ¯ä¸€ä¸ªæ ·æœ¬éƒ½æœ‰ä¸€ä¸ªèšåˆçš„ç»“æœæ–‡ä»¶ã€‚</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903161752469.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image-20230903161752469</figcaption>
</figure>
</div>
<p>è¿›ä¸€æ­¥ï¼Œç”¨æˆ·è¿˜å¯ä»¥åˆ©ç”¨ <code>aggr_dataset.R</code> å¯¹å…¨éƒ¨çš„æ ·æœ¬ï¼ˆå³æ•´ä¸ªè¾“å…¥æ•°æ®é›†ï¼‰ç»“æœç”Ÿæˆä¸€ä¸ªæ•´åˆç»“æœã€‚</p>
<p>è°ƒç”¨å‘½ä»¤ä¸ºï¼š</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">./aggr/aggr_dataset.R</span> /path/to/aggr_output /path/to/dataset_output</span></code></pre></div>
<p>æœ€åç»“æœä¼šåœ¨ <code>/path/to/dataset_output</code> ç”Ÿæˆ <code>aggr_output_circRNA.tsv.gz</code> æ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤§çš„å‹ç¼©æ•°æ®è¡¨æ ¼ï¼ŒåŒ…å«ä»¥ä¸‹ä¸€äº›åˆ—ä¿¡æ¯ã€‚</p>
<pre><code>id, symbol, strand, chrom, startUpBSE, endDownBSE, tool, samples...</code></pre>
<ul>
<li>id: circRNA çš„å”¯ä¸€æ ‡è®°ä¿¡æ¯</li>
<li>symbol: åŸºå› å</li>
<li>strand: é“¾ä¿¡æ¯</li>
<li>chrom: circRNA æŸ“è‰²ä½“ä¿¡æ¯</li>
<li>startUpBSE: circRNA æŸ“è‰²ä½“èµ·ç‚¹</li>
<li>endDownBSE: circRNA æŸ“è‰²ä½“ç»ˆç‚¹</li>
<li>tool: æ–¹æ³•æ ‡è®°</li>
<li>samplesâ€¦ï¼šå…¶ä»–æ¯åˆ—éƒ½å¯¹åº”å¤„ç†çš„ä¸€ä¸ªæ ·æœ¬</li>
</ul>
<p>ä¸‹é¢æ˜¯æµ‹è¯•ç”Ÿæˆçš„æ–‡ä»¶ï¼š</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903162442921.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image-20230903162442921</figcaption>
</figure>
</div>
<p>æŸ¥çœ‹å®ƒçš„éƒ¨åˆ†å†…å®¹æ•°æ®ï¼š</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/https:/cdn.jsdelivr.net/gh/shixiangwang/cdn/img/image-20230903162511289.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">image-20230903162511289</figcaption>
</figure>
</div>
<p>ç”¨æˆ·å¯ä»¥åˆ©ç”¨æµç¨‹ä¸åŒçš„ç»“æœè¿›è¡Œä¸‹æ¸¸çš„åˆ†æå’Œç ”ç©¶ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>ä¸åŒæ–¹æ³•çš„æ£€æµ‹ç»“æœ</li>
<li>åŒä¸€ä¸ªæ ·æœ¬ä¸åŒæ–¹æ³•æ£€æµ‹çš„èšåˆç»“æœ</li>
<li>æ•´ä¸ªè¾“å…¥æ ·æœ¬æ•°æ®é›†çš„æ£€æµ‹æ•´åˆç»“æœ</li>
</ul>


</section>
</section>

 ]]></description>
  <category>bioinformatics</category>
  <guid>https://shixiangwang.github.io/posts/2023-09-03-use-circrna-pipeline/index.html</guid>
  <pubDate>Sat, 02 Sep 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>pnas</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-08-31-pnas/index.html</link>
  <description><![CDATA[ 




<p>æƒ³å‘ä¸€ç¯‡ PNASï¼Œå¸Œæœ› 3 å¹´å†…èƒ½è¾¾æˆã€‚</p>



 ]]></description>
  <category>random</category>
  <guid>https://shixiangwang.github.io/posts/2023-08-31-pnas/index.html</guid>
  <pubDate>Wed, 30 Aug 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>normalize data å’Œ scale data çš„å·®å¼‚</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-08-17-normalize-and-scale-data/index.html</link>
  <description><![CDATA[ 




<p>â€œNormalize dataâ€ å’Œ â€œscale dataâ€ éƒ½æ˜¯æ•°æ®é¢„å¤„ç†çš„æ­¥éª¤ï¼Œä½†å®ƒä»¬åœ¨å…·ä½“æ“ä½œå’Œæ•ˆæœä¸Šæœ‰æ‰€ä¸åŒã€‚</p>
<p><strong>Normalize Data (æ•°æ®å½’ä¸€åŒ–):</strong> æ•°æ®å½’ä¸€åŒ–æ˜¯ä¸€ç§å¸¸è§çš„é¢„å¤„ç†æ–¹æ³•ï¼Œç”¨äºå°†ä¸åŒç‰¹å¾çš„æ•°æ®è°ƒæ•´åˆ°ç›¸åŒçš„å°ºåº¦èŒƒå›´å†…ã€‚è¿™æœ‰åŠ©äºé¿å…åœ¨æ¨¡å‹è®­ç»ƒä¸­å› ä¸ºæŸäº›ç‰¹å¾å€¼èŒƒå›´è¾ƒå¤§è€Œå¯¼è‡´çš„æ¨¡å‹æ”¶æ•›é—®é¢˜ã€‚é€šå¸¸ï¼Œæ•°æ®å½’ä¸€åŒ–æ„å‘³ç€å°†æ•°æ®ç¼©æ”¾åˆ°0åˆ°1ä¹‹é—´çš„èŒƒå›´ï¼Œä½¿å…¶å…·æœ‰ç›¸ä¼¼çš„å°ºåº¦ã€‚å¸¸è§çš„å½’ä¸€åŒ–æ–¹æ³•åŒ…æ‹¬æœ€å°-æœ€å¤§ç¼©æ”¾ã€Z-å¾—åˆ†æ ‡å‡†åŒ–ç­‰ã€‚æ•°æ®å½’ä¸€åŒ–é€šå¸¸ä¸ä¼šæ”¹å˜æ•°æ®çš„åˆ†å¸ƒå½¢çŠ¶ï¼Œåªæ˜¯å°†å…¶æ˜ å°„åˆ°ä¸€ä¸ªæ›´ç»Ÿä¸€çš„å°ºåº¦ã€‚</p>
<p><strong>Scale Data (æ•°æ®æ ‡å‡†åŒ–):</strong> æ•°æ®æ ‡å‡†åŒ–ä¹Ÿæ˜¯æ•°æ®é¢„å¤„ç†çš„ä¸€éƒ¨åˆ†ï¼Œä½†å®ƒæ›´æ³¨é‡å°†æ•°æ®è½¬æ¢æˆç‰¹å®šçš„åˆ†å¸ƒï¼Œé€šå¸¸æ˜¯å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒã€‚æ ‡å‡†åŒ–åï¼Œæ•°æ®çš„å‡å€¼ä¼šæ¥è¿‘0ï¼Œæ ‡å‡†å·®æ¥è¿‘1ï¼Œä»è€Œä½¿å¾—æ•°æ®æ›´é€‚åˆä¸€äº›è¦æ±‚æ•°æ®æœä»æ­£æ€åˆ†å¸ƒçš„æ¨¡å‹ã€‚æ ‡å‡†åŒ–é€šå¸¸ç”¨äºåœ¨ç‰¹å¾ä¹‹é—´çš„å·®å¼‚è¾ƒå¤§ä¸”å¯èƒ½å¯¹æ¨¡å‹æ€§èƒ½äº§ç”Ÿå½±å“æ—¶ã€‚</p>
<p>å› æ­¤ï¼Œâ€œnormalize dataâ€ ä¾§é‡äºå°†æ•°æ®æ˜ å°„åˆ°ç›¸åŒçš„å°ºåº¦èŒƒå›´å†…ï¼Œè€Œ â€œscale dataâ€ åˆ™å¼ºè°ƒå°†æ•°æ®è°ƒæ•´ä¸ºç‰¹å®šåˆ†å¸ƒçš„å½¢å¼ï¼Œé€šå¸¸æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚é€‰æ‹©ä½¿ç”¨å“ªç§æ–¹æ³•å–å†³äºå…·ä½“çš„é—®é¢˜å’Œæ¨¡å‹éœ€æ±‚ã€‚</p>
<blockquote class="blockquote">
<p>é—®é¢˜æ˜¯æˆ‘é—®çš„ï¼Œå›ç­”æ˜¯ ChatGPTã€‚æˆ‘è§‰å¾—å¾ˆå¥½ã€‚</p>
</blockquote>
<p>æˆ‘ç»§ç»­é—®ï¼šâ€œz score å˜æ¢ä¸å°±æ˜¯æ•°æ®è½¬æ¢æˆç‰¹å®šçš„åˆ†å¸ƒï¼Œé€šå¸¸æ˜¯å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒï¼Ÿâ€</p>
<p>å›ç­”æ¥äº†ï¼š</p>
<p>æ˜¯çš„ï¼Œæ‚¨è¯´å¾—å¯¹ã€‚Z-scoreæ ‡å‡†åŒ–ï¼ˆZ-score transformationï¼‰æ˜¯ä¸€ç§å¸¸è§çš„æ•°æ®æ ‡å‡†åŒ–æ–¹æ³•ï¼Œå…¶ç›®çš„æ­£æ˜¯å°†æ•°æ®è½¬æ¢ä¸ºå‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒã€‚è¿™ç§æ ‡å‡†åŒ–æ–¹æ³•é€šè¿‡å‡å»å‡å€¼ï¼Œç„¶åé™¤ä»¥æ ‡å‡†å·®ï¼Œä½¿æ•°æ®çš„åˆ†å¸ƒæ¥è¿‘æ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚è¿™æœ‰åŠ©äºä½¿æ•°æ®é€‚ç”¨äºé‚£äº›è¦æ±‚æ•°æ®æœä»æ­£æ€åˆ†å¸ƒçš„æ¨¡å‹ï¼ŒåŒæ—¶ä¹Ÿæœ‰åŠ©äºå¤„ç†ä¸åŒå°ºåº¦å’ŒèŒƒå›´çš„ç‰¹å¾ï¼Œä»¥æé«˜æ¨¡å‹çš„ç¨³å®šæ€§å’Œæ•ˆæœã€‚</p>
<p>åœ¨å‰é¢çš„å›ç­”ä¸­ï¼Œæˆ‘æ²¡æœ‰æ¸…æ™°åœ°è¡¨è¾¾å‡º â€œscale dataâ€ çš„æ¦‚å¿µï¼Œæˆ‘æ··æ·†äº† â€œnormalize dataâ€ å’Œ Z-scoreæ ‡å‡†åŒ–ã€‚éå¸¸æŠ±æ­‰å¯¹æ­¤é€ æˆäº†å›°æ‰°ã€‚äº‹å®ä¸Šï¼ŒZ-scoreæ ‡å‡†åŒ–å°±æ˜¯ â€œscale dataâ€ çš„ä¸€ä¸ªå…·ä½“ç¤ºä¾‹ï¼Œç”¨äºå°†æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ï¼Œä½¿å…¶ç¬¦åˆå‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒã€‚</p>
<blockquote class="blockquote">
<p>çœ‹æ¥æœºå™¨äººä¹Ÿæœ‰ç‚¹æ‡µã€‚</p>
</blockquote>
<p>æˆ‘ä»¬çœ‹çœ‹åˆ«äººçš„å›ç­”ï¼Œä¸‹é¢çš„æ¯”è¾ƒå¯¹å‘³ï¼š</p>
<p>One of the reasons that itâ€™s easy to get confused between scaling and normalization is because the terms are sometimes used interchangeably and, to make it even more confusing, they are very similar! In both cases, youâ€™re transforming the values of numeric variables so that the transformed data points have specific helpful properties. The difference is that:</p>
<p>in scaling, youâ€™re changing the range of your data, while in normalization, youâ€™re changing the shape of the distribution of your data.</p>
<p>ä¸ºäº†å°½é‡é¿å…è¯¯è¯»ï¼Œæˆ‘è¿™é‡Œæ”¾äº†è‹±æ–‡åŸæ–‡ã€‚æ„Ÿå…´è¶£çš„å¯ä»¥çœ‹ä¸‹ <a href="https://www.kaggle.com/code/alexisbcook/scaling-and-normalization/tutorial" class="uri">https://www.kaggle.com/code/alexisbcook/scaling-and-normalization/tutorial</a> å…·ä½“è¯´æ˜ã€‚</p>
<p>ç®€è€Œè¨€ä¹‹ï¼š</p>
<ul>
<li>scaling æ”¹å˜æ•°æ®å–å€¼èŒƒå›´ï¼ˆæ¯”å¦‚ min-max å˜æ¢ï¼Œz-score å˜æ¢ï¼‰ã€‚</li>
<li>normalization æ”¹å˜æ•°æ®çš„åˆ†å¸ƒï¼ˆå¦‚ log å˜æ¢ï¼‰ã€‚</li>
</ul>



 ]]></description>
  <category>note</category>
  <category>stats</category>
  <guid>https://shixiangwang.github.io/posts/2023-08-17-normalize-and-scale-data/index.html</guid>
  <pubDate>Wed, 16 Aug 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>caddyfile</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-08-11-caddyfile/index.html</link>
  <description><![CDATA[ 




<p>Caddy æ˜¯ä¸€ä¸ªåå‘ä»£ç†å·¥å…·ï¼Œè‡ªåŠ¨æ”¯æŒ httpsã€‚ è¿™é‡Œæˆ‘è®°å½•ä¸‹ä¹‹å‰å¼„çš„ä»£ç†é…ç½®ï¼Œå…å¾—æœåŠ¡å™¨åˆ°æœŸäº†è¿™æ®µç»éªŒè¢«é—å¿˜æ‰äº†ã€‚</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> cat /etc/caddy/Caddyfile </span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The Caddyfile is an easy way to configure your Caddy web server.</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Unless the file starts with a global options block, the first</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># uncommented line is always the address of your site.</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To use your own domain name (with automatic HTTPS), first make</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sure your domain's A/AAAA DNS records are properly pointed to</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this machine's public IP, then replace ":80" below with your</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># domain name.</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#:80, 139.9.81.126:80 {</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   # Set this path to your site's directory.</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   #root * /usr/share/caddy</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   # Enable the static file server.</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   #file_server</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#        #tls self_signed</span></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   # Another common task is to set up a reverse proxy:</span></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   reverse_proxy localhost:8090</span></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   # Or serve a PHP site through php-fpm:</span></span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   # php_fastcgi localhost:9000</span></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#}</span></span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">shixiangwang.work</span> {</span>
<span id="cb1-29"></span>
<span id="cb1-30">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">encode</span> gzip</span>
<span id="cb1-31">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reverse_proxy</span> localhost:8090</span>
<span id="cb1-32"></span>
<span id="cb1-33">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#handle_path /blog/zd* {</span></span>
<span id="cb1-34">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  reverse_proxy localhost:8091</span></span>
<span id="cb1-35">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#}</span></span>
<span id="cb1-36"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-37"></span>
<span id="cb1-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mia.shixiangwang.work</span> {</span>
<span id="cb1-39">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">encode</span> gzip</span>
<span id="cb1-40">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reverse_proxy</span> localhost:8091</span>
<span id="cb1-41"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-42"></span>
<span id="cb1-43"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">love.shixiangwang.work</span> {</span>
<span id="cb1-44">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">root</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> /var/www/love</span>
<span id="cb1-45">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">file_server</span></span>
<span id="cb1-46"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-47"></span>
<span id="cb1-48"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pybook.shixiangwang.work</span> {</span>
<span id="cb1-49">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">root</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> /var/www/pybook</span>
<span id="cb1-50">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">file_server</span></span>
<span id="cb1-51"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-52"></span>
<span id="cb1-53"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cookbook4r.shixiangwang.work</span> {</span>
<span id="cb1-54">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">root</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> /var/www/Cookbook-for-R-Chinese/docs</span>
<span id="cb1-55">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">file_server</span></span>
<span id="cb1-56"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-57"></span>
<span id="cb1-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Refer to the Caddy docs for more information:</span></span>
<span id="cb1-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://caddyserver.com/docs/caddyfile</span></span></code></pre></div>



 ]]></description>
  <category>note</category>
  <category>Linux</category>
  <guid>https://shixiangwang.github.io/posts/2023-08-11-caddyfile/index.html</guid>
  <pubDate>Thu, 10 Aug 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>Duplication Rate ç»éªŒå€¼</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-08-01-duplication-rate/index.html</link>
  <description><![CDATA[ 




<p>æœ€è¿‘å¤„ç† RNA-Seq çš„åŸå§‹æ•°æ®ï¼Œç”¨ fastp å‘ç° duplication rate å¾ˆé«˜ï¼Œæœ‰ä¸å°‘ 60% çš„ï¼Œæ¯”è¾ƒå¥‡æ€ªã€‚</p>
<p>æœç´¢äº†ä¸‹å¸¸è§çš„å€¼ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p>
<section id="duplication-rateç»éªŒå€¼" class="level2">
<h2 class="anchored" data-anchor-id="duplication-rateç»éªŒå€¼">Duplication Rateç»éªŒå€¼</h2>
<p>WESï¼šæ•°æ®é‡çº¦10Gæ—¶ï¼ŒDuplication rateåœ¨10%å·¦å³;</p>
<p>WGSï¼šæ•°æ®é‡çº¦90Gæ—¶ï¼ŒDuplication rateåœ¨10%å·¦å³;</p>
<p>RNA-seqï¼šDuplication rateåœ¨40% ~ 50%å·¦å³;</p>
<p>WGBSï¼š&gt;10G, Duplication rate &gt; 10%ï¼›</p>
<p>å¤šé‡PCRè¯•å‰‚ç›’å’Œé¶å‘æ•è·Panelï¼Œå·®å¼‚å¾ˆå¤§ï¼Œè·Ÿéœ€è¦æµ‹åºçš„åŒºåŸŸä»¥åŠæµ‹åºé‡æœ‰å…³ï¼Œé€šå¸¸æƒ…å†µä¸‹åªè¦ä¸­é¶éƒ¨åˆ†æ•°æ®è´¨é‡è¶³å¤Ÿå¥½ï¼ŒDuplication rateä¸æ˜¯ä¸€ä¸ªé‡è¦çš„è€ƒè™‘æŒ‡æ ‡ã€‚</p>
<blockquote class="blockquote">
<p>å‚è€ƒæ–‡ç« ï¼šhttps://zhuanlan.zhihu.com/p/635160066</p>
</blockquote>


</section>

 ]]></description>
  <category>note</category>
  <category>bioinformatics</category>
  <guid>https://shixiangwang.github.io/posts/2023-08-01-duplication-rate/index.html</guid>
  <pubDate>Mon, 31 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>Single-cell Workshop 2021 - 03 - ç»†èƒç›¸äº’ä½œç”¨åˆ†æ</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-31-cell-interaction-analysis/index.html</link>
  <description><![CDATA[ <p>å­¦ä¹ èµ„æ–™ï¼š<a href="https://github.com/pkuerten/single_cell_interaction.github.io/blob/main/index.md">GitHub åœ°å€</a></p>
<section id="å°´å°¬äº†æµç¨‹è·‘ä¸é€š" class="level2"><h2 class="anchored" data-anchor-id="å°´å°¬äº†æµç¨‹è·‘ä¸é€š">å°´å°¬äº†ï¼Œæµç¨‹è·‘ä¸é€š</h2>
<p>è¿™ä¸ªæ•™ç¨‹åœ¨è¿è¡Œåˆ° <code><a href="https://rdrr.io/pkg/nichenetr/man/predict_ligand_activities.html">predict_ligand_activities()</a></code> å°±å‡ºç°äº†é—®é¢˜ã€‚åé¢å°±èµ°ä¸ä¸‹å»äº†ã€‚</p>
<pre><code>predict_ligand_activities(geneset = geneset_oi, background_expressed_genes = background_expressed_genes, ligand_target_matrix = ligand_target_matrix, potential_
    ligands = potential_ligands)
Error in evaluate_target_prediction(setting, ligand_target_matrix, ligands_position) : 
  all genes have same response</code></pre>
<p>æˆ‘è‡ªå·±ä¹Ÿæ‡’å¾—æŠ˜è…¾äº†ï¼Œæœ¬èº«å°±æ˜¯æƒ³ç®€å•å­¦ä¹ äº†è§£æµç¨‹ï¼Œèµ°ä¸é€šå°±ä¸èµ°äº†ã€‚å¦‚æœæœ‰è¯»è€…çœ‹åˆ°è¿™ä¸ªæ–‡ç« ï¼Œæ„Ÿå…´è¶£å¯ä»¥é’»ç ”ä¸‹ã€‚</p>
<p>æˆ‘æŸ¥äº†ä¸‹ï¼Œ<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9184522/">Comparison of methods and resources for cell-cell communication inference from single-cell RNA-Seq data</a> æ˜¾ç¤ºCellChatã€CellPhoneDBå’ŒSingleCellSignalRï¼Œå¯¹æ•°æ®å’Œèµ„æºä¸­çš„å™ªå£°éƒ½ç›¸å½“ç¨³å¥ã€‚å› è€ŒNicheNetå¹¶ä¸åœ¨æ¨èèŒƒå›´å†…ã€‚</p>
<p>ä¸è¿‡ä¹Ÿæåˆ°ï¼š</p>
<blockquote class="blockquote">
<p>Methods that additionally infer intracellular processes, such as NicheNet19, Cytotalk22, and SoptSC20 are not directly comparable but instead provide complementary analyses.</p>
</blockquote>
<p>è¯´æ˜ç›®å‰çœ‹ï¼Œè¿˜æ˜¯æœ‰ä¸€äº›ç‰¹å®šçš„åˆ†ææœ‰å¯å–ä¹‹å¤„ã€‚</p>
</section><section id="æ•°æ®ä¸‹è½½" class="level2"><h2 class="anchored" data-anchor-id="æ•°æ®ä¸‹è½½">æ•°æ®ä¸‹è½½</h2>
<p>æˆ‘ä»¬å°†ä½¿ç”¨SeuratDataè½¯ä»¶åŒ…æä¾›çš„PBMCæ•°æ®é›†ã€‚è¯¥æ•°æ®é›†åŒ…å«ä¸¤ä¸ªPBMCæ ·æœ¬ï¼šç»è¿‡IFN Betaå¤„ç†çš„åˆºæ¿€æ ·æœ¬å’Œå¯¹ç…§æ ·æœ¬ã€‚</p>
<p>å¯¹äºç»†èƒäº¤äº’åˆ†æï¼Œæˆ‘ä»¬å°†ä½¿ç”¨NicheNetï¼Œå®ƒéœ€è¦ä¸€äº›ç²¾å¿ƒç­–åˆ’çš„æ•°æ®é›†ã€‚è™½ç„¶è¿™äº›æ•°æ®é›†å¯ä»¥åœ¨Rç¯å¢ƒå†…ä¸‹è½½ï¼Œä½†å¯¹æˆ‘æ¥è¯´ä¸‹è½½é€Ÿåº¦å¤ªæ…¢äº†ã€‚è¿™äº›æ–‡ä»¶å¯ä»¥ä»Zenodoä¸‹ï¼ˆ<a href="https://zenodo.org/record/3260758" class="uri">https://zenodo.org/record/3260758</a>ï¼‰è½½ï¼šgr_network.rdsã€ligand_target_matrix.rdsã€lr_network.rdså’Œweighted_networks.rdsã€‚</p>
<p>è¯·å°†è¿™äº›æ•°æ®é›†æ”¾åˆ°ä½ çš„å·¥ä½œç›®å½•ä¸­ã€‚</p>
</section><section id="å‡†å¤‡" class="level2"><h2 class="anchored" data-anchor-id="å‡†å¤‡">å‡†å¤‡</h2>
<p>æœ¬æ–‡å‚è€ƒ Seurat <a href="https://satijalab.org/seurat/articles/integration_introduction.html">æ•°æ®æ•´åˆæ–‡æ¡£è¿›è¡Œåˆ†æçš„è¾“å…¥æ•°æ®å‡†å¤‡</a>ï¼Œå‡è®¾ä½ å¯¹æ•°æ®é¢„å¤„ç†éƒ¨åˆ†å·²ç»å¾ˆç†Ÿæ‚‰ã€‚</p>
</section><section id="å®‰è£…åŒ…" class="level2"><h2 class="anchored" data-anchor-id="å®‰è£…åŒ…">å®‰è£…åŒ…</h2>
<p>å®‰è£…æ‰€éœ€è¦çš„åŒ…ã€‚</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">BiocManager</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"limma"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">BiocManager</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glmGamPoi"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("devtools")</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://seurat.nygenome.org/src/contrib/ifnb.SeuratData_3.0.0.tar.gz"</span>, repos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, type <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"source"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">devtools</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"saeyslab/nichenetr"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># å¯ä»¥ä¸‹è½½ä¹‹åå®‰è£…ï¼Œé¿å…å®‰è£…ä¸ä¸Š</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://github.com/saeyslab/nichenetr</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># unzip("~/Downloads/nichenetr-master.zip")</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ç¼ºä»€ä¹ˆè£…ä»€ä¹ˆ</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BiocManager::install(c("fdrtool", "DiagrammeR", "mlrMBO", "parallelMap", "emoa", "DiceKriging"))</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("nichenetr-master", repos = NULL, type = "source")</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<p>åŠ è½½åŒ…ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load into your session</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ifnb.SeuratData</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat">Seurat</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Attaching SeuratObject</code></pre>
</div>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load dataset</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ifnb"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
</section><section id="è¯»å–æ•°æ®é›†å¹¶åˆ›å»ºä¸€ä¸ªseuratå¯¹è±¡" class="level2"><h2 class="anchored" data-anchor-id="è¯»å–æ•°æ®é›†å¹¶åˆ›å»ºä¸€ä¸ªseuratå¯¹è±¡">è¯»å–æ•°æ®é›†å¹¶åˆ›å»ºä¸€ä¸ªSeuratå¯¹è±¡</h2>
<p>ç¬¬ä¸€æ­¥æ˜¯ä»SeuratDataè½¯ä»¶åŒ…ä¸­è¯»å–æ•°æ®ã€‚è¾“å…¥æ•°æ®æ ¹æ®æ ·æœ¬è¿›è¡Œæ‹†åˆ†ï¼Œå¹¶åˆ†åˆ«åº”ç”¨SCtranformã€‚è¯·æ³¨æ„ï¼Œè¿™å–ä»£äº†NormalizeDataã€ScaleDataå’ŒFindVariableFeaturesçš„æ­¥éª¤ã€‚SCTransformæ˜¯ä¸€ç§ä¸“é—¨è®¾è®¡ç”¨äºå•ç»†èƒUMIè®¡æ•°æ•°æ®çš„ç»Ÿè®¡æ–¹æ³•ã€‚å®ƒå…‹æœäº†ä¹‹å‰æ‰¹é‡è®¾è®¡çš„å½’ä¸€åŒ–æ–¹æ³•ä¸­ä¸€äº›è¿‡åº¦æ‹Ÿåˆçš„é™åˆ¶ã€‚æœ‰å…³å…¶ä¼˜åŠ¿çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯å¯ä»¥åœ¨<a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1874-1">SCtranformçš„è®ºæ–‡</a>ä¸­æ‰¾åˆ°ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬æ²¡æœ‰åº”ç”¨ä»»ä½•è´¨æ§æ­¥éª¤ã€‚è¿™æ˜¯å› ä¸ºæ•°æ®å·²ç»é¢„å…ˆæ¸…æ´ï¼Œå› æ­¤æ— éœ€é‡å¤è¿™äº›æ­¥éª¤ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ifnb.list</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/SplitObject.html">SplitObject</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ifnb</span>, split.by <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stim"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ifnb.list</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ifnb.list</span>, FUN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SCTransform</span>, method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glmGamPoi"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cell attributes from input UMI matrix: log_umi</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Variance stabilizing transformation of count matrix of size 12747 by 6548</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Model formula is y ~ log_umi</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Get Negative Binomial regression parameters per gene</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using 2000 genes, 5000 cells</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found 95 outliers - those will be ignored in fitting/regularization step</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Second step: Get residuals using fitted parameters for 12747 genes</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |=====                                                                 |   8%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |=================================================================     |  92%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Computing corrected count matrix for 12747 genes</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |=====                                                                 |   8%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |=================================================================     |  92%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating gene attributes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Wall clock passed: Time difference of 31.92474 secs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Determine variable features</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Place corrected count matrix in counts slot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Centering data matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Set default assay to SCT</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cell attributes from input UMI matrix: log_umi</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Variance stabilizing transformation of count matrix of size 12658 by 7451</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Model formula is y ~ log_umi</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Get Negative Binomial regression parameters per gene</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using 2000 genes, 5000 cells</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Found 101 outliers - those will be ignored in fitting/regularization step</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Second step: Get residuals using fitted parameters for 12658 genes</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |=====                                                                 |   8%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |=================================================================     |  92%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Computing corrected count matrix for 12658 genes</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |=====                                                                 |   8%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |=================================================================     |  92%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating gene attributes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Wall clock passed: Time difference of 30.21689 secs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Determine variable features</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Place corrected count matrix in counts slot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Centering data matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Set default assay to SCT</code></pre>
</div>
<div class="sourceCode" id="cb41" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">features</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/SelectIntegrationFeatures.html">SelectIntegrationFeatures</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>object.list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ifnb.list</span>, nfeatures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ifnb.list</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/PrepSCTIntegration.html">PrepSCTIntegration</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>object.list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ifnb.list</span>, anchor.features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ifnb.list</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ifnb.list</span>, FUN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RunPCA</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">features</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>PC_ 1 
Positive:  FTL, TIMP1, IL8, CCL2, FTH1, C15orf48, S100A8, SOD2, ACTB, S100A9 
       LYZ, FCER1G, TYROBP, S100A4, HLA-DRA, CD63, CD14, S100A11, LGALS3, ANXA5 
       LGALS1, CXCL3, S100A10, IL1B, CTSL, PLAUR, CTSB, TYMP, S100A6, CST3 
Negative:  RPL3, RPS18, RPS6, LTB, RPL13, CCR7, GIMAP7, RPL13A, PTMA, CXCR4 
       RPSA, RPS2, RPL21, CD3D, RPS5, LDHB, NPM1, RPS4X, CCL5, RPS3 
       TMEM66, RPS14, RPS27, PABPC1, RPL10A, RPS15A, RPL5, RPL32, RPS19, RPL34 
PC_ 2 
Positive:  CCL2, CCL5, GNLY, S100A8, NKG7, FTL, S100A9, GZMB, GIMAP7, CD7 
       CD3D, CD14, FTH1, IL8, CXCL3, CD2, FGFBP2, CCL7, RGCC, RARRES3 
       GZMH, APOBEC3G, TMEM66, CLIC3, ITM2A, CTSL, LTB, IL32, LCK, GIMAP5 
Negative:  HLA-DRA, CD74, HLA-DQA1, HLA-DPA1, HLA-DRB1, HLA-DPB1, HLA-DQB1, CD83, TXN, CCR7 
       CCL22, HLA-DMA, IDO1, ACTB, HERPUD1, LYZ, SYNGR2, CD79A, MIR155HG, BIRC3 
       PKIB, RAB9A, SERPINB1, RAMP1, GPR183, CST3, FABP5, HLA-DRB5, TVP23A, ID2 
PC_ 3 
Positive:  RPS18, RPL13, LTB, RPS6, FTL, RPL3, RPL32, RPL10, RPS2, PABPC1 
       RPL34, RPL13A, RPS14, RPS4X, RPL21, S100A8, CCL2, RPS12, RPL11, RPL7 
       RPS3A, RPL18A, LDHB, SELL, RPS15A, RPS3, RPS8, S100A9, RPS5, RPS27A 
Negative:  GNLY, NKG7, CCL5, GZMB, CST7, APOBEC3G, FGFBP2, CLIC3, GZMH, KLRD1 
       GZMA, CTSW, PRF1, HOPX, KLRC1, CHST12, TNFRSF18, CCL4, VMO1, FCGR3A 
       DUSP2, LDHA, CXCR3, C1orf21, ID2, MATK, SPON2, SH2D1B, RARRES3, APMAP 
PC_ 4 
Positive:  HSPB1, HSP90AB1, HSPE1, CACYBP, CCL2, HSPA8, CREM, HSPD1, SRSF7, HSPH1 
       HSPA1A, FTL, CD69, UBB, GADD45B, UBC, SRSF2, ZFAND2A, HSP90AA1, IL8 
       NOP58, DDIT4, NR4A2, CHORDC1, H3F3B, BTG1, RSRC2, DNAJB1, SNHG15, YPEL5 
Negative:  VMO1, FCGR3A, TIMP1, MS4A7, RPL3, FAM26F, TNFSF10, RPS4X, RPS2, RPS19 
       RPL10, RPS18, PLAC8, CXCL16, CXCL10, HLA-DPA1, LST1, HLA-DPB1, RPL13, TNFSF13B 
       MS4A4A, RPS14, IFITM3, HN1, AIF1, GBP5, RPS6, CCL5, CD74, GBP1 
PC_ 5 
Positive:  CCL2, FTL, GNLY, CCL5, NKG7, IL8, GZMB, S100A8, S100A9, LYZ 
       HLA-DRA, CST7, CD74, HLA-DQA1, CXCL3, TXN, FGFBP2, CD63, GAPDH, CLIC3 
       IL1B, HLA-DPB1, HLA-DRB1, VIM, RPL3, GZMH, CCL7, APOBEC3G, C15orf48, HLA-DQB1 
Negative:  VMO1, FCGR3A, MS4A7, TIMP1, FAM26F, TNFSF10, CXCL10, HSPB1, IFITM3, GBP1 
       AIF1, PLAC8, MS4A4A, LST1, GBP5, CXCL16, HN1, SAT1, ATP1B3, OAS1 
       ISG15, C3AR1, WARS, CTSC, PPM1N, RGS2, TNFSF13B, SOD2, IFIT3, FGL2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>PC_ 1 
Positive:  FTL, CXCL10, CCL2, CCL8, APOBEC3A, SOD2, TIMP1, C15orf48, CCL7, APOBEC3B 
       ISG15, IDO1, CCL3, IFITM3, CXCL11, LYZ, TYROBP, CCL4, IFI27, FCER1G 
       FTH1, CTSL, SAT1, TYMP, IL1RN, LGALS3, S100A11, CTSC, CD63, LGALS1 
Negative:  RPL3, RPS6, RPS18, RPL13, RPL21, RPL7, RPL13A, CCR7, RPL10A, RPS4X 
       RPS2, GIMAP7, RPS3, RPS3A, RPS14, RPS27A, PTMA, RPL10, RPS15A, RPL34 
       RPS5, RPL32, PABPC1, RPL5, CXCR4, RPS27, RPL31, LTB, MALAT1, RPL14 
PC_ 2 
Positive:  CCL2, CCL8, CCL7, RPS18, RPL13, RPS6, FTL, RPL3, RPL32, SELL 
       RPS14, RPL34, LTB, RPL7, RPL13A, RPL21, RPL10, GIMAP7, PABPC1, RPS2 
       RPS4X, APOBEC3B, RPL10A, RPS15A, RPS3A, LDHB, S100A9, RPS12, RPL35A, RPL31 
Negative:  GNLY, GZMB, NKG7, CCL5, PRF1, CD74, CLIC3, CST7, GZMA, HLA-DRA 
       APOBEC3G, GZMH, HLA-DPB1, HLA-DPA1, KLRD1, CTSW, TXN, FCGR3A, HLA-DQA1, VMO1 
       HLA-DRB1, FASLG, ID2, FGFBP2, CD83, KLRC1, MS4A7, HLA-DQB1, RARRES3, TIMP1 
PC_ 3 
Positive:  CD74, HLA-DRA, HLA-DPB1, CXCL10, HLA-DPA1, HLA-DQA1, HLA-DRB1, TXN, TIMP1, CD83 
       VMO1, FCGR3A, CCR7, HLA-DQB1, MS4A7, MARCKSL1, IRF8, CST3, BIRC3, SYNGR2 
       MS4A4A, SERPINB1, CD79A, CXCL16, CD86, MIR155HG, HLA-DMA, CCL22, ACTB, FAM26F 
Negative:  GNLY, CCL2, CCL8, NKG7, CCL5, GZMB, CCL7, PRF1, GZMA, GZMH 
       CLIC3, KLRD1, CTSW, RARRES3, S100A9, ALOX5AP, FASLG, APOBEC3G, FGFBP2, CTSL 
       CD7, CCL4, KLRC1, CST7, S100A8, ANXA1, CCL3, CD247, IL32, LGALS3 
PC_ 4 
Positive:  FCGR3A, VMO1, MS4A7, TIMP1, MS4A4A, CXCL16, FAM26F, PLAC8, TNFSF10, TNFAIP6 
       C3AR1, LST1, FTH1, CXCL10, TYROBP, CTSC, AIF1, GBP5, PPM1N, CFD 
       MT2A, CDKN1C, SERPINA1, IFITM3, SLC31A2, HN1, PLAUR, FCER1G, FCGR3B, EDN1 
Negative:  CCL2, CCL8, CD74, HLA-DRA, TXN, HLA-DQA1, CCL7, HLA-DPB1, FTL, HLA-DRB1 
       LYZ, MIR155HG, HLA-DQB1, CD83, IRF8, FABP5, CCR7, MARCKSL1, BIRC3, APOBEC3B 
       TSPAN13, HERPUD1, HSPE1, HSPD1, HLA-DPA1, ID3, PMAIP1, HSP90AB1, CD79A, NME1 
PC_ 5 
Positive:  CD74, HLA-DPB1, HLA-DRA, RPL3, TXN, RPS18, RPS4X, MARCKSL1, HLA-DPA1, RPL10 
       RPL13, LYZ, HLA-DRB1, FTL, RPS2, GNLY, RPS14, GZMB, CCL5, RPS3 
       RPL34, NKG7, RPL11, RPL13A, CST3, RPL32, RPS6, RPL21, HLA-DQA1, LSP1 
Negative:  CCL4, CCL3, CD69, SRSF7, HSPE1, HSP90AB1, CACYBP, HSPA8, HSPD1, SRSF2 
       DDIT4, CREM, GADD45B, UBC, NOP58, UBB, HSPH1, TCP1, JUNB, SOD1 
       SAT1, CLK1, RSRC2, BTG1, DNAJB6, NR4A2, MYC, IRF1, DNAJB1, BATF </code></pre>
</div>
</div>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä¸¤ä¸ªæ•°æ®é›†è¿›è¡Œæ•´åˆã€‚æ•´åˆä¾èµ–äºåœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸­éƒ½å­˜åœ¨çš„é«˜å˜é‡ç‰¹å¾ï¼Œå¹¶ä¸”åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ã€‚ç¬¬ä¸€æ­¥FindIntegrationAnchorså®šä¹‰é”šç‚¹æˆ–ç»†èƒå¯¹ï¼ˆæ¯ä¸ªæ ·æœ¬ä¸­å„é€‰æ‹©ä¸€ä¸ªç»†èƒï¼‰ï¼Œè¿™äº›ç»†èƒéå¸¸ç›¸ä¼¼ï¼Œå› æ­¤å¯ä»¥æœ‰ä¿¡å¿ƒåœ°å°†å®ƒä»¬åˆ†é…åˆ°ç›¸åŒçš„ç°‡ï¼ˆç»†èƒç±»å‹å’ŒçŠ¶æ€ï¼‰ã€‚ç¬¬äºŒæ­¥IntegrateDataä½¿ç”¨æ‰€å®šä¹‰çš„é”šç‚¹å¯¹é½å®Œæ•´çš„æ•°æ®é›†ã€‚æœ‰å…³æ•´åˆæ–¹æ³•çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯å’Œè‡ªåŸå§‹Seuratè®ºæ–‡ä»¥æ¥çš„æ”¹è¿›å¯ä»¥åœ¨ä»–ä»¬<a href="https://pubmed.ncbi.nlm.nih.gov/34062119/">æœ€è¿‘çš„å‡ºç‰ˆç‰©</a>ä¸­æ‰¾åˆ°ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb44" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.anchors</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindIntegrationAnchors.html">FindIntegrationAnchors</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>object.list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ifnb.list</span>, normalization.method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SCT"</span>, anchor.features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">features</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, reduction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rpca"</span>, k.anchor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Computing within dataset neighborhoods</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finding all pairwise anchors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Projecting new data onto SVD
Projecting new data onto SVD</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finding neighborhoods</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finding anchors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>    Found 32565 anchors</code></pre>
</div>
<div class="sourceCode" id="cb51" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/IntegrateData.html">IntegrateData</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>anchorset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.anchors</span>, normalization.method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SCT"</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Merging dataset 1 into 2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Extracting anchors for merged samples</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finding integration vectors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finding integration vector weights</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Integrating data</code></pre>
</div>
</div>
<p>æ•´åˆåçš„å¯¹è±¡åŒ…å«ç»è¿‡æ‰¹æ¬¡æ•ˆåº”æ ¡æ­£çš„å€¼ï¼Œä»¥åŠåŸå§‹è®¡æ•°å€¼ä½œä¸ºå•ç‹¬çš„æµ‹å®šã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb57" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/RunPCA.html">RunPCA</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/RunUMAP.html">RunUMAP</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span>, reduction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric
To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'
This message will be shown once per session</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>15:39:33 UMAP embedding parameters a = 0.9922 b = 1.112</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>15:39:33 Read 13999 rows and found 30 numeric columns</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>15:39:33 Using Annoy for neighbor search, n_neighbors = 30</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>15:39:33 Building Annoy index with metric = cosine, n_trees = 50</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>0%   10   20   30   40   50   60   70   80   90   100%</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[----|----|----|----|----|----|----|----|----|----|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>**************************************************|
15:39:35 Writing NN index file to temp file /var/folders/bj/nw1w4g1j37ddpgb6zmh3sfh80000gn/T//RtmpF254ot/file1575b69d2520a
15:39:35 Searching Annoy index using 1 thread, search_k = 3000
15:39:38 Annoy recall = 100%
15:39:39 Commencing smooth kNN distance calibration using 1 thread with target n_neighbors = 30
15:39:40 Initializing from normalized Laplacian + noise (using irlba)
15:39:41 Commencing optimization for 200 epochs, with 600044 positive edges
15:39:49 Optimization finished</code></pre>
</div>
</div>
<p>å¯è§†åŒ–ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb66" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimPlot.html">DimPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span>, reduction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"umap"</span>, group.by <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stim"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimPlot.html">DimPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span>, reduction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"umap"</span>, group.by <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"seurat_annotations"</span>, label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span>    repel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p2</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-31-cell-interaction-analysis/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="ç»†èƒç›¸äº’ä½œç”¨åˆ†æ" class="level2"><h2 class="anchored" data-anchor-id="ç»†èƒç›¸äº’ä½œç”¨åˆ†æ">ç»†èƒç›¸äº’ä½œç”¨åˆ†æ</h2>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/31819264/">NicheNet</a>æ—¨åœ¨é€šè¿‡å°†ç‰¹å®šç°‡çš„å•ç»†èƒè¡¨è¾¾æ•°æ®ä¸å…³äºé…ä½“-å—ä½“å¯¹å’Œç›®æ ‡ä¸‹æ¸¸çš„åŸºå› è°ƒæ§ç½‘ç»œçš„å…ˆéªŒçŸ¥è¯†ç›¸ç»“åˆï¼Œé¢„æµ‹é…ä½“å’Œç›®æ ‡ç»†èƒä¹‹é—´çš„ç›¸äº’ä½œç”¨è¿æ¥ã€‚ç‰¹åˆ«åœ°ï¼Œå®ƒæ—¨åœ¨å®šä¹‰èƒ½å¤Ÿæœ€å¥½è§£é‡Šç›®æ ‡ç°‡ä¸­è§‚å¯Ÿåˆ°çš„å·®å¼‚è¡¨è¾¾çš„é…ä½“ã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆåŠ è½½å¿…è¦çš„Rè½¯ä»¶åŒ…ã€‚âš ï¸åœ¨æˆ‘åŠ è½½äº†NicheNetè½¯ä»¶åŒ…åï¼Œéƒ¨åˆ†Seuratæ•´åˆå‘½ä»¤æœªèƒ½æˆåŠŸæ‰§è¡Œã€‚ä¸¤ä¸ªè½¯ä»¶åŒ…ä¹‹é—´å¯èƒ½å­˜åœ¨ä¸€äº›ä¸å…¼å®¹æ€§ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb67" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/saeyslab/nichenetr">nichenetr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
âœ” dplyr     1.1.2     âœ” readr     2.1.4
âœ” forcats   1.0.0     âœ” stringr   1.5.0
âœ” ggplot2   3.4.2     âœ” tibble    3.2.1
âœ” lubridate 1.9.2     âœ” tidyr     1.3.0
âœ” purrr     1.0.1     
â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– dplyr::filter() masks stats::filter()
âœ– dplyr::lag()    masks stats::lag()
â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<p>åŠ è½½æ•°æ®é›†ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb69" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ligand_target_matrix</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/wsx/Library/CloudStorage/OneDrive-shanghaitech.edu.cn/Public/data/ligand_target_matrix.rds"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ligand_target_matrix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                CXCL1        CXCL2        CXCL3        CXCL5         PPBP
A1BG     3.534343e-04 4.041324e-04 3.729920e-04 3.080640e-04 2.628388e-04
A1BG-AS1 1.650894e-04 1.509213e-04 1.583594e-04 1.317253e-04 1.231819e-04
A1CF     5.787175e-04 4.596295e-04 3.895907e-04 3.293275e-04 3.211944e-04
A2M      6.027058e-04 5.996617e-04 5.164365e-04 4.517236e-04 4.590521e-04
A2M-AS1  8.898724e-05 8.243341e-05 7.484018e-05 4.912514e-05 5.120439e-05</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb71" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lr_network</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/wsx/Library/CloudStorage/OneDrive-shanghaitech.edu.cn/Public/data/lr_network.rds"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lr_network</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 4
  from  to    source         database
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;chr&gt;   
1 CXCL1 CXCR2 kegg_cytokines kegg    
2 CXCL2 CXCR2 kegg_cytokines kegg    
3 CXCL3 CXCR2 kegg_cytokines kegg    
4 CXCL5 CXCR2 kegg_cytokines kegg    
5 PPBP  CXCR2 kegg_cytokines kegg    
6 CXCL6 CXCR2 kegg_cytokines kegg    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb73" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">weighted_networks</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/wsx/Library/CloudStorage/OneDrive-shanghaitech.edu.cn/Public/data/weighted_networks.rds"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">weighted_networks_lr</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">weighted_networks</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lr_sig</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lr_network</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">from</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">to</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, by <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"from"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"to"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">weighted_networks</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lr_sig</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># interactions and their weights in the ligand-receptor + signaling network</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 3
  from  to     weight
  &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;
1 A1BG  ABCC6  0.422 
2 A1BG  ACE2   0.101 
3 A1BG  ADAM10 0.0970
4 A1BG  AGO1   0.0525
5 A1BG  AKT1   0.0855
6 A1BG  ANXA7  0.457 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb75" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html">Idents</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">seurat_annotations</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/DefaultAssay.html">DefaultAssay</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"integrated"</span></span></code></pre></div>
</div>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¾èµ–äºæ•°æ®æä¾›çš„ç­›é€‰ç»†èƒæ³¨é‡Šã€‚ æˆ‘ä»¬å°†é‡ç‚¹æ”¾åœ¨CD8 Tç»†èƒä½œä¸ºæ¥æ”¶ç»†èƒï¼Œå¹¶å¯»æ‰¾pDCã€CD14 Monoã€CD16 Monoã€NKã€Bã€DCã€B Activatedç¾¤é›†ä¸­çš„å‘é€å™¨é…ä½“ã€‚</p>
<p>æˆ‘ä»¬å®šä¹‰æ¥æ”¶ç»†èƒå’Œå‘é€å™¨ç»†èƒç¾¤ä½“ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜è¯†åˆ«åœ¨æ¥æ”¶ç»†èƒä¸­è¡¨è¾¾çš„åŸºå› ï¼Œè¿™äº›åŸºå› ä¹Ÿæ˜¯æˆ‘ä»¬çŸ¥è¯†åº“çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>ğŸ’¡å¦‚æœæŸä¸ªåŸºå› åœ¨æ•°æ®åº“ä¸­æ²¡æœ‰è¢«çŸ¥é“ç”±ä»»ä½•é…ä½“è°ƒæ§ï¼Œè¯¥æ–¹æ³•å°†æ— æ³•åœ¨å…¶é¢„æµ‹ä¸­ä½¿ç”¨å®ƒã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb76" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">receiver</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD8 T"</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">expressed_genes_receiver</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/nichenetr/man/get_expressed_genes.html">get_expressed_genes</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">receiver</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span>, pct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.10</span>, assay_oi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RNA"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">background_expressed_genes</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">expressed_genes_receiver</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">.</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">.</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ligand_target_matrix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sender_celltypes</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pDC"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD14 Mono"</span> ,  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD16 Mono"</span>,  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NK"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DC"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B Activated"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">list_expressed_genes_sender</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sender_celltypes</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">get_expressed_genes</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.10</span>, assay_oi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RNA"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">expressed_genes_sender</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">list_expressed_genes_sender</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>å®šä¹‰æ¥æ”¶ç»†èƒä¸­ç›¸å¯¹äºæ ·æœ¬å¤„ç†çš„å·®å¼‚åŸºå› ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb77" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">seurat_obj_receiver</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span>, idents <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">receiver</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">seurat_obj_receiver</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html">SetIdent</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">immune.combined.sct</span>, value <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">seurat_obj_receiver</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orig.ident"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">condition_oi</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IMMUNE_STIM"</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">condition_reference</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IMMUNE_CTRL"</span> </span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">DE_table_receiver</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindMarkers.html">FindMarkers</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>object <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">seurat_obj_receiver</span>, ident.1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">condition_oi</span>, ident.2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">condition_reference</span>, min.pct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.10</span>, assay<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RNA"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">geneset_oi</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">DE_table_receiver</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p_val</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">avg_log2FC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gene</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">geneset_oi</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">geneset_oi</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">.</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">.</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ligand_target_matrix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</div>
<p>å®šä¹‰åœ¨å„è‡ªç¾¤é›†ä¸­è¡¨è¾¾çš„é…ä½“å’Œå—ä½“åŸºå› ã€‚æ½œåœ¨çš„é…ä½“é›†è¢«ç¼©å°ä¸ºåœ¨æ¥æ”¶ç»†èƒç¾¤é›†ä¸­è¡¨è¾¾çš„å…·æœ‰é¶æ ‡çš„é…ä½“ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb78" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ligands</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lr_network</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">from</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">receptors</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lr_network</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">to</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">expressed_ligands</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://generics.r-lib.org/reference/setops.html">intersect</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ligands</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">expressed_genes_sender</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">expressed_receptors</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://generics.r-lib.org/reference/setops.html">intersect</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">receptors</span>,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">expressed_genes_receiver</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">potential_ligands</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lr_network</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">from</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">expressed_ligands</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">to</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">expressed_receptors</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">from</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>NicheNetçš„é…ä½“æ´»æ€§åˆ†ææ ¹æ®æ¥æ”¶ç»†èƒä¸­å­˜åœ¨çš„è¡¨è¾¾é¶æ ‡åŸºå› çš„æƒ…å†µå¯¹é…ä½“è¿›è¡Œæ’åã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb79" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ligand_activities = predict_ligand_activities(geneset = geneset_oi, background_expressed_genes = background_expressed_genes, ligand_target_matrix = ligand_target_matrix, potential_ligands = potential_ligands)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ligand_activities = ligand_activities %&gt;% arrange(-pearson) %&gt;% mutate(rank = rank(desc(pearson)))</span></span>
<span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ligand_activities</span></span></code></pre></div>
</div>


</section> ]]></description>
  <category>note</category>
  <category>scRNA-seq</category>
  <category>R</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-31-cell-interaction-analysis/index.html</guid>
  <pubDate>Sun, 30 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>Single-cell Workshop 2021 - 02 - èšç±»å’Œç»†èƒç±»å‹é‰´å®š</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index.html</link>
  <description><![CDATA[ <p>å­¦ä¹ èµ„æ–™ï¼š<a href="https://github.com/pkuerten/single_cell_clustering_annotation.github.io/blob/main/index.md">GitHub åœ°å€</a></p>
<section id="æ•°æ®ä¸‹è½½" class="level2"><h2 class="anchored" data-anchor-id="æ•°æ®ä¸‹è½½">æ•°æ®ä¸‹è½½</h2>
<p>æˆ‘ä»¬å°†ä½¿ç”¨åŒ…å«å¤§çº¦10Kä¸ªå•ç»†èƒçš„PBMCæ•°æ®é›†ã€‚è¿™ä¸ªæ•°æ®é›†æ˜¯ç”±10XåŸºå› ç»„å…¬å¸å…¬å¼€æä¾›çš„ï¼Œå¯ä»¥ä» <a href="https://www.dropbox.com/s/wn4mgwkkzqw2pox/SC3_v3_NextGem_DI_PBMC_10K_filtered_feature_bc_matrix.h5?dl=0" class="uri">https://www.dropbox.com/s/wn4mgwkkzqw2pox/SC3_v3_NextGem_DI_PBMC_10K_filtered_feature_bc_matrix.h5?dl=0</a> ä¸‹è½½ã€‚</p>
</section><section id="å‡†å¤‡" class="level2"><h2 class="anchored" data-anchor-id="å‡†å¤‡">å‡†å¤‡</h2>
<p>è¿™ä¸ªæ–‡ç« çš„å†…å®¹çµæ„Ÿæ¥è‡ªå¤šä¸ª<a href="https://satijalab.org/seurat/articles/get_started.html">Seurat æ–‡æ¡£</a>ã€‚å®ƒå‡å®šä½ å·²ç»ç†Ÿæ‚‰äº†æœ€åˆçš„è´¨æ§æ­¥éª¤ã€‚æˆ‘ä»¬å°†ä»ç”±cellrangerç”Ÿæˆçš„æ•°æ® x ç»†èƒè¿‡æ»¤çŸ©é˜µå¼€å§‹ï¼Œè¿™æ˜¯å¤§å¤šæ•°åˆ†æçš„å¸¸è§èµ·ç‚¹ã€‚</p>
<p>æˆ‘ä»¬å°†ä¸“æ³¨äºå•ç»†èƒRNAæµ‹åºåˆ†æçš„ä¸¤ä¸ªå…·ä½“å…³é”®ä»»åŠ¡ï¼šèšç±»å’Œå¯¹å·²è¯†åˆ«èšç±»çš„æ³¨é‡Šã€‚</p>
</section><section id="å®‰è£…åŒ…" class="level2"><h2 class="anchored" data-anchor-id="å®‰è£…åŒ…">å®‰è£…åŒ…</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Seurat"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hdf5r"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clustree"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BiocManager"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">BiocManager</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SingleR"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">BiocManager</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"celldex"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<p>åŠ è½½ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat">Seurat</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Attaching SeuratObject</code></pre>
</div>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/lazappi/clustree">clustree</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggraph</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/LTLA/SingleR">SingleR</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: SummarizedExperiment</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MatrixGenerics</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: matrixStats</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'matrixStats'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    count</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MatrixGenerics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:matrixStats':

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: GenomicRanges</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: stats4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: BiocGenerics</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'BiocGenerics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    combine, intersect, setdiff, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    IQR, mad, sd, var, xtabs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,
    table, tapply, union, unique, unsplit, which.max, which.min</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: S4Vectors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'S4Vectors'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    first, rename</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    expand.grid, I, unname</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: IRanges</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'IRanges'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    collapse, desc, slice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: GenomeInfoDb</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Biobase</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Biobase'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MatrixGenerics':

    rowMedians</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:matrixStats':

    anyMissing, rowMedians</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'SummarizedExperiment'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:SeuratObject':

    Assays</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Seurat':

    Assays</code></pre>
</div>
<div class="sourceCode" id="cb42" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;"><a href="https://github.com/LTLA/celldex">celldex</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'celldex'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:SingleR':

    BlueprintEncodeData, DatabaseImmuneCellExpressionData,
    HumanPrimaryCellAtlasData, ImmGenData, MonacoImmuneData,
    MouseRNAseqData, NovershternHematopoieticData</code></pre>
</div>
</div>
</section><section id="è¯»å…¥æ•°æ®é›†å¹¶åˆ›å»ºä¸€ä¸ª-seurat-å¯¹è±¡" class="level2"><h2 class="anchored" data-anchor-id="è¯»å…¥æ•°æ®é›†å¹¶åˆ›å»ºä¸€ä¸ª-seurat-å¯¹è±¡">è¯»å…¥æ•°æ®é›†å¹¶åˆ›å»ºä¸€ä¸ª Seurat å¯¹è±¡</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦è¯»å–10Xæµ‹åºæ•°æ®å¹¶å°†å…¶è½¬æ¢ä¸º Seurat å¯¹è±¡ã€‚Seurat å¯¹è±¡ä½œä¸ºä¸€ä¸ªå®¹å™¨ï¼Œæœ€åˆåªåŒ…å« UMI è®¡æ•°çŸ©é˜µã€‚ä½†æˆ‘ä»¬ä¼šå‘å…¶æ·»åŠ æ›´å¤šçš„åˆ†æå†…å®¹ï¼ˆä¾‹å¦‚PCAã€èšç±»ç»“æœï¼‰ã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆé€šè¿‡ä½¿ç”¨ <code>Read10X_h5</code> å‡½æ•°è¯»å–è®¡æ•°çŸ©é˜µï¼Œè¯¥å‡½æ•°ä»10X CellRanger hdf5æ–‡ä»¶ä¸­è¯»å–è®¡æ•°çŸ©é˜µã€‚å±‚æ¬¡æ•°æ®æ ¼å¼ï¼ˆHierarchical Data Formatï¼ŒHDF5æˆ–H5ï¼‰æä¾›äº†æ•°æ®çš„æ›´å‹ç¼©çš„è¡¨ç¤ºå½¢å¼ã€‚Seurat è½¯ä»¶åŒ…åŒ…å«å¤šä¸ªè¯»å–å‡½æ•°ï¼Œå…·ä½“å–å†³äºæ–‡ä»¶æ ¼å¼ã€‚</p>
<p>åœ¨è¯»å–æ•°æ®æ—¶ï¼Œæˆ‘ä»¬ä¼šåº”ç”¨åŸºæœ¬çš„è´¨é‡æ§åˆ¶ï¼Œå°†ä½è´¨é‡çš„ç»†èƒä¸¢å¼ƒã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb45" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc.data</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/Read10X_h5.html">Read10X_h5</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>filename<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/wsx/Library/CloudStorage/OneDrive-shanghaitech.edu.cn/Public/data/SC3_v3_NextGem_DI_PBMC_10K_filtered_feature_bc_matrix.h5"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/CreateSeuratObject.html">CreateSeuratObject</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>counts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc.data</span>, project <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pbmc10k"</span>, min.cells <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, min.features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"percent.mt"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/PercentageFeatureSet.html">PercentageFeatureSet</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, pattern <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^MT-"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, subset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nFeature_RNA</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nFeature_RNA</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">percent.mt</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¡ç®—çº¿ç²’ä½“RNAåœ¨æ€»RNAå«é‡ä¸­çš„ç™¾åˆ†æ¯”è´¡çŒ®ã€‚é«˜çº¿ç²’ä½“å«é‡å¯èƒ½è¡¨æ˜æ­£åœ¨ç»å†å‡‹äº¡çš„ä½è´¨é‡ç»†èƒã€‚æˆ‘ä»¬æ ¹æ®çº¿ç²’ä½“å«é‡å’Œæ¯ä¸ªç»†èƒç‰¹å¾æ•°çš„åˆ†å¸ƒå†æ¬¡è¿›è¡Œè´¨é‡æ§åˆ¶ã€‚ç‰¹å¾æ•°è¿‡ä½å¯èƒ½è¡¨æ˜ç©ºçš„æ¶²æ»´ä¸­å­˜åœ¨ç¯å¢ƒRNAæ±¡æŸ“ã€‚ç‰¹å¾æ•°è¿‡é«˜å¯èƒ½æ˜¯ç”±äºå¤šä¸ªç»†èƒè¢«å›°åœ¨åŒä¸€ä¸ªæ¶²æ»´ä¸­å¼•èµ·çš„ã€‚</p>
</section><section id="æ•°æ®å¤„ç†" class="level2"><h2 class="anchored" data-anchor-id="æ•°æ®å¤„ç†">æ•°æ®å¤„ç†</h2>
<p>ç»è¿‡è´¨é‡æ§åˆ¶æªæ–½ä»¥é€‰æ‹©ç»§ç»­åˆ†æçš„ç»†èƒåï¼Œæ¥ä¸‹æ¥çš„æ­¥éª¤åŒ…æ‹¬å¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ–ã€è¯†åˆ«é«˜åº¦å¯å˜ç‰¹å¾ä»¥åŠè¿›è¡Œå°ºåº¦ç¼©æ”¾ã€‚åŒæ—¶ï¼Œè¿˜ä¼šè¿›è¡Œä¸»æˆåˆ†åˆ†æï¼Œå› ä¸ºè®¸å¤šåç»­åˆ†ææ­¥éª¤å°†åœ¨è¾ƒä½ç»´åº¦ç©ºé—´ä¸­è¿›è¡Œè®¡ç®—ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb46" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/NormalizeData.html">NormalizeData</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html">FindVariableFeatures</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, selection.method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vst"</span>, nfeatures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all.genes</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/ScaleData.html">ScaleData</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all.genes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Centering and scaling data matrix</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb48" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/RunPCA.html">RunPCA</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>å‰é¢æ‰€æœ‰æ­¥éª¤çš„åŸºæœ¬åŸç†éƒ½ä¸è´¨é‡æ§åˆ¶ç›¸å…³ï¼Œåœ¨å‰é¢çš„æ•™ç¨‹ä¸­æœ‰æ›´è¯¦ç»†çš„ä»‹ç»ã€‚</p>
</section><section id="é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡" class="level2"><h2 class="anchored" data-anchor-id="é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡">é€‰æ‹©ä¸»æˆåˆ†çš„æ•°é‡</h2>
<p>é¦–è¦çš„é‡è¦å†³ç­–æ˜¯åœ¨åç»­åˆ†æä¸­ä¿ç•™å¤šå°‘ä¸ªä¸»æˆåˆ†ï¼ˆPCsï¼‰ã€‚ä¿ç•™çš„ä¸»æˆåˆ†è¶Šå¤šï¼Œä¿¡å·é‡ä¹Ÿä¼šå¢åŠ ï¼Œä½†åŒæ—¶ä¹Ÿä¼šå¢åŠ å™ªéŸ³ï¼Œå¹¶ä¸”è®¡ç®—éœ€æ±‚ä¹Ÿä¼šå¢åŠ ã€‚åœ¨åšå‡ºè¿™ä¸ªé€‰æ‹©ä¹‹å‰ï¼Œè¯·æ£€æŸ¥ä¸æ¯ä¸ªä¸»æˆåˆ†ç›¸å…³çš„åŸºå› ã€‚å­˜åœ¨ä¸ç‰¹å®šç»†èƒç±»å‹ç›¸å…³çš„åŸºå› å°†è¡¨æ˜è¯¥ä¸»æˆåˆ†å…·æœ‰ä¿¡æ¯é‡ã€‚è€Œå­˜åœ¨ä¸æ‰€æœ‰ä¸ç›¸å…³åŸºå› åç§°ç›¸å…³çš„æƒ…å†µåˆ™è¡¨æ˜ç›¸åã€‚åœ¨å¤–å‘¨è¡€å•ä¸ªæ ¸ç»†èƒï¼ˆPBMCï¼‰çš„èƒŒæ™¯ä¸‹ï¼Œæˆ‘ä»¬é¢„æœŸä¸»è¦çš„ç»†èƒç±»å‹å°†åŒ…æ‹¬Tç»†èƒã€Bç»†èƒã€NKç»†èƒã€å•æ ¸ç»†èƒç­‰ç­‰ã€‚</p>
<p>æ£€æŸ¥å‰ 10 ä¸ª PCï¼Œä½ ä¼šçœ‹åˆ°å¾ˆå¤šç†Ÿæ‚‰çš„åŸºå› åç§°ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb49" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, nfeatures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PC_ 1 
Positive:  LTB, IL32, TRAC, CD3D, TRBC2 
Negative:  FCN1, FGL2, CST3, IFI30, TYMP 
PC_ 2 
Positive:  MS4A1, CD79A, BANK1, IGHM, NIBAN3 
Negative:  IL32, GZMM, CD3D, CD7, CD247 
PC_ 3 
Positive:  GZMB, CLIC3, NKG7, GNLY, KLRD1 
Negative:  CCR7, LEF1, TRABD2A, TCF7, LTB 
PC_ 4 
Positive:  CD79B, MS4A1, GNLY, CD79A, LINC00926 
Negative:  LILRA4, CLEC4C, SERPINF1, TPM2, SCT 
PC_ 5 
Positive:  CDKN1C, HES4, CTSL, TCF7L2, BATF3 
Negative:  S100A12, ITGAM, VCAN, CES1, MGST1 
PC_ 6 
Positive:  CDKN1C, NRGN, PADI4, CKB, FCGR3A 
Negative:  CRIP1, GBP5, ISG15, NIBAN1, MAF 
PC_ 7 
Positive:  CLU, ITGB1, NRGN, LIMS1, GP1BB 
Negative:  MALAT1, CCR7, TXK, LINC02446, KLRK1 
PC_ 8 
Positive:  CDKN1C, VIM, S100A4, CKB, ITGB1 
Negative:  MAP3K7CL, SERPING1, GMPR, LGALS2, NEXN 
PC_ 9 
Positive:  HERC5, IFIT1, RSAD2, IFIT3, MX1 
Negative:  CLEC10A, FCER1A, ENHO, CD1C, CACNA2D3 
PC_ 10 
Positive:  TNFRSF13B, IGHG1, IGHA1, SSPN, IGFBP7 
Negative:  TCL1A, CD8A, TRGC2, GZMK, CD8B </code></pre>
</div>
</div>
<p>å¦ä¸€ç§å¯è§†åŒ–ä¿¡æ¯çš„æ–¹æ³•æ˜¯ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb51" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VizDimLoadings.html">VizDimLoadings</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, reduction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span>,balanced<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>è¿™æ˜¯å¦ä¸€ç§æä¾›å›¾ç¤ºè¡¨ç¤ºçš„æ–¹æ³•ã€‚ç»†èƒå’Œç‰¹å¾æ ¹æ®ä¸»æˆåˆ†åˆ†æå¾—åˆ†è¿›è¡Œæ’åºã€‚è®¾ç½®ä¸€ä¸ªç»†èƒæ•°é‡æœ‰åŠ©äºè®¡ç®—æ•ˆç‡ï¼Œå› ä¸ºå®ƒä¼šå¿½ç•¥é‚£äº›ä¿¡æ¯è¾ƒå°‘çš„æç«¯ç»†èƒã€‚å¼ºåˆ¶ä½¿å…¶å¹³è¡¡å¯åœ¨æ­£ç›¸å…³å’Œè´Ÿç›¸å…³ä¹‹é—´è·å¾—ç›¸ç­‰çš„è¡¨ç¤ºã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb52" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimHeatmap.html">DimHeatmap</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, cells <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, balanced <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb53" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimHeatmap.html">DimHeatmap</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, cells <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, balanced <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Jackstraw å›¾ç”¨äºä¼°è®¡æ¯ä¸ªä¸»æˆåˆ†æ‰€æ•è·çš„ç»“æ„çš„æ˜¾è‘—æ€§ã€‚å®ƒä¼šéšæœºå¯¹æ•°æ®çš„å­é›†è¿›è¡Œæ’åˆ—ï¼Œä»¥å»ºç«‹ç©ºå€¼åˆ†å¸ƒï¼Œå¹¶æ ¹æ®è¿™ä¸ªç©ºå€¼åˆ†å¸ƒä¼°è®¡på€¼ã€‚</p>
<p>âš ï¸ è¿™å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´æ¥æ‰§è¡Œã€‚å¦‚æœæ—¶é—´ä¸å¤Ÿï¼Œè¯·è·³è¿‡è¿™éƒ¨åˆ†ï¼Œç„¶ååªä¸“æ³¨äºæ¥ä¸‹æ¥çš„æ‹ç‚¹å›¾ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb54" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/JackStraw.html">JackStraw</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, num.replicate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/ScoreJackStraw.html">ScoreJackStraw</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/JackStrawPlot.html">JackStrawPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 28000 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>æ‹ç‚¹å›¾æ˜¯ç»å…¸çš„è®¡ç®—æœºç§‘å­¦æ–¹æ³•ï¼Œç”¨äºæ£€æŸ¥é€šè¿‡é€ä¸ªæ·»åŠ ä¸»æˆåˆ†æ¥è¡¨ç¤ºæ•°æ®ä¸­ç´¯ç§¯å˜å¼‚æ€§ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb56" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/ElbowPlot.html">ElbowPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>,ndims<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>æ ¹æ®è¿™äº›å›¾ï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨20ä¸ªä¸»æˆåˆ†ã€‚ä½†ä¹Ÿå¯ä»¥ä¸º15åˆ°30ä¹‹é—´çš„ä»»ä½•æ•°é‡æå‡ºç†ç”±ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨UMAPæ¥å¯è§†åŒ–æ•°æ®é›†ã€‚æˆ‘ä»¬æå‰è®¡ç®—UMAPï¼Œä»¥ä¾¿åœ¨éœ€è¦æ—¶ç«‹å³ä½¿ç”¨ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb57" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/RunUMAP.html">RunUMAP</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, verbose <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric
To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'
This message will be shown once per session</code></pre>
</div>
</div>
</section><section id="èšç±»" class="level2"><h2 class="anchored" data-anchor-id="èšç±»">èšç±»</h2>
<p>Seuraté»˜è®¤çš„èšç±»ç®—æ³•é‡‡ç”¨åŸºäºå›¾çš„èšç±»æ–¹æ³•ã€‚å®ƒå—åˆ°ä»¥å‰çš„å‘è¡¨æ–‡ç« çš„å¯å‘ï¼Œè¿™äº›æ–‡ç« åœ¨å¼€å‘å’Œæ”¹è¿›è¿™ç§æ–¹æ³•æ–¹é¢åšå‡ºäº†è´¡çŒ®ã€‚ç‰¹åˆ«æ˜¯ï¼Œ<a href="http://www.ncbi.nlm.nih.gov/pubmed/26095251">ã€ŠPhenographã€‹è®ºæ–‡</a>å¼ºçƒˆæ¨èç»™é‚£äº›å¸Œæœ›æ›´å¥½åœ°ç†è§£è¿™ç§æ–¹æ³•çš„äººã€‚ç®€è¦æ¥è¯´ï¼Œèšç±»ç®—æ³•é¦–å…ˆåœ¨PCAç©ºé—´ä¸­è®¡ç®—æ¯ä¸ªç»†èƒçš„Kä¸ªæœ€è¿‘é‚»ã€‚ç„¶åï¼Œæ ¹æ®å…±äº«é‚»å±…è®¡ç®—ç»†èƒä¹‹é—´çš„Jaccardç›¸ä¼¼æ€§ã€‚ä½¿ç”¨Louvainç®—æ³•å¯¹ä¿¡æ¯è¿›è¡Œèšåˆï¼Œä»¥ä¾¿å°†ç»†èƒè¿­ä»£åœ°åˆ†ç»„åœ¨ä¸€èµ·ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb59" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html">FindNeighbors</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Computing nearest neighbor graph</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Computing SNN</code></pre>
</div>
</div>
<p>ç¬¬äºŒä¸ªé‡è¦çš„å†³ç­–æ˜¯é€‰æ‹©èšç±»çš„åˆ†è¾¨ç‡ã€‚è¾ƒå°çš„æ•°å€¼ä¼šç”Ÿæˆæ··åˆçš„èšç±»ï¼Œè€Œè¾ƒå¤§çš„æ•°å€¼ä¼šäº§ç”Ÿè¿‡å¤šçš„èšç±»ï¼Œè¿™äº›èšç±»å¯èƒ½ä¸å¤ªå…·æœ‰æ„ä¹‰ã€‚</p>
<p>ğŸ“ å¯¹äºä½ è‡ªå·±çš„ç ”ç©¶ï¼ŒèŠ±ä¸€äº›æ—¶é—´æ¥ä¼˜åŒ–åˆ†è¾¨ç‡çš„é€‰æ‹©æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚å°è¯•ä½¿ç”¨å¤šä¸ªå€™é€‰çš„åˆ†è¾¨ç‡é€‰é¡¹æ¥è¿›è¡Œæ‰€æœ‰åç»­åˆ†æå¯èƒ½ä¼šæœ‰å¸®åŠ©ã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°è¯•ä¸‰ä¸ªä¸åŒçš„åˆ†è¾¨ç‡å€¼ï¼Œå¹¶ä½¿ç”¨clustreeæ¥ç ”ç©¶å…¶å½±å“ã€‚åœ¨è®¡ç®—å®Œèšç±»åï¼Œæˆ‘ä»¬è¿˜ä¿å­˜äº†pbmcå¯¹è±¡ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb62" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindClusters.html">FindClusters</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>object <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>,  resolution <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>,  dims.use <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,  save.SNN <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following arguments are not used: dims.use, save.SNN</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Suggested parameter: dims instead of dims.use</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following arguments are not used: dims.use, save.SNN</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Suggested parameter: dims instead of dims.use</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck

Number of nodes: 9729
Number of edges: 356102

Running Louvain algorithm...
Maximum modularity in 10 random starts: 0.9145
Number of communities: 16
Elapsed time: 1 seconds
Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck

Number of nodes: 9729
Number of edges: 356102

Running Louvain algorithm...
Maximum modularity in 10 random starts: 0.8655
Number of communities: 20
Elapsed time: 1 seconds
Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck

Number of nodes: 9729
Number of edges: 356102

Running Louvain algorithm...
Maximum modularity in 10 random starts: 0.8279
Number of communities: 22
Elapsed time: 1 seconds</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb68" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/wsx/Library/CloudStorage/OneDrive-shanghaitech.edu.cn/Public/data/pbmc_tutorial.rds"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/clustree/man/clustree.html">clustree</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>è¿™ä¸‰è¡Œè¡¨ç¤ºæ¯ä¸ªåˆ†è¾¨ç‡å€¼ä¸‹çš„ç»†èƒåˆ†é…æƒ…å†µã€‚æ¯è¡Œä¸­çš„èŠ‚ç‚¹å¤§å°è¡¨ç¤ºè¯¥èšç±»ä¸­çš„ç»†èƒæ•°é‡ã€‚è¡Œä¹‹é—´çš„ç®­å¤´æ˜¾ç¤ºéšç€åˆ†è¾¨ç‡çš„å¢åŠ ï¼Œèšç±»çš„åˆ†é…æƒ…å†µå¦‚ä½•å˜åŒ–ã€‚ç¨³å®šçš„èšç±»å¯èƒ½ä¼šæ›´æ”¹åç§°ï¼Œä½†æ˜¯ç»†èƒåœ¨ä¸åŒçš„åˆ†è¾¨ç‡ä¸‹ä»ç„¶ä¼šèšé›†åœ¨ä¸€èµ·ã€‚ä¸€äº›èšç±»å¯èƒ½ä¼šåˆ†è£‚æˆä¸¤ä¸ªï¼ˆæˆ–æ›´å¤šï¼‰å­èšç±»ã€‚è¿™æš—ç¤ºç€å¢åŠ åˆ†è¾¨ç‡ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ çœ‹åˆ°èšç±»ä¹‹é—´æ¥å›è·³åŠ¨çš„æƒ…å†µå¾ˆå¤šï¼Œé‚£å°±è¡¨ç¤ºç¨³å®šæ€§è¾ƒå·®ã€‚åœ¨ä½ è‡ªå·±çš„æ•°æ®ä¸­ï¼Œæœ€å¥½è¿›è¡Œè¿‡åº¦èšç±»ï¼Œç„¶åæ£€æŸ¥åŸºå› ï¼Œç„¶åæ‰‹åŠ¨é€‰æ‹©è¦åˆå¹¶çš„èšç±»ã€‚</p>
<p>æˆ‘ä»¬é€‰æ‹©åˆ†è¾¨ç‡=0.5è¿›è¡Œè¿›ä¸€æ­¥æ£€æŸ¥ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb69" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html">Idents</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RNA_snn_res.0.5</span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DimPlot.html">DimPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, reduction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"umap"</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="èšç±»å¯Œé›†æ ‡è®°" class="level2"><h2 class="anchored" data-anchor-id="èšç±»å¯Œé›†æ ‡è®°">èšç±»å¯Œé›†æ ‡è®°</h2>
<p>æ¥ä¸‹æ¥ï¼Œå¯¹äºæ¯ä¸ªèšç±»ï¼Œæˆ‘ä»¬æƒ³è¦æ£€æŸ¥åœ¨è¯¥èšç±»ä¸­ç›¸æ¯”å…¶ä»–ç»†èƒé«˜åº¦è¡¨è¾¾çš„ç‰¹å¾ï¼ˆä¹Ÿç§°ä¸ºæ ‡è®°æˆ–åŸºå› ï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨â€™rocâ€™æ–¹æ³•æ¥ä¼°è®¡æ¯ä¸ªæ ‡è®°çš„åˆ†ç±»èƒ½åŠ›ï¼ˆ0è¡¨ç¤ºéšæœºï¼Œ1è¡¨ç¤ºå®Œç¾ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€ä¸ªèšç±»åœ°è¿›è¡Œè¿™ä¸ªåˆ†æï¼Œä¹Ÿå¯ä»¥åŒæ—¶å¯¹æ‰€æœ‰èšç±»è¿›è¡Œåˆ†æã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb70" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cluster0.markers</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindMarkers.html">FindMarkers</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, ident.1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, logfc.threshold <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, test.use <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"roc"</span>, only.pos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>âš ï¸ å¯¹æ‰€æœ‰èšç±»æ‰§è¡Œæ­¤æ“ä½œéå¸¸è€—æ—¶ã€‚å¦‚æœä½ æƒ³ä¼‘æ¯ä¸€ä¸‹ã€‚åœ¨è¿™æ ·åšä¹‹å‰å¯åŠ¨å®ƒã€‚è®¡ç®—æ—¶é—´å¯èƒ½é•¿è¾¾30åˆ†é’Ÿã€‚å¦‚æœä½ åœ¨æ•™ç¨‹æ—¶é—´æ–¹é¢è¿è¡Œæ™šäº†ï¼Œç°åœ¨è·³è¿‡è¿™ä¸ªå’Œä¸‹é¢çš„çƒ­å›¾ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb71" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cluster.all.markers0.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FindAllMarkers.html">FindAllMarkers</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, logfc.threshold <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, test.use <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"roc"</span>, only.pos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, min.pct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 6</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 8</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 9</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 10</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 13</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 14</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating cluster 15</code></pre>
</div>
</div>
<p>çƒ­å›¾ä¸ºå…±äº«é«˜åº¦è¡¨è¾¾æ ‡è®°çš„é›†ç¾¤æä¾›äº†å¾ˆå¥½çš„å›¾å½¢è¡¨ç¤ºã€‚æ³¨æ„åˆ°umapä¸­è¿™äº›é›†ç¾¤ä¹‹é—´çš„å…³ç³»äº†å—?</p>
<div class="cell">
<div class="sourceCode" id="cb88" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cluster.all.markers0.5</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cluster</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, wt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">avg_log2FC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">top5</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DoHeatmap.html">DoHeatmap</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">top5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gene</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html">NoLegend</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸€äº›æ ‡è®°ï¼Œè¿™äº›æ ‡è®°å¾€å¾€é€‚ç”¨äºPBMCæ•°æ®é›†ã€‚å…¶ä¸­è®¸å¤šæ¥è‡ª<code>cluster.all.markers0.5</code>ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb89" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">markers.to.plot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD3D"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HSPH1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SELL"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD14"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LYZ"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GIMAP5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CACYBP"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GNLY"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NKG7"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CCL5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD8A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MS4A1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD79A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FCGR3A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MS4A7"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S100A9"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HLA-DQA1"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GPR183"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PPBP"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GNG11"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TSPAN13"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IL3RA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FCER1A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CST3"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S100A12"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/DotPlot.html">DotPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">markers.to.plot</span>, cols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, dot.scale <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html">RotatedAxis</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb90" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MS4A1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD79A"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb91" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NKG7"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GNLY"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb92" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FCGR3A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MS4A7"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb93" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PPBP"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-19-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb94" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FCER1A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CST3"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>   </span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-19-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb95" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/VlnPlot.html">VlnPlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD8A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD8B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD3D"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-19-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb96" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://satijalab.org/seurat/reference/FeaturePlot.html">FeaturePlot</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, features <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MS4A1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GNLY"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD3E"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD14"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FCER1A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FCGR3A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LYZ"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PPBP"</span>,  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CD8A"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="åŸºäºå‚è€ƒçš„èšç±»æ³¨é‡Š" class="level2"><h2 class="anchored" data-anchor-id="åŸºäºå‚è€ƒçš„èšç±»æ³¨é‡Š">åŸºäºå‚è€ƒçš„èšç±»æ³¨é‡Š</h2>
<p>åŸºäºå‚è€ƒæ•°æ®çš„èšç±»æ³¨é‡Šä¸åœ¨Seuratè½¯ä»¶åŒ…ä¸­è¿›è¡Œã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨SingleRï¼Œå¹¶é¦–å…ˆå°†Seuratæ•°æ®çš„ä¿¡æ¯è½¬æ¢ä¸ºSingleRçš„æ ¼å¼ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb97" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sce</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/AssayData.html">GetAssayData</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>object <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span>, assay <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RNA"</span>, slot <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</div>
<p>æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ç¯‡<a href="https://pubmed.ncbi.nlm.nih.gov/30726743/">ç»å…¸è®ºæ–‡</a>ä¸­çš„æ•°æ®ï¼Œè¯¥è®ºæ–‡ä½¿ç”¨åˆ†ç±»ç»†èƒå¯¹ä¸åŒçš„å…ç–«ç»†èƒç±»å‹è¿›è¡Œäº†æ¯”è¾ƒã€‚åŸºäºå‚è€ƒæ•°æ®çš„æ³¨é‡Šå…è®¸ä¸é«˜åº¦ç²¾é€‰çš„æ•°æ®é›†è¿›è¡Œç›´æ¥æ¯”è¾ƒã€‚ç„¶è€Œï¼Œç¼ºç‚¹æ˜¯æ¨æ–­çš„ç»“æœå–å†³äºå‚è€ƒæ•°æ®é›†ä¸­å®šä¹‰çš„å†…å®¹ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb98" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">refMonaco</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/celldex/man/MonacoImmuneData.html">MonacoImmuneData</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>snapshotDate(): 2022-10-31</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>see ?celldex and browseVignettes('celldex') for documentation</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>loading from cache</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>see ?celldex and browseVignettes('celldex') for documentation</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>loading from cache</code></pre>
</div>
</div>
<p>æ•°æ®æ ¼å¼åœ¨ä¸¤ä¸ªå±‚æ¬¡ä¸Šæ˜¾ç¤ºä¿¡æ¯:ä¸»è¦ç»†èƒç±»å‹å’Œæ›´ç²¾ç»†çš„åˆ†è¾¨ç‡ä¿¡æ¯ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb104" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prediction_Monaco_main</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/SingleR/man/SingleR.html">SingleR</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>test<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sce</span>, ref<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">refMonaco</span>, clusters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html">Idents</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">refMonaco</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">label.main</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prediction_Monaco_fine</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/pkg/SingleR/man/SingleR.html">SingleR</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>test<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sce</span>, ref<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">refMonaco</span>, clusters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html">Idents</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">refMonaco</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">label.fine</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">predicted_Monaco</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>cluster<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html">Idents</a></span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pbmc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>, Monaco_main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prediction_Monaco_main</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">labels</span>, Monaco_fine<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prediction_Monaco_fine</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">labels</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">predicted_Monaco</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   cluster     Monaco_main                  Monaco_fine
1        0       Monocytes          Classical monocytes
2        1    CD4+ T cells            Naive CD4 T cells
3        2       Monocytes          Classical monocytes
4        3    CD8+ T cells            Naive CD8 T cells
5        4    CD4+ T cells               Th1/Th17 cells
6        5         T cells           Non-Vd2 gd T cells
7        6         B cells  Non-switched memory B cells
8        7         B cells                Naive B cells
9        8        NK cells         Natural killer cells
10       9       Monocytes       Intermediate monocytes
11      10         T cells                   MAIT cells
12      11 Dendritic cells      Myeloid dendritic cells
13      12 Dendritic cells Plasmacytoid dendritic cells
14      13       Monocytes          Classical monocytes
15      14     Progenitors             Progenitor cells
16      15         B cells                 Plasmablasts</code></pre>
</div>
</div>


</section> ]]></description>
  <category>note</category>
  <category>scRNA-seq</category>
  <category>R</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-26-clustering-and-cell-type-identification/index.html</guid>
  <pubDate>Tue, 25 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>å°è®°ï¼ˆå¾€æ˜”ï¼‰</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-25-small-notes/index.html</link>
  <description><![CDATA[ 




<p>ä»¥æ—¶é—´å€’åºçš„å½¢å¼å¤‡ä»½ä¸‹ã€Œå°è®°ã€ä¸­å†™çš„éƒ¨åˆ†è¯—ã€‚</p>
<section id="è´ºå¦»å°è®°" class="level3">
<h3 class="anchored" data-anchor-id="è´ºå¦»å°è®°">è´ºå¦»å°è®°</h3>
<p>å±±æ°´åœ¨å›å“ä½ çš„ç”Ÿè¾°ï¼Œ</p>
<p>æˆ‘ä»ä¸­çª¥æ¢ç”Ÿå‘½çš„å°è®°ã€‚</p>
<p>ç¼˜æ¥äº†â€”â€”</p>
<p>æˆ‘ä½œäº­äº­å¤æ—¥çš„è²ï¼Œ</p>
<p>ä½ ä½œå¾®é£ï¼Œ</p>
<p>è¡å¼€æˆ‘æ¹–å¿ƒã€‚</p>
</section>
<section id="å†™äºäºŒåä¹" class="level3">
<h3 class="anchored" data-anchor-id="å†™äºäºŒåä¹">å†™äºäºŒåä¹</h3>
<p>å®å²æ·»ä¹è™šæ·»åï¼Œ</p>
<p>å·²æœ›å¤©å‘½ç˜¦è‚šè¿Ÿã€‚</p>
<p>å¤©å—åœ°åŒ—ç»ˆé¡»å°½ï¼Œ</p>
<p>äººåˆ°æ¡¥å¤´æœ‰è¯€æœŸã€‚</p>
</section>
<section id="æ— é¢˜" class="level3">
<h3 class="anchored" data-anchor-id="æ— é¢˜">æ— é¢˜</h3>
<p>ç¿ ç»¿å å¢¨è‰²ï¼Œ</p>
<p>çƒŸæŸ³å…¥æ±Ÿæ³¢ã€‚</p>
<p>æ’æ°´ç¢§ç©ºå°½ï¼Œ</p>
<p>æ¨äº‘çœºå±±éƒ­ã€‚</p>
</section>
<section id="æ— é¢˜-1" class="level3">
<h3 class="anchored" data-anchor-id="æ— é¢˜-1">æ— é¢˜</h3>
<p>é›¨éª¤é£è§å¤©æ˜“å†·ï¼Œ</p>
<p>å¯’æ¨æ¼çª—å¤œæ¶é—¨ã€‚</p>
<p>é¸Ÿå«è¿Ÿèµ·éš¾è¡Œæ—©ï¼Œ</p>
<p>ä¸–äº‹æƒ…åŠ«éš¾åº¦æˆã€‚</p>
</section>
<section id="å…«æœˆåå››ä¸å¦»ç™»ç™½äº‘å±±" class="level3">
<h3 class="anchored" data-anchor-id="å…«æœˆåå››ä¸å¦»ç™»ç™½äº‘å±±">å…«æœˆåå››ä¸å¦»ç™»ç™½äº‘å±±</h3>
<p>å±±æ—æ—¥æ›³é‡‘æ˜ç­ï¼Œ</p>
<p>ä¹”æœ¨æ·±æ·±æ¾æ¶§å ã€‚</p>
<p>æ™šèµ·ä¸Šç™½äº‘ï¼Œ</p>
<p>åŒåŒæ±—æ°´æ·‹ã€‚</p>
<p>æ¥æ—¶äº‘é®æœˆï¼Œ</p>
<p>å»æ—¶æœˆåŠ¨äººã€‚</p>
<p>æ¸…é£é¢‘ç›¸é€ï¼Œ</p>
<p>äººæœˆäº†æ— ç—•ã€‚</p>
</section>
<section id="äºŒæœˆ" class="level3">
<h3 class="anchored" data-anchor-id="äºŒæœˆ">äºŒæœˆ</h3>
<p>äººé“æ±Ÿå—å¥½é¢œè‰²ï¼Œ</p>
<p>å†·é£å¹èµ·äº®æ˜¥æ³½ã€‚</p>
<p>è¿‘è§‚ç²‰èŠ±æ©åŠç»¿ï¼Œ</p>
<p>è¿œçœºä¹Œæ³¢é©»é«˜æ¥¼ã€‚</p>
<p>éª‘è¡Œé¢‘é—»é¸£ç¿ æŸ³ï¼Œ</p>
<p>æ¸¸æ€å¶å¾—å£®å¹´æ„ã€‚</p>
<p>æ„¿æ­¤äººé—´å¤šæ¬¢ä¹ï¼Œ</p>
<p>ç¬‘å£°å½’å¤„äº†ç™½å¤´ã€‚</p>


</section>

 ]]></description>
  <category>è¯—</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-25-small-notes/index.html</guid>
  <pubDate>Mon, 24 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-07-25</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-25-journal/index.html</link>
  <description><![CDATA[ 




<p>ä¸ºä»€ä¹ˆäº‹æƒ…å®¹æ˜“å †ç§¯åœ¨ä¸€èµ·å‘ç”Ÿï¼Ÿ</p>
<p>ä¸ºä»€ä¹ˆè¶Šå¿™çš„æ—¶å€™è¶Šä¸æƒ³å¿™ï¼Ÿå¿™çš„æ—¶å€™è¶Šå®¹æ˜“åˆ†æ•£ç²¾åŠ›ï¼Ÿ</p>
<p>è¿™æ˜¯äººç±»çš„ä»€ä¹ˆå¿ƒç†å‘¢ï¼Ÿ</p>
<p>é‚£äº›å…ˆåœ£å…ˆè´¤ä»¬ç©¶ç«Ÿæ˜¯å¦‚ä½•å¡‘é€ çš„å‘¢ï¼Ÿ</p>
<p>æ˜¯ä»€ä¹ˆåœ¨å‹æŠ‘ç€æ€æ½®ï¼Œæ¶æ‰“ç€è‡ªä¿¡ï¼Ÿ</p>
<p>æ€æ ·æ‰èƒ½æŠŠæƒ³åšçš„çœŸæ­£åšå¥½ï¼Ÿä¸å…³æ³¨åˆ«äººï¼Ÿå¤šå…³æ³¨åˆ«äººï¼Ÿ</p>
<p>å“ªé‡Œæ˜¯æ™ºæ…§çš„çœŸè°›ï¼Œç”Ÿå‘½çš„å¦™é—¨ï¼Ÿ</p>



 ]]></description>
  <category>journal</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-25-journal/index.html</guid>
  <pubDate>Mon, 24 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>å­¦æœ¯çš„ä»·å€¼è§‚</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-21-academic-culture/index.html</link>
  <description><![CDATA[ 




<p>è¿™ç¯‡å°æ–‡ä¸»è¦æ˜¯è®°å½•ã€æ¨èå’Œåˆ†äº«ä¸‹å´æ€æ¶µ Lab çš„ç§‘å­¦ä»·å€¼è§‚æ¡ç›®ã€‚</p>
<p><img src="https://shixiangwang.github.io/posts/2023-07-21-academic-culture/wulab_culture.jpg" class="img-fluid"></p>
<p>æˆ‘è§‰å¾—éå¸¸å¥½ï¼Œä¹Ÿéå¸¸ä½©æœå´æ€æ¶µåˆ›å»ºè¿™ä¸ªæ¡ç›®å’Œå¯¹æ¯ä¸ªè¿›å…¥ Lab çš„æˆå‘˜è¿›è¡Œå®£è¯»ã€‚</p>
<p>æœ‰æ—¶å€™ï¼Œç§‘ç ”å·¥ä½œçš„ç¯å¢ƒçš„å–§åš£è®©äººç…ç†¬ã€‚åœ¨å¿ƒä¸­æ‚¬ç€ä¸€æŠŠä»·å€¼ä¹‹å‰‘ğŸ—¡ï¸ï¼Œæˆ‘è§‰å¾—æ—¢æ˜¯å‘Šè¯«ï¼Œä¹Ÿæ˜¯æŒ‡å¼•ã€‚ è¿™æŠŠå‰‘æœ‰ç¦»å¾—è¿‘å’Œç¦»å¾—è¿œçš„æ—¶å€™ï¼Œä½†å¦‚æœæ²¡æœ‰å®ƒï¼Œæˆ‘ä»¬çš„å¿ƒä¸­ä¼šç¼ºä¹ç»ˆæç›®æ ‡ğŸ¯ã€‚ ç§‘å­¦çš„è·¯ï¼Œæ˜¯æ°¸æ— æ­¢å¢ƒçš„ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨å¯»è§…ã€æŒ£æ‰ã€æˆé•¿ï¼Œä¹Ÿå¼¯å¼¯æ›²æ›²åœ°èµ°å‘å²æœˆé•¿æ²³çš„ä¸‹ä¸€æ­¥ï¼Œ ä½†æ˜¯å¦åœ¨å‰è¿›ã€æ˜¯å¦åœ¨åé€€ï¼Œæ˜¯å¦èƒ½æ°¸è¿œå‰è¿›ã€æ˜¯å¦ä¼šæ°¸è¿œåé€€ï¼ŒçœŸçš„ä¸çŸ¥é“ã€‚</p>
<p>å½“å‰ï¼Œå…¨å›½è¿›å…¥äº†â€œå·â€æ—¶ä»£ï¼Œrespect science value, keep deep thinkã€‚</p>



 ]]></description>
  <category>academic</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-21-academic-culture/index.html</guid>
  <pubDate>Thu, 20 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>ä½ è®¤åŒç”Ÿç‰©ä¿¡æ¯å­¦ä¸å±äºç§‘å­¦å—ï¼Ÿ</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-21-how-do-you-think-bioinformatics-in-science/index.html</link>
  <description><![CDATA[ 




<p><img src="https://shixiangwang.github.io/posts/2023-07-21-how-do-you-think-bioinformatics-in-science/snapshot_of_gu_twitter.jpg" class="img-fluid"></p>
<p>åˆšçœ‹åˆ° Zuguang Gu å‘çš„æ¨æ–‡ï¼Œå””ï¼Œå›½å†…ç”Ÿç‰©å­¦æœ¯ç•Œæœ‰è¿™ç§çœ‹æ³•æˆ‘æ˜¯ç”Ÿæ°”çš„ï¼Œå¹¶è®¤ä¸ºå¯è€»ã€‚ å› ä¸ºè¿™é‡Œçš„æŸä¸ªç ”ç©¶æœºæ„åœ¨æ”¶åˆ°æ±‚èŒä¿¡æ—¶ï¼Œéƒ½æ²¡æœ‰äº†è§£è¿‡è¿™ä¸ªé¢†åŸŸå’Œå®ƒçš„è´¡çŒ®å°±å¦„ä¸‹è¯„åˆ¤ã€‚ è¿™ä½“ç°ä¸€ç§è‡ªå‚²ä¸æ— çŸ¥ã€‚å°±æ²¡æœ‰æƒ³è¿‡ä¸–ç•Œå­˜åœ¨å³æœ‰ç†ç”±å—ï¼Ÿè¯„ä¼°å­¦æœ¯æ±‚èŒè€…è€ƒè™‘çš„ä¸åº”è¯¥æ˜¯ å­¦ç§‘å»ºè®¾çš„å¥‘åˆåº¦ï¼Œæ±‚èŒäººçš„ç§‘ç ”æ€åº¦ã€ç»å†ã€æˆæœå—ï¼Ÿ</p>
<p>å¦‚æœå¯¹æŠ€æœ¯çš„åŸºç¡€æ¢ç´¢ä¸å±äºç§‘å­¦èŒƒç•´ï¼Œé‚£å½“å‰çƒ­é—¨æ”¹é€ ä¸–ç•Œçš„ä¼Ÿå¤§æŠ€æœ¯ï¼Œæ¯”å¦‚CRISPRï¼Œé‚£äº›ç ”ç©¶ã€ä¼˜åŒ–å’Œåˆ©ç”¨å®ƒçš„äººæ˜¯ä¸æ˜¯ä¹Ÿéƒ½ä¸æ˜¯åœ¨åšç§‘å­¦å‘¢ï¼ŸğŸ˜„</p>
<p>é‚£äº›åœ¨å®éªŒå®¤æ¬ç –çš„æ‰“å·¥äººï¼Œé‚£äº›åœ¨æè›‹ç™½çš„ç»“æ„ç”Ÿç‰©å­¦ç ”ç©¶ç”Ÿï¼Œé‚£äº›å°†è¢«æŠ€æœ¯/æœºå™¨å–ä»£çš„ç§‘ç ”å²—ä½ï¼Œä»–ä»¬éƒ½ä¸å±äºç§‘ç ”å—ï¼Ÿ</p>
<p>å­¦æœ¯ï¼Œæ°¸è¿œæ˜¯å¯¹çŸ¥è¯†å’Œåˆ›æ–°æ— ç©·æ¢ç´¢çš„è´¡çŒ®ï¼Œè€Œæ— å…³æ–¹å¼ã€‚</p>
<p>æˆ‘å…¶å®æ„ˆåŠ è®¤è¯†åˆ°ï¼Œå­¦æœ¯ç•Œï¼Œç‰¹åˆ«æ˜¯å›½å†…çš„ï¼Œè¿˜æ˜¯äººçš„æ±Ÿæ¹–ã€‚å…³äºäººï¼Œæˆ‘æ˜¯æ—¢é„™å¤·åˆèµç¾ã€‚ æˆ‘ä¹Ÿä¸çŸ¥é“æœªæ¥å¦‚è½å¶çš„æˆ‘ä¼šé£˜å‘ä½•æ–¹ï¼Œä¸”è¡Œä¸”çœ‹ï¼Œä½†æˆ‘è¶Šæ¥è¶Šæ„Ÿè§‰ï¼Œå°½åŠ›ä¿æŒä¸€é¢—â€œç«¥å¿ƒâ€æ‰èƒ½ä¸è´Ÿç”Ÿå‘½ã€‚</p>



 ]]></description>
  <category>thought</category>
  <category>academic</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-21-how-do-you-think-bioinformatics-in-science/index.html</guid>
  <pubDate>Thu, 20 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-07-20</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-20-journal/index.html</link>
  <description><![CDATA[ 




<p>ä»Šå¤©å¾ˆæ˜¯çŠ¯å›°ğŸ˜ªï¼Œå¾ˆå›°ã€‚</p>
<p>å¯èƒ½å› ä¸ºè¦æ—©èµ·æ‰¾äººç­¾å­—ï¼Œä¸­åˆç¡å¾—æ˜æ˜æ²‰æ²‰ã€‚</p>
<p>å¯èƒ½ä»Šå¤©æ—©ä¸Šä¸‹åˆéƒ½æœ‰ä¼šè®®ï¼Œåä¹…åçš„éº»ç—¹ã€‚</p>
<p>å¯èƒ½ä»Šå¤©ç²¾ç¥å¤ªè¿‡ç´§ç»·ï¼Œç«™ä¸­ç‰¹åˆ«èµ„åŠ©æ²¡ä¸Šï¼Œåˆä¸€ç›´åœ¨ç¼–å†™å’Œæµ‹è¯•åˆ†ææµç¨‹ã€‚</p>
<p>æ€»ä¹‹ï¼Œä»Šå¤©ç¡®å®å¾ˆçŠ¯å›°ã€‚ä¸€å¤©çœ‹æ˜¯ä»€ä¹ˆéƒ½æ²¡åšï¼Œä½†å¥½æ­¹æœ‰äº†è®°å½•ï¼Œè®°å½•ä»Šå¤©å¤§ä½“å‘ç”Ÿè¿‡ä»€ä¹ˆã€‚</p>
<p>ğŸ˜ª</p>



 ]]></description>
  <category>journal</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-20-journal/index.html</guid>
  <pubDate>Wed, 19 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>2023-07-18</title>
  <dc:creator>Shixiang Wang</dc:creator>
  <link>https://shixiangwang.github.io/posts/2023-07-18-journal/index.html</link>
  <description><![CDATA[ 




<p>Without hard work, nothing grows but weeds.</p>



 ]]></description>
  <category>journal</category>
  <guid>https://shixiangwang.github.io/posts/2023-07-18-journal/index.html</guid>
  <pubDate>Mon, 17 Jul 2023 16:00:00 GMT</pubDate>
</item>
</channel>
</rss>
