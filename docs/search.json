[
  {
    "objectID": "posts/2023-04-08-yiyi-with-book-by-y/index.html",
    "href": "posts/2023-04-08-yiyi-with-book-by-y/index.html",
    "title": "晒晒娃和Y叔R书的合照",
    "section": "",
    "text": "买了一本Y叔最新出的新书，出版社的张编辑又送了一本，这里晒一下崽崽和图书的照片。\n\n\n摄影自我媳妇"
  },
  {
    "objectID": "posts/2023-05-12-start-a-new-research-direction/index.html",
    "href": "posts/2023-05-12-start-a-new-research-direction/index.html",
    "title": "Start a new research direction",
    "section": "",
    "text": "Copied from a slide (Liulab?).\n\n\nIs the new direction is important?\n\nI can explain its importance to laymen\nThere are basic science, translational and industry interests\nI am willing to devote the next 5-10 years working on it\n\nDo we have any advantage working on this?\nWhat can we actually do (expertise)?"
  },
  {
    "objectID": "posts/2023-05-02-random/index.html",
    "href": "posts/2023-05-02-random/index.html",
    "title": "随想",
    "section": "",
    "text": "越长大，突然明白这个世界都是在玩一场资源分配的游戏。\n卷不是目的，只是无能为力。\n超脱者永远是少数。\n所谓，求仙不得仙，只能老实做人。"
  },
  {
    "objectID": "posts/2023-06-14-use-just/index.html",
    "href": "posts/2023-06-14-use-just/index.html",
    "title": "使用 Just 重复构建",
    "section": "",
    "text": "Just（https://just.systems/）是一个命令行运行容器，它只是简单的运行你输入的命令，以方便重复构建。\n它没有 Make 那么复杂，这真是我喜欢它的原因。很久之前我很想学习 Make/Makefile，但一直未能成行。Just 让我意识到，我可能根本不需要学习 Make，也能开始很好地学会使用构建。\n我把 Just 的文档看完后发现，其实核心要点就在 README 的图里，而复杂的特征需求往后再说，可能一直都用不上。\n\n\n来源：https://github.com/casey/just"
  },
  {
    "objectID": "posts/2023-05-31-scrna-seq_online-00/index.html",
    "href": "posts/2023-05-31-scrna-seq_online-00/index.html",
    "title": "scRNA-seq_online 00：包准备",
    "section": "",
    "text": "参考资料：https://hbctraining.github.io/scRNA-seq_online/"
  },
  {
    "objectID": "posts/2023-05-31-scrna-seq_online-00/index.html#安装包",
    "href": "posts/2023-05-31-scrna-seq_online-00/index.html#安装包",
    "title": "scRNA-seq_online 00：包准备",
    "section": "安装包",
    "text": "安装包\n安装 CRAN 包：\ninstall.packages(\"BiocManager\")\nBiocManager::install(c(\"tidyverse\", \"Matrix\", \"RCurl\", \"scales\", \"cowplot\", \"Seurat\", \"metap\"))\n安装 Bioc 包：\n# options(BioC_mirror=\"https://mirrors.tuna.tsinghua.edu.cn/bioconductor\")\nBiocManager::install(c(\"AnnotationHub\", \"ensembldb\", \"multtest\", \"glmGamPoi\"))"
  },
  {
    "objectID": "posts/2023-05-31-scrna-seq_online-00/index.html#测试包的安装",
    "href": "posts/2023-05-31-scrna-seq_online-00/index.html#测试包的安装",
    "title": "scRNA-seq_online 00：包准备",
    "section": "测试包的安装",
    "text": "测试包的安装\n\nlibrary(Seurat)\n## Attaching SeuratObject\nlibrary(tidyverse)\n## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n## ✔ dplyr     1.1.2     ✔ readr     2.1.4\n## ✔ forcats   1.0.0     ✔ stringr   1.5.0\n## ✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n## ✔ purrr     1.0.1\n## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n## ✖ dplyr::filter() masks stats::filter()\n## ✖ dplyr::lag()    masks stats::lag()\n## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\nlibrary(Matrix)\n## \n## Attaching package: 'Matrix'\n## \n## The following objects are masked from 'package:tidyr':\n## \n##     expand, pack, unpack\nlibrary(RCurl)\n## \n## Attaching package: 'RCurl'\n## \n## The following object is masked from 'package:tidyr':\n## \n##     complete\nlibrary(scales)\n## \n## Attaching package: 'scales'\n## \n## The following object is masked from 'package:purrr':\n## \n##     discard\n## \n## The following object is masked from 'package:readr':\n## \n##     col_factor\nlibrary(cowplot)\n## \n## Attaching package: 'cowplot'\n## \n## The following object is masked from 'package:lubridate':\n## \n##     stamp\nlibrary(AnnotationHub)\n## Loading required package: BiocGenerics\n## \n## Attaching package: 'BiocGenerics'\n## \n## The following objects are masked from 'package:lubridate':\n## \n##     intersect, setdiff, union\n## \n## The following objects are masked from 'package:dplyr':\n## \n##     combine, intersect, setdiff, union\n## \n## The following objects are masked from 'package:stats':\n## \n##     IQR, mad, sd, var, xtabs\n## \n## The following objects are masked from 'package:base':\n## \n##     anyDuplicated, aperm, append, as.data.frame, basename, cbind,\n##     colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,\n##     get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,\n##     match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,\n##     Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,\n##     table, tapply, union, unique, unsplit, which.max, which.min\n## \n## Loading required package: BiocFileCache\n## Loading required package: dbplyr\n## \n## Attaching package: 'dbplyr'\n## \n## The following objects are masked from 'package:dplyr':\n## \n##     ident, sql\nlibrary(ensembldb)\n## Loading required package: GenomicRanges\n## Loading required package: stats4\n## Loading required package: S4Vectors\n## \n## Attaching package: 'S4Vectors'\n## \n## The following objects are masked from 'package:Matrix':\n## \n##     expand, unname\n## \n## The following objects are masked from 'package:lubridate':\n## \n##     second, second&lt;-\n## \n## The following objects are masked from 'package:dplyr':\n## \n##     first, rename\n## \n## The following object is masked from 'package:tidyr':\n## \n##     expand\n## \n## The following objects are masked from 'package:base':\n## \n##     expand.grid, I, unname\n## \n## Loading required package: IRanges\n## \n## Attaching package: 'IRanges'\n## \n## The following object is masked from 'package:lubridate':\n## \n##     %within%\n## \n## The following objects are masked from 'package:dplyr':\n## \n##     collapse, desc, slice\n## \n## The following object is masked from 'package:purrr':\n## \n##     reduce\n## \n## Loading required package: GenomeInfoDb\n## Loading required package: GenomicFeatures\n## Loading required package: AnnotationDbi\n## Loading required package: Biobase\n## Welcome to Bioconductor\n## \n##     Vignettes contain introductory material; view with\n##     'browseVignettes()'. To cite Bioconductor, see\n##     'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'.\n## \n## \n## Attaching package: 'Biobase'\n## \n## The following object is masked from 'package:AnnotationHub':\n## \n##     cache\n## \n## \n## Attaching package: 'AnnotationDbi'\n## \n## The following object is masked from 'package:dplyr':\n## \n##     select\n## \n## Loading required package: AnnotationFilter\n## \n## Attaching package: 'ensembldb'\n## \n## The following object is masked from 'package:dplyr':\n## \n##     filter\n## \n## The following object is masked from 'package:stats':\n## \n##     filter"
  },
  {
    "objectID": "posts/2023-05-31-scrna-seq_online-00/index.html#查看会话信息",
    "href": "posts/2023-05-31-scrna-seq_online-00/index.html#查看会话信息",
    "title": "scRNA-seq_online 00：包准备",
    "section": "查看会话信息",
    "text": "查看会话信息\n\nsessionInfo()\n\nR version 4.2.2 (2022-10-31)\nPlatform: x86_64-apple-darwin17.0 (64-bit)\nRunning under: macOS Big Sur ... 10.16\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] zh_CN.UTF-8/zh_CN.UTF-8/zh_CN.UTF-8/C/zh_CN.UTF-8/zh_CN.UTF-8\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] ensembldb_2.22.0        AnnotationFilter_1.22.0 GenomicFeatures_1.50.4 \n [4] AnnotationDbi_1.60.2    Biobase_2.58.0          GenomicRanges_1.50.2   \n [7] GenomeInfoDb_1.34.9     IRanges_2.32.0          S4Vectors_0.36.2       \n[10] AnnotationHub_3.6.0     BiocFileCache_2.6.1     dbplyr_2.3.2           \n[13] BiocGenerics_0.44.0     cowplot_1.1.1           scales_1.2.1           \n[16] RCurl_1.98-1.12         Matrix_1.5-4.1          lubridate_1.9.2        \n[19] forcats_1.0.0           stringr_1.5.0           dplyr_1.1.2            \n[22] purrr_1.0.1             readr_2.1.4             tidyr_1.3.0            \n[25] tibble_3.2.1            ggplot2_3.4.2           tidyverse_2.0.0        \n[28] SeuratObject_4.1.3      Seurat_4.3.0           \n\nloaded via a namespace (and not attached):\n  [1] utf8_1.2.3                    spatstat.explore_3.2-1       \n  [3] reticulate_1.28               tidyselect_1.2.0             \n  [5] RSQLite_2.3.1                 htmlwidgets_1.6.2            \n  [7] grid_4.2.2                    BiocParallel_1.32.6          \n  [9] Rtsne_0.16                    munsell_0.5.0                \n [11] codetools_0.2-19              ica_1.0-3                    \n [13] future_1.32.0                 miniUI_0.1.1.1               \n [15] withr_2.5.0                   spatstat.random_3.1-5        \n [17] colorspace_2.1-0              progressr_0.13.0             \n [19] filelock_1.0.2                knitr_1.43                   \n [21] rstudioapi_0.14               ROCR_1.0-11                  \n [23] tensor_1.5                    listenv_0.9.0                \n [25] MatrixGenerics_1.10.0         GenomeInfoDbData_1.2.9       \n [27] polyclip_1.10-4               bit64_4.0.5                  \n [29] parallelly_1.36.0             vctrs_0.6.2                  \n [31] generics_0.1.3                xfun_0.39                    \n [33] timechange_0.2.0              R6_2.5.1                     \n [35] bitops_1.0-7                  spatstat.utils_3.0-3         \n [37] cachem_1.0.8                  DelayedArray_0.24.0          \n [39] promises_1.2.0.1              BiocIO_1.8.0                 \n [41] gtable_0.3.3                  globals_0.16.2               \n [43] goftest_1.2-3                 rlang_1.1.1                  \n [45] splines_4.2.2                 rtracklayer_1.58.0           \n [47] lazyeval_0.2.2                spatstat.geom_3.2-1          \n [49] BiocManager_1.30.20           yaml_2.3.7                   \n [51] reshape2_1.4.4                abind_1.4-5                  \n [53] httpuv_1.6.11                 tools_4.2.2                  \n [55] ellipsis_0.3.2                RColorBrewer_1.1-3           \n [57] ggridges_0.5.4                Rcpp_1.0.10                  \n [59] plyr_1.8.8                    progress_1.2.2               \n [61] zlibbioc_1.44.0               prettyunits_1.1.1            \n [63] deldir_1.0-9                  pbapply_1.7-0                \n [65] zoo_1.8-12                    SummarizedExperiment_1.28.0  \n [67] ggrepel_0.9.3                 cluster_2.1.4                \n [69] magrittr_2.0.3                data.table_1.14.8            \n [71] scattermore_1.1               lmtest_0.9-40                \n [73] RANN_2.6.1                    ProtGenerics_1.30.0          \n [75] fitdistrplus_1.1-11           matrixStats_0.63.0           \n [77] hms_1.1.3                     patchwork_1.1.2              \n [79] mime_0.12                     evaluate_0.21                \n [81] xtable_1.8-4                  XML_3.99-0.14                \n [83] gridExtra_2.3                 compiler_4.2.2               \n [85] biomaRt_2.54.1                KernSmooth_2.23-21           \n [87] crayon_1.5.2                  htmltools_0.5.5              \n [89] later_1.3.1                   tzdb_0.4.0                   \n [91] DBI_1.1.3                     MASS_7.3-60                  \n [93] rappdirs_0.3.3                cli_3.6.1                    \n [95] parallel_4.2.2                igraph_1.4.3                 \n [97] pkgconfig_2.0.3               GenomicAlignments_1.34.1     \n [99] sp_1.6-0                      plotly_4.10.1                \n[101] spatstat.sparse_3.0-1         xml2_1.3.4                   \n[103] XVector_0.38.0                digest_0.6.31                \n[105] sctransform_0.3.5             RcppAnnoy_0.0.20             \n[107] spatstat.data_3.0-1           Biostrings_2.66.0            \n[109] rmarkdown_2.21                leiden_0.4.3                 \n[111] uwot_0.1.14                   restfulr_0.0.15              \n[113] curl_5.0.0                    shiny_1.7.4                  \n[115] Rsamtools_2.14.0              rjson_0.2.21                 \n[117] lifecycle_1.0.3               nlme_3.1-162                 \n[119] jsonlite_1.8.4                viridisLite_0.4.2            \n[121] fansi_1.0.4                   pillar_1.9.0                 \n[123] lattice_0.21-8                KEGGREST_1.38.0              \n[125] fastmap_1.1.1                 httr_1.4.6                   \n[127] survival_3.5-5                interactiveDisplayBase_1.36.0\n[129] glue_1.6.2                    png_0.1-8                    \n[131] BiocVersion_3.16.0            bit_4.0.5                    \n[133] stringi_1.7.12                blob_1.2.4                   \n[135] memoise_2.0.1                 irlba_2.3.5.1                \n[137] future.apply_1.11.0"
  },
  {
    "objectID": "posts/2023-05-31-scrna-seq_online-00/index.html#阅读",
    "href": "posts/2023-05-31-scrna-seq_online-00/index.html#阅读",
    "title": "scRNA-seq_online 00：包准备",
    "section": "阅读",
    "text": "阅读\n接下来就可以阅读以下两份非常好的材料了解单细胞的预备知识。\n\nIntroduction to single-cell RNA-seq\nGeneration of count matrix"
  },
  {
    "objectID": "posts/2023-05-23-nextflow-singularity-no-space-left/index.html",
    "href": "posts/2023-05-23-nextflow-singularity-no-space-left/index.html",
    "title": "nextflow 运行 singularity no space left",
    "section": "",
    "text": "运行 nextflow 时报错没有空间：\nError executing process &gt; 'NFCORE_CIRCDNA:CIRCDNA:CNVKIT_BATCH (N87-TR)'\n\nCaused by:\n  Process `NFCORE_CIRCDNA:CIRCDNA:CNVKIT_BATCH (N87-TR)` terminated with an error exit status (255)\n\nCommand executed:\n\n  cnvkit.py \\\n      batch \\\n      N87-TR.bam \\\n       \\\n      --reference GRCh38_cnvkit_filtered_ref.cnn \\\n      --processes 4 \\\n      --method wgs\n\n  cat &lt;&lt;-END_VERSIONS &gt; versions.yml\n  \"NFCORE_CIRCDNA:CIRCDNA:CNVKIT_BATCH\":\n      cnvkit: $(cnvkit.py version | sed -e \"s/cnvkit v//g\")\n  END_VERSIONS\n\nCommand exit status:\n  255\n\nCommand output:\n  (empty)\n\nCommand error:\n  INFO:    Converting SIF file to temporary sandbox...\n  FATAL:   while extracting /data3/wsx/nf-core-circdna-dev/workflow/../singularity-images/depot.galaxyproject.org-singularity-cnvkit-0.9.9--pyhdfd78af_0.img: root filesystem extraction failed: extract command failed: WARNING: passwd file doesn't exist in container, not updating\n  WARNING: group file doesn't exist in container, not updating\n  WARNING: Skipping mount /etc/hosts [binds]: /etc/hosts doesn't exist in container\n  WARNING: Skipping mount /etc/localtime [binds]: /etc/localtime doesn't exist in container\n  WARNING: Skipping mount proc [kernel]: /proc doesn't exist in container\n  WARNING: Skipping mount /data3/wsx/miniconda3/var/singularity/mnt/session/tmp [tmp]: /tmp doesn't exist in container\n  WARNING: Skipping mount /data3/wsx/miniconda3/var/singularity/mnt/session/var/tmp [tmp]: /var/tmp doesn't exist in container\n  WARNING: Skipping mount /data3/wsx/miniconda3/var/singularity/mnt/session/etc/resolv.conf [files]: /etc/resolv.conf doesn't exist in container\n\n  Write on output file failed because No space left on device\n\n  FATAL ERROR:writer: failed to write file /image/root/.singularity.d/startscript\n  Parallel unsquashfs: Using 48 processors\n  29783 inodes (35465 blocks) to write\n\n  : exit status 1\n\nWork dir:\n  /data3/wsx/nxf_wgs/work/e9/902f1684d95d41a61ae28ef3e529b3\n\nTip: when you have fixed the problem you can continue the execution adding the option `-resume` to the run command line\n我查了下 /tmp 缺失很少或没有了，尝试删除我自己产生的临时目录再次运行还是报错。原因是 singularity 镜像在 /tmp 目录下解压空间不够导致的。\n实际上我在 ~/.bashrc 下是设置过临时目录和singularity的缓存的：\nexport TMPDIR=$HOME/TEMPDIR\nexport TEMP=$HOME/TEMPDIR\nexport TMP=$HOME/TEMPDIR\n\nexport NXF_SINGULARITY_CACHEDIR=$HOME/NXF_singularity\nexport SINGULARITY_TMPDIR=$HOME/singularity-env\nexport SINGULARITY_CACHEDIR=$HOME/singularity-env\n这就相当纳闷了。在 Github 发现一个帖子，讨论说这个问题是 nextflow 没有正常地读取和设置 singularity 的临时目录磁盘挂载。\n想一想，确实是这个问题。为了确定，我在报错的 work 目录下查看和调试了 .command.run 文件，当设置挂载后确实是可以正常工作的。\n于是按照下面进行了 nextflow.config 的配置：\nsingularity {\nenabled = true\nautoMounts = true\nrunOptions = '-B $SINGULARITY_TMPDIR:/tmp -B $SINGULARITY_TMPDIR:/scratch'\n//Used to allow Singularity to access bashrc variables\nenvWhitelist = ['SINGULARITY_TMPDIR']\n}\n还是不行，后面对比时猛然发现在 nextflow.config 中 autoMounts 的写法是 singularity.autoMounts = true。 所以我添加了前缀：\nsingularity.autoMounts = true\nsingularity.runOptions = '-B $SINGULARITY_TMPDIR:/tmp'\nsingularity.envWhitelist = ['SINGULARITY_TMPDIR']\n这样就没有问题了。"
  },
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Welcome To My Blog",
    "section": "",
    "text": "This is the first post in a Quarto blog. Welcome!"
  },
  {
    "objectID": "posts/2023-03-29-chatgpt-help-me-understand-rust-ownership/index.html",
    "href": "posts/2023-03-29-chatgpt-help-me-understand-rust-ownership/index.html",
    "title": "ChatGPT 帮助我理解 Rust 的所有权",
    "section": "",
    "text": "这篇文章以我和 ChatGPT 的问答进行。"
  },
  {
    "objectID": "posts/2023-03-29-chatgpt-help-me-understand-rust-ownership/index.html#怎么理解rust的所有权",
    "href": "posts/2023-03-29-chatgpt-help-me-understand-rust-ownership/index.html#怎么理解rust的所有权",
    "title": "ChatGPT 帮助我理解 Rust 的所有权",
    "section": "怎么理解rust的所有权？",
    "text": "怎么理解rust的所有权？\nRust的所有权是其独特的内存管理系统，用于动态内存分配和释放。它基于以下原则：\n\n每个值在任何时刻只能有一个所有者。\n所有权只能转移，不能共享。\n默认情况下，所有权的转移是按值而不是按引用进行的。\n\n这种所有权系统有助于避免内存泄漏、空引用和数据竞争等常见的错误。在Rust中，通过为每个值分配一个所有者来跟踪内存中的数据是如何使用的，每一个所有者离开作用域时，它拥有的值都会被销毁。因此，Rust所有权系统能够自动管理内存，而且无需额外的垃圾回收机制。这一特性让Rust成为一个高效、安全和可靠的编程语言。需要注意的是，所有权机制对于Rust的初学者来说是一个相对复杂的概念，需要一定的理解和实践才能更好地应用它并编写出高质量的Rust代码。"
  },
  {
    "objectID": "posts/2023-03-29-chatgpt-help-me-understand-rust-ownership/index.html#怎么理解-所有权的主要目的就是为了管理堆数据",
    "href": "posts/2023-03-29-chatgpt-help-me-understand-rust-ownership/index.html#怎么理解-所有权的主要目的就是为了管理堆数据",
    "title": "ChatGPT 帮助我理解 Rust 的所有权",
    "section": "怎么理解 所有权的主要目的就是为了管理堆数据？",
    "text": "怎么理解 所有权的主要目的就是为了管理堆数据？\nRust中的所有权确实是用于管理堆数据的，因为堆数据是在运行时动态分配的，并且在内存中存在一定的问题，如内存泄漏、数据竞争等。因此需要一种机制来管理堆数据并解决这些问题。所有权机制可以确保在动态分配内存的情况下，内存得到正确的释放，每个heap上的数据有且仅有一个所有者对其进行管理，从而避免了数据竞争和其他常见的错误。\n此外，Rust还使用采取堆管理的方式为其他类型的数据分配内存。例如，当一个Vector或String类型增长时，它们必须重新分配和复制所有的数据，同时保证新的数据具有唯一的所有者。这使得Rust的动态内存分配和释放机制非常高效、可靠和安全，在许多应用程序场景中可以提供非常好的性能。"
  },
  {
    "objectID": "posts/2023-03-29-chatgpt-help-me-understand-rust-ownership/index.html#为什么所有权不是管理栈数据的呢",
    "href": "posts/2023-03-29-chatgpt-help-me-understand-rust-ownership/index.html#为什么所有权不是管理栈数据的呢",
    "title": "ChatGPT 帮助我理解 Rust 的所有权",
    "section": "为什么所有权不是管理栈数据的呢？",
    "text": "为什么所有权不是管理栈数据的呢？\n所有权的设计之所以没有涉及栈，是因为栈上的数据是随着当前作用域结束而自动释放的。栈上的数据的分配和释放是编译时完成的，编译器可以自己进行管理，从而不需要特别的内存管理机制。当在栈上分配数据时，其生命周期的结束是在编译器处理的代码块退出前的最后一个语句执行后就会自动发生。此时编译器会自动释放它们的空间，没有必要使用所有权。因此，所有权机制主要应用于需要在运行时动态分配内存的场景，例如堆上存储的大型数据结构、字符串、闭包等。相比于栈上的数据，堆上的数据需要更加灵活和高级的处理方式，所以所有权体系的设计针对的是动态内存的管理，而不是栈上的处理。"
  },
  {
    "objectID": "posts/2023-03-29-chatgpt-help-me-understand-rust-ownership/index.html#所有权造成的操作障碍",
    "href": "posts/2023-03-29-chatgpt-help-me-understand-rust-ownership/index.html#所有权造成的操作障碍",
    "title": "ChatGPT 帮助我理解 Rust 的所有权",
    "section": "所有权造成的操作障碍",
    "text": "所有权造成的操作障碍\n由于所有权的问题，Rust 变得安全有效，但对于开发者也造成了一些理解和操作问题。 例如，同一个堆数据（栈数据不会受到影响，因为它们在编译时已经被决定了，堆数据在运行时是可变的，所以才会有内存问题）不能指向两个不同的变量，当新的变量出现时，所有权被转移，之前的变量就无效无法使用了。\nfn main() {\n    let s1 = String::from(\"hello\");\n    let s2 = s1;\n\n    println!(\"{}, world!\", s1);\n}\n\n为了生成两个拷贝，需要用到克隆。\nfn main() {\n    let s1 = String::from(\"hello\");\n    let s2 = s1.clone();\n\n    println!(\"s1 = {}, s2 = {}\", s1, s2);\n}\n这个 Rust 的 trait 设计也有关系（我理解就是实际的实现）\n\nRust 有一个叫做 Copy trait 的特殊注解，可以用在类似整型这样的存储在栈上的类型上。如果一个类型实现了 Copy trait，那么一个旧的变量在将其赋值给其他变量后仍然可用。\nRust 不允许自身或其任何部分实现了 Drop trait 的类型使用 Copy trait。如果我们对其值离开作用域时需要特殊处理的类型使用 Copy 注解，将会出现一个编译时错误。\n那么哪些类型实现了 Copy trait 呢？你可以查看给定类型的文档来确认，不过作为一个通用的规则，任何一组简单标量值的组合都可以实现 Copy，任何不需要分配内存或某种形式资源的类型都可以实现 Copy 。如下是一些 Copy 的类型：\n所有整数类型，比如 u32。 布尔类型，bool，它的值是 true 和 false。 所有浮点数类型，比如 f64。 字符类型，char。 元组，当且仅当其包含的类型也都实现 Copy 的时候。比如，(i32, i32) 实现了 Copy，但 (i32, String) 就没有。\n\n变量的所有权总是遵循相同的模式：将值赋给另一个变量时移动它。当持有堆中数据值的变量离开作用域时，其值将通过 drop 被清理掉，除非数据被移动为另一个变量所有。\n\n参考：\n\nhttps://kaisery.github.io/trpl-zh-cn/ch04-01-what-is-ownership.html"
  },
  {
    "objectID": "posts/2023-05-12-single-cell-sequencing-protocols/index.html",
    "href": "posts/2023-05-12-single-cell-sequencing-protocols/index.html",
    "title": "Single-cell sequencing protocols",
    "section": "",
    "text": "From https://www.sc-best-practices.org/introduction/scrna_seq.html\nTypes:"
  },
  {
    "objectID": "posts/2023-05-12-single-cell-sequencing-protocols/index.html#基于微流控装置",
    "href": "posts/2023-05-12-single-cell-sequencing-protocols/index.html#基于微流控装置",
    "title": "Single-cell sequencing protocols",
    "section": "基于微流控装置",
    "text": "基于微流控装置\n基于微流控芯片的单细胞策略可以将细胞固定在水凝胶液滴内部，实现将其分隔到单细胞反应室中。最广泛使用的协议有inDrop [Klein等人，2015]、Drop-seq [Macosko等人，2015]和商业可用的10x Genomics Chromium [Zheng等人，2017]，能够每秒生成数千个这样的液滴。这种大规模并行的过程以相对较低的成本生成非常多的液滴。虽然这三个协议在细节上有所不同，但始终设计了包含携带PCR处理程序、细胞条形码和4-8个碱基对长的唯一分子标识符（UMI）和poly-T尾巴的专门微珠来封装细胞的纳升级液滴，以便同时捕获微珠和细胞。封装过程是使用具有on-bead引物的专门微珠进行的，这些引物包含一个PCR处理程序、一个细胞条形码和一个4-8 bp长的唯一分子标识符（UMI）和一个poly-T尾巴。在裂解后，细胞的mRNA立即被释放，并被附加在微珠上的带条形码的寡核苷酸捕获。接下来，收集液滴并将其打破以释放连接到微粒（STAMPs）上的单个细胞转录组。然后进行PCR和反转录以捕获和扩增转录物。最后进行标签切割，其中转录本被随机切割并附加测序适配器。该过程产生了用于测序的测序文库，如上所述。在基于微流控芯片的协议中，细胞的约10%的转录本会被检测到[Islam等人，2014]。值得注意的是，这种低测序量已足以稳健地识别细胞类型。\n所有三种基于微流控芯片的方法都会产生特定的偏差。所使用的微珠材料在协议之间存在差异。Drop-seq使用脆性树脂制成的微珠，因此微珠被以泊松分布封装，而InDrop和10X Genomics微珠是可变形的，导致微珠的占用率超过80%[Zhang等人，2019]。此外，Drop-Seq中使用表面固定引物可能会影响捕获效率。InDrop使用光解引物释放，而10X genomics则溶解微珠。这种差异也影响了反转录过程的位置。在Drop-seq中，反转录发生在微珠从液滴中释放后，而在InDrop和10X genomics协议中，反转录发生在液滴内部[Zhang等人，2019]。\n2019年张等人的比较发现，就微珠质量而言，10X Genomics比inDrop和Drop-seq表现更好，因为前两个系统中的细胞条形码存在明显的不匹配。此外，从有效条形码中产生的读数比例对于10X Genomics是75%，而对于InDrop和Drop-seq仅分别为25%和30%。\n在敏感性方面，10X Genomics也表现出类似的优势。他们的比较显示，平均而言，10X Genomics捕获了来自3000个基因的约17000份转录本，而Drop-seq只有来自2500个基因的约8000份转录本，InDrop则只有来自1250个基因的约2700份转录本。技术噪音最小的是10X Genomics，其次是Drop-seq和InDrop[Zhang等人，2019]。\n实际生成的数据展示了大量的协议偏差。10X Genomics更倾向于捕获和扩增长度较短的基因和GC含量较高的基因，而相比之下，Drop-seq更倾向于GC含量较低的基因。尽管10X Genomics在各个方面的表现都超过了其他协议，但它每个细胞的成本也是其他协议的两倍左右。此外，除了微珠以外，Drop-seq是开源的，协议可以更容易地进行适应性调整。InDrop完全是开放源代码的，甚至可以在实验室中制造和修改微珠。因此，InDrop是三种协议中最灵活的一种。\n\n优点：\n\n可以以成本效益的方式对大量细胞进行测序，以识别组织的总体组成并表征罕见的细胞类型。\n可以加入唯一分子标识符（UMIs）。\n\n限制：\n\n与其他方法相比，转录本检测率较低。\n只能捕获3’端而非全长转录本，因为细胞条形码和PCR处理程序仅添加到转录本的末端。"
  },
  {
    "objectID": "posts/2023-05-12-single-cell-sequencing-protocols/index.html#基于板",
    "href": "posts/2023-05-12-single-cell-sequencing-protocols/index.html#基于板",
    "title": "Single-cell sequencing protocols",
    "section": "基于板",
    "text": "基于板\n基于板的协议通常将细胞物理地分离到微孔板中。第一步涉及通过荧光激活细胞分选（FACS）等方法对细胞进行分选，其中根据特定的细胞表面标记对细胞进行排序；或通过微型移液进行。然后将所选细胞放入含有细胞裂解缓冲液的单个孔中，随后进行反转录。这样可以在单次实验中分析数百个细胞，并每个细胞捕获5000至10000个基因。基于板的测序协议包括但不限于SMART-seq2、MARS-seq、QUARTZ-seq和SRCB-seq。总的来说，这些协议在其多重复合能力方面存在差异。例如，MARS-seq允许三个条形码级别，即分子、细胞和板级标签，以实现强大的多重复合功能。相反，SMART-seq2不允许早期多重复合，从而限制了细胞数目。Mereu等人在2020年进行的系统比较显示，与SMART-seq2、MARS-seq或SRCB-seq相比，QUARTZ-seq2能够捕获更多的基因[Mereu等人，2020]，这意味着QUARTZ-seq2能够很好地捕获细胞类型特异性标记基因，从而实现可靠的细胞类型注释。\n\n优点：\n\n每个细胞可以恢复许多基因，从而进行深入的表征。\n可能在库制备之前收集信息，例如通过FACS排序将细胞大小和任何使用的标记的强度与孔座标关联起来。\n允许完整的转录本恢复。\n\n限制：\n\n基于板的实验规模受到其单个处理单元较低的吞吐量的限制。\n断裂步骤会消除链特异性信息[Hrdlickova等人，2017]。\n根据协议不同，基于板的协议可能是人力密集型的，需要许多必需的移液步骤，导致潜在的技术噪声和批次效应。"
  },
  {
    "objectID": "posts/2023-05-12-single-cell-sequencing-protocols/index.html#fluidigm-c1",
    "href": "posts/2023-05-12-single-cell-sequencing-protocols/index.html#fluidigm-c1",
    "title": "Single-cell sequencing protocols",
    "section": "Fluidigm C1",
    "text": "Fluidigm C1\n商业的Fluidigm C1系统是一种微流控芯片，可以自动将细胞加载和分离到小反应室中。 CEL-seq2和SMART-seq（版本1）协议在其工作流程中使用Fluidigm C1芯片，允许RNA提取和文库制备步骤同时进行，从而减少所需的手动劳动。但是，Fluidigm C1需要相对均匀的细胞混合物，因为细胞基于其大小会到达微流控芯片上的不同位置，可能会引入潜在的空间偏差。由于扩增步骤是在单个孔中进行的，因此可以实现全长测序，有效地减少了许多其他单细胞RNA测序协议的3’偏差。该协议通常也更昂贵，因此主要用于特定细胞群的广泛检查。\n\n优点：\n\n允许全长转录本覆盖。\n可以恢复剪接变异和T/B细胞受体多样性。\n\n限制：\n\n仅允许对最多800个细胞进行测序[Fluidigm，2022]。\n每个细胞的成本比其他协议更高。"
  },
  {
    "objectID": "posts/2023-05-12-single-cell-sequencing-protocols/index.html#纳米孔单细胞转录组测序",
    "href": "posts/2023-05-12-single-cell-sequencing-protocols/index.html#纳米孔单细胞转录组测序",
    "title": "Single-cell sequencing protocols",
    "section": "纳米孔单细胞转录组测序",
    "text": "纳米孔单细胞转录组测序\n长读单细胞测序方法很少使用UMI [Singh等人，2019]或未执行UMI校正[Gupta等人，2018]，因此将新的UMI读取分配给新的UMI。由于长读测序器的较高测序误差率，这会导致严重问题[Lebrigand等人，2020]。Lebigrand等人引入了ScNaUmi-seq（带有UMI的单细胞Nanopore测序），它将Nanopore测序与细胞条形码和UMI分配相结合。通过比较在Nanopore读取中发现的细胞条形码序列和从同一区域或基因恢复的 Illumina读取中发现的序列，利用Illumina数据指导条形码分配[Lebrigand等人，2020]。然而，这实际上需要两个单细胞库。scCOLOR-seq使用在整个条形码长度上互补的核苷酸对计算识别无误差的条形码。然后使用这些条形码作为指南来纠正其余的错误条形码[Philpott等人，2021]。修改过的UMI-tools定向网络方法可以纠正UMI序列重复。\n\n优点：\n\n恢复剪接和序列异质性信息\n\n缺点：\n\nNanopore试剂昂贵。\n细胞条形码恢复错误率高。\n根据协议不同，条形码分配使用Illumina数据进行指导，需要两个测序试验。 只有约10%的提取细胞被捕获，使该协议不适用于罕见细胞类型或低输入。\n使用的阵列仅捕获特定的细胞大小，可能会引入偏差。"
  },
  {
    "objectID": "posts/2023-05-12-single-cell-sequencing-protocols/index.html#总结",
    "href": "posts/2023-05-12-single-cell-sequencing-protocols/index.html#总结",
    "title": "Single-cell sequencing protocols",
    "section": "总结",
    "text": "总结\n总的来说，我们强烈建议湿实验室和干实验室的科学家根据研究目的选择测序协议。是希望对特定细胞类型人群进行深入表征吗？在这种情况下，其中一种基于板的方法可能更适合。相反，基于液滴的测定会更好地捕获异质性混合物，从而允许更广泛的细胞表征。此外，如果预算是一个限制因素，则应选择更具成本效益和稳健性的协议。在分析数据时，请注意测序试验特异性偏差。为了全面比较所有单细胞测序协议，我们建议参考Mereu等人的“Benchmarking single-cell RNA-sequencing protocols for cell atlas projects”论文[Mereu等人，2020]。"
  },
  {
    "objectID": "posts/2023-06-01-likelihood/index.html",
    "href": "posts/2023-06-01-likelihood/index.html",
    "title": "概率与似然——摘要",
    "section": "",
    "text": "概率(probability)和似然(Likelihood)是两个经常被混淆使用的概念。\n概率质量函数（PMF）是用于描述离散随机变量的概率分布的函数。对于给定的随机变量取值，概率质量函数给出了该取值发生的概率。概率质量函数的输入是随机变量的取值，输出是对应取值的概率。\n似然函数（Likelihood Function）是用于估计模型参数的函数。对于给定的模型参数值，似然函数衡量了观测数据出现该参数值的可能性。似然函数的输入是模型参数的取值，输出是在给定参数下观测数据出现的可能性。\n概率质量函数和似然函数的区别在于它们关注的对象不同。概率质量函数是给定参数值时，计算随机变量的取值的概率；而似然函数是给定观测数据时，评估参数值的可能性。因此，似然函数通常用于参数估计，而概率质量函数用于描述随机变量的分布。\n简而言之，当我们有一个固定参数集的模型并且我们对可能生成的数据类型感兴趣时，通常会考虑概率。相反，当我们已经观察到数据并且我们想要检查某些模型参数的可能性时，就会使用似然。\n概率质量函数（PMF）：参数已知，观察数据。\n似然函数(Likelihood Function)：数据已知，评估参数。\n\n来源：\n\n一文了解最大似然估计(Maximum Likelihood Estimation)"
  },
  {
    "objectID": "posts/2023-05-29-tccia/index.html",
    "href": "posts/2023-05-29-tccia/index.html",
    "title": "TCCIA：第一个连接CircRNA和免疫治疗的数据库",
    "section": "",
    "text": "CircRNA是一种形成闭环结构的RNA类型，已被证明在调节基因表达方面发挥重要作用。 然而，CircRNA在免疫治疗中的作用和标志物潜能仍未被充分研究。我们很高兴地向大家介绍TCCIA（The Cancer CircRNA Immunome Atlas），它是一个广泛且用户友好的数据库，用于研究接受针对CTLA4，PD-1或PDL-1等靶点的免疫治疗的18个临床队列中的circRNA表达和分析。这一创新资源提供了cohorts和molecule级别上circRNAs、临床表型和免疫特征/浸润的系统比较。该数据库包括3700多个癌症样本，来自5种不同类型的癌症患者，这些患者单独或与化疗、靶向治疗以及其他免疫治疗药物联合使用免疫检查点抑制剂（ICI）进行治疗。\nTCCIA代表了研究circRNA及其作为预测免疫治疗响应生物标志物的潜力以及它们在癌症中的广泛功能的独特机会。无论你是研究circRNA的研究人员还是对改善新治疗策略以提高患者预后感兴趣的临床医生，TCCIA都提供了有价值的信息，可以深入了解circRNA、免疫系统和癌症之间复杂的相互作用。\n\nTCCIA 分为多个不同的页面，它以仓库页面的数据查阅和筛选为起点，允许用户从多个不同的层面和角度探索CircRNA在免疫治疗中的价值。\n\nTCCIA 是一次成功的线上科研协作，来自国内外各地的研究者贡献自己的数据和知识、资源与技术。我们旨在提供一个有用且好用的CircRNA在线研究平台，希望CircRNA领域的研究者能从中获益。目前，TCCIA正式进入开放测试阶段，它可以通过 http://biotrainee.vip:18888/TCCIA/ 和 https://shiny.hiplot.cn/TCCIA 进行在线访问。我们欢迎大家进行试用并提供宝贵的反馈意见，任何使用不便或者新功能特性的提议请发送到王诗翔（shixiang1994wang@gmail.com）或周建国（jianguo.zhou@zmu.edu.cn），我们团队将尽力回复和解决，我们期待大家的参与，一起为该领域的进步添砖加瓦。\n\n下面是一些功能的预览图："
  },
  {
    "objectID": "posts/2023-06-12-prepare-for-validation/index.html",
    "href": "posts/2023-06-12-prepare-for-validation/index.html",
    "title": "准备好应对验证",
    "section": "",
    "text": "个人感觉有效地验证的必要的，但过度的验证是次要的。但作为一个生信从业者，当文章投出去之后，总会遇到认为全世界的数据（包括原始数据）都供你可用的，任意挥霍的评审人。我并不认为这是真正的专家，因为它把一个次要的问题当作major concern，由此来否决你整个方法研究的科学性。\n事实是，文章总能在由高到低的期刊列表的评审过程中发出去。真正付出的代价是研究者的时间。 这也是预印本为什么正在走向科学发表主流的根本原因，人们越来越没有耐心了，专业化让人们产生越来越大的隔阂，但评审在大部分情况下并没有快捷有效地提升文章的真正质量。实际上，大部分的审稿人可能并不具备评估某一篇文章的能力，邀请审稿大多数只是一种资历。\n我比较痛恨当前科学研究赢者通吃的规则。eLife 等期刊的新理念或许是一个好的方向。更让我思考和困惑的是，如何不在所谓大树的阴凉下，有且做好独立创新，并能够追求内心倾向、自由探索的学术。\n可能当前阶段，我的想法过于理想和幼稚。但如果我不想和尝试做做，我的人生也总归不会交到别人的手上。"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Write programs that do one thing and do it well.",
    "section": "",
    "text": "Single-cell Workshop 2021 - 02 - 聚类和细胞类型鉴定\n\n\n\n\n\n\n\nnote\n\n\nscRNA-seq\n\n\nR\n\n\n\n\n\n\n\n\n\n\n\nJul 26, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n小记（往昔）\n\n\n\n\n\n\n\n诗\n\n\n\n\n\n\n\n\n\n\n\nJul 25, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n2023-07-25\n\n\n\n\n\n\n\njournal\n\n\n\n\n\n\n\n\n\n\n\nJul 25, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n学术的价值观\n\n\n\n\n\n\n\nacademic\n\n\n\n\n\n\n\n\n\n\n\nJul 21, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n你认同生物信息学不属于科学吗？\n\n\n\n\n\n\n\nthought\n\n\nacademic\n\n\n\n\n\n\n\n\n\n\n\nJul 21, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n2023-07-20\n\n\n\n\n\n\n\njournal\n\n\n\n\n\n\n\n\n\n\n\nJul 20, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n2023-07-18\n\n\n\n\n\n\n\njournal\n\n\n\n\n\n\n\n\n\n\n\nJul 18, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\nSingle-cell Workshop 2021 - 01 - scRNASeq 分析基础\n\n\n\n\n\n\n\nnote\n\n\nscRNA-seq\n\n\nR\n\n\n\n\n\n\n\n\n\n\n\nJul 13, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n2023-07-13\n\n\n\n\n\n\n\njournal\n\n\n\n\n\n\n\n\n\n\n\nJul 13, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n2023-07-12\n\n\n\n\n\n\n\njournal\n\n\nmachine-learning\n\n\n\n\n\n\n\n\n\n\n\nJul 12, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\nscrna 核心工具\n\n\n\n\n\n\n\nnote\n\n\nscRNA-seq\n\n\n\n\n\n\n\n\n\n\n\nJul 10, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n2023-07-10\n\n\n\n\n\n\n\njournal\n\n\n\n\n\n\n\n\n\n\n\nJul 10, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\nmight & right\n\n\n\n\n\n\n\nnote\n\n\n\n\n\n\n\n\n\n\n\nJul 10, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n2023-07-06\n\n\n\n\n\n\n\njournal\n\n\n\n\n\n\n\n\n\n\n\nJul 6, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n生物医学能离开生物信息学吗？\n\n\n\n\n\n\n\nthought\n\n\n\n\n\n\n\n\n\n\n\nJul 6, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n博客 links\n\n\n\n\n\n\n\nnote\n\n\n\n\n\n\n\n\n\n\n\nJul 2, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n2023-07-02\n\n\n\n\n\n\n\njournal\n\n\n\n\n\n\n\n\n\n\n\nJul 2, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n2023-06-28\n\n\n\n\n\n\n\njournal\n\n\n\n\n\n\n\n\n\n\n\nJun 28, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n2023-06-27\n\n\n\n\n\n\n\njournal\n\n\n\n\n\n\n\n\n\n\n\nJun 27, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n2023-06-26\n\n\n\n\n\n\n\njournal\n\n\n\n\n\n\n\n\n\n\n\nJun 26, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\nlmtest 似然比检验Likelihood Ratio Test 比较两个线性模型\n\n\n\n\n\n\n\nstats\n\n\nR\n\n\n\n\n\n\n\n\n\n\n\nJun 26, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n使用 Just 重复构建\n\n\n\n\n\n\n\nLinux\n\n\n\n\n\n\n\n\n\n\n\nJun 14, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n应该写写日记\n\n\n\n\n\n\n\njournal\n\n\n\n\n\n\n\n\n\n\n\nJun 14, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n准备好应对验证\n\n\n\n\n\n\n\nbioinformatics\n\n\nthought\n\n\n\n\n\n\n\n\n\n\n\nJun 12, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n概率与似然——摘要\n\n\n\n\n\n\n\nstats\n\n\n\n\n\n\n\n\n\n\n\nJun 1, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\nscRNA-seq_online 00：包准备\n\n\n\n\n\n\n\nbioinformatics\n\n\nscRNA-seq\n\n\n\n\n\n\n\n\n\n\n\nMay 31, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\nTCCIA：第一个连接CircRNA和免疫治疗的数据库\n\n\n\n\n\n\n\nbioinformatics\n\n\nshiny\n\n\n\n\n\n\n\n\n\n\n\nMay 29, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\nnextflow 运行 singularity no space left\n\n\n\n\n\n\n\ndebug\n\n\n\n\n\n\n\n\n\n\n\nMay 23, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\nStart a new research direction\n\n\n\n\n\n\n\nacademic\n\n\n\n\n\n\n\n\n\n\n\nMay 12, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\nSingle-cell sequencing protocols\n\n\n\n\n\n\n\nbioinformatics\n\n\nnote\n\n\n\n\n\n\n\n\n\n\n\nMay 12, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n晒晒娃和Y叔R书的合照\n\n\n\n\n\n\n\npersonal\n\n\nR\n\n\n\n\n\n\n\n\n\n\n\nApr 8, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\n随想\n\n\n\n\n\n\n\npersonal\n\n\n\n\n\n\n\n\n\n\n\nApr 8, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\nChatGPT 帮助我理解 Rust 的所有权\n\n\n\n\n\n\n\nRust\n\n\nAI\n\n\n\n\n\n\n\n\n\n\n\nMar 29, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\n  \n\n\n\n\nWelcome To My Blog\n\n\n\n\n\n\n\nnews\n\n\n\n\n\n\n\n\n\n\n\nMar 28, 2023\n\n\nShixiang Wang\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "resource.html",
    "href": "resource.html",
    "title": "Resource",
    "section": "",
    "text": "一些比较有用的 R 包都列入了 r-universe，无论是否发布在 CRAN。这里也进行了一些罗列。\n\n\n\n\nloon - 不再维护\n\n\n\n\n\nsync-deploy\nR Search Extension"
  },
  {
    "objectID": "resource.html#软件",
    "href": "resource.html#软件",
    "title": "Resource",
    "section": "",
    "text": "一些比较有用的 R 包都列入了 r-universe，无论是否发布在 CRAN。这里也进行了一些罗列。\n\n\n\n\nloon - 不再维护\n\n\n\n\n\nsync-deploy\nR Search Extension"
  },
  {
    "objectID": "resource.html#图书教程",
    "href": "resource.html#图书教程",
    "title": "Resource",
    "section": "图书/教程 📖",
    "text": "图书/教程 📖\n\n交互的Python：数据分析入门 - 阅读地址\n极客R：数据分析之道\n\nhttps://github.com/ShixiangWang/geek-r-tutorial\n\nCookbook for R 中文版- 阅读地址\n\nhttps://github.com/openbiox/Cookbook-for-R-Chinese\n\n生信爱好者周刊"
  },
  {
    "objectID": "posts/2023-06-14-write-journal/index.html",
    "href": "posts/2023-06-14-write-journal/index.html",
    "title": "应该写写日记",
    "section": "",
    "text": "吴军在《阅读与写作讲义》中写道工作日记、读书心得以及对特殊经历的记录值得人写下来。\n我很认同这个看法。回望过去一到两年的时间，写东西的次数少了以后，我竟常常难以思考出来过去一段时间做了什么，是浪费了时间还是利用了时间都搞不清楚。\n这让我联想到博士后期间做的工作，我不禁反思：是否是平常太过随意，导致工作和论文写作不严谨，所以论文评审才常常收到负面意见？心态可以放松，思想应当解放，但平时无论是工作或是生活中都要严谨，这样可能才能做好真正的科学研究工作。做人首先还是要对自己负责，毕竟生命只有一次啊！\n很多东西真的不重要，很多东西真的很重要。"
  },
  {
    "objectID": "posts/2023-06-26-lmtest-lrt/index.html",
    "href": "posts/2023-06-26-lmtest-lrt/index.html",
    "title": "lmtest 似然比检验Likelihood Ratio Test 比较两个线性模型",
    "section": "",
    "text": "library(lmtest)\n\nLoading required package: zoo\n\n\n\nAttaching package: 'zoo'\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\n## with data from Greene (1993):\n## load data and compute lags\ndata(\"USDistLag\")\nusdl &lt;- na.contiguous(cbind(USDistLag, lag(USDistLag, k = -1)))\ncolnames(usdl) &lt;- c(\"con\", \"gnp\", \"con1\", \"gnp1\")\n\nfm1 &lt;- lm(con ~ gnp + gnp1, data = usdl)\nfm2 &lt;- lm(con ~ gnp + con1 + gnp1, data = usdl)\n\n## various equivalent specifications of the LR test\n## 下面4种操作方法是等价的\nlrtest(fm2, fm1)\n\nLikelihood ratio test\n\nModel 1: con ~ gnp + con1 + gnp1\nModel 2: con ~ gnp + gnp1\n  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    \n1   5 -56.069                         \n2   4 -65.871 -1 19.605  9.524e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nlrtest(fm2, 2) # Remove variable with idx 2\n\nLikelihood ratio test\n\nModel 1: con ~ gnp + con1 + gnp1\nModel 2: con ~ gnp + gnp1\n  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    \n1   5 -56.069                         \n2   4 -65.871 -1 19.605  9.524e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nlrtest(fm2, \"con1\") # Remove variable cond 1\n\nLikelihood ratio test\n\nModel 1: con ~ gnp + con1 + gnp1\nModel 2: con ~ gnp + gnp1\n  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    \n1   5 -56.069                         \n2   4 -65.871 -1 19.605  9.524e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nlrtest(fm2, . ~ . - con1)  # Remove con1 by formula\n\nLikelihood ratio test\n\nModel 1: con ~ gnp + con1 + gnp1\nModel 2: con ~ gnp + gnp1\n  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    \n1   5 -56.069                         \n2   4 -65.871 -1 19.605  9.524e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nSurvival 模型交互项：\n\nlibrary(survival)\n\nfit2 = coxph(Surv(time, status) ~ age + sex*factor(ph.ecog), data = lung)\nlmtest::lrtest(fit2, . ~ . - sex:factor(ph.ecog))\n\nLikelihood ratio test\n\nModel 1: Surv(time, status) ~ age + sex * factor(ph.ecog)\nModel 2: Surv(time, status) ~ age + sex + factor(ph.ecog)\n  #Df  LogLik Df  Chisq Pr(&gt;Chisq)\n1   7 -728.93                     \n2   5 -729.05 -2 0.2263      0.893\n\nsummary(fit2)\n\nCall:\ncoxph(formula = Surv(time, status) ~ age + sex * factor(ph.ecog), \n    data = lung)\n\n  n= 227, number of events= 164 \n   (1 observation deleted due to missingness)\n\n                          coef exp(coef)  se(coef)      z Pr(&gt;|z|)  \nage                   0.009667  1.009714  0.009601  1.007   0.3140  \nsex                  -0.641345  0.526583  0.385890 -1.662   0.0965 .\nfactor(ph.ecog)1      0.335017  1.397964  0.609291  0.550   0.5824  \nfactor(ph.ecog)2      0.618092  1.855384  0.686960  0.900   0.3683  \nfactor(ph.ecog)3      1.941570  6.969687  1.033409  1.879   0.0603 .\nsex:factor(ph.ecog)1  0.063350  1.065400  0.451918  0.140   0.8885  \nsex:factor(ph.ecog)2  0.221865  1.248403  0.507016  0.438   0.6617  \nsex:factor(ph.ecog)3        NA        NA  0.000000     NA       NA  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                     exp(coef) exp(-coef) lower .95 upper .95\nage                     1.0097     0.9904    0.9909     1.029\nsex                     0.5266     1.8990    0.2472     1.122\nfactor(ph.ecog)1        1.3980     0.7153    0.4235     4.615\nfactor(ph.ecog)2        1.8554     0.5390    0.4827     7.131\nfactor(ph.ecog)3        6.9697     0.1435    0.9195    52.827\nsex:factor(ph.ecog)1    1.0654     0.9386    0.4394     2.583\nsex:factor(ph.ecog)2    1.2484     0.8010    0.4621     3.372\nsex:factor(ph.ecog)3        NA         NA        NA        NA\n\nConcordance= 0.636  (se = 0.025 )\nLikelihood ratio test= 31.09  on 7 df,   p=6e-05\nWald test            = 30.72  on 7 df,   p=7e-05\nScore (logrank) test = 33.92  on 7 df,   p=2e-05\n\n\n除了用 likelihood ratio test，还可以使用 anova() 去对比。\n但如果数据不一致时，上述模型无法见效。这时，应把不同的对比作为变量构建模型，然后可以采用 aov() 进行方差分析，看变量是否显著以评估是否有组间差异。"
  },
  {
    "objectID": "posts/2023-06-26-journal/index.html",
    "href": "posts/2023-06-26-journal/index.html",
    "title": "2023-06-26",
    "section": "",
    "text": "疫情之后抗感冒能力确实变得更加糟糕了，上一次二阳（本以为是重感冒）十多天之后在端午之前终于感觉到差不多好了，端午去了趟深圳回家又感觉不好了，特别是前天晚上睡觉时突然感觉喉咙很痒，频繁咳嗽，把自己咳起来去喝水。\n工作后老是感觉时间少，做什么都不够用似的，而且身体在变形和走下坡路。所以，成年人需要合理地管理自己的时间：身体、工作、生活、家人（陪伴）、休闲娱乐。其实，人生存在很强的悖论，要保持理性追求职业上升的同时，又要把关自身的感性的体态面貌健康/快乐渴望，很难做到，真的很难做到。\n我总是在想起我自己常想的一句话：我们是看着别人在过自己的人生。这也是非常矛盾的，合理的把握至关重要。在平衡这方面，我们国家的哲学理论实在是一言蔽之——阴阳！"
  },
  {
    "objectID": "posts/2023-06-27-journal/index.html",
    "href": "posts/2023-06-27-journal/index.html",
    "title": "2023-06-27",
    "section": "",
    "text": "今天记录在《经济学讲义》中看到的一句话：\n\n你拥有你的生命，但是你的生命是怎么度过的，你的职业是怎样选择的，很大程度上是由社会上其他人决定的。"
  },
  {
    "objectID": "posts/2023-06-28-journal/index.html",
    "href": "posts/2023-06-28-journal/index.html",
    "title": "2023-06-28",
    "section": "",
    "text": "坚持学习，坚持同一种内容的学习。\n工作、生活越来越让时间碎片化，我常常在回家后忘记想要做的工作和学习内容，在上班的空闲时间也常忘记家里要处理的杂事，比如购置一些缺少的生活用品。可见，这种碎片化非常影响记忆，自然就影响日常的学习进度了。\n为了抵抗这种情况，就要自律，不论各种事情，只要定下了近期的学习目标，在一两天内必须要有跟进。如果放到一周后再来做，可能要做什么都要回想半个小时。之前写 Python 基础教程书期间我就有半年因为这种事情而焦虑。\n人最可贵的是思考并付诸于行动，不是吗？"
  },
  {
    "objectID": "posts/2023-07-02-links/index.html",
    "href": "posts/2023-07-02-links/index.html",
    "title": "博客 links",
    "section": "",
    "text": "之前在构建个人域名网站 &lt;shixiangwang.work&gt; 时，把浏览器书签的所有博客链接都进行了整理。\n由于云服务器的时间有限，运维实际成本想了想还是蛮高的，没多久后也没考虑再维护了。 这里把之前整理的链接备份一下，以方便查找复用，如果对一些读者有帮助也是极好的了。\n点击查看链接"
  },
  {
    "objectID": "posts/2023-07-02-journal/index.html",
    "href": "posts/2023-07-02-journal/index.html",
    "title": "2023-07-02",
    "section": "",
    "text": "今天摘录从书中看到的一句话。\n\n我们应该利用自己有限的时间、有限的精力，在自己所能涉及的所有领域、所有活动、所有选项中， 根据边际平衡的规律来分配时间、金钱、精力和其他资源，从而使总效用达到最大。\n\n这概括了生命一生的所有努力。"
  },
  {
    "objectID": "posts/2023-07-06-journal/index.html",
    "href": "posts/2023-07-06-journal/index.html",
    "title": "2023-07-06",
    "section": "",
    "text": "顾神昨天公众号吐槽他的海外优青没有上会，我深表遗憾。\n我根据这几年逐步对学术界的了解和领会，分析可能有以下一些原因：\n\n缺乏大子刊及以上的一作和通讯；\n国内缺乏生物医学各种山头的硬的合作和关系；\n纯生信基础设施的研究工作不被评审人认可，我自己申请国自然基金时就感觉生信工作如果扯不上“分子机制”就被认为不是“自然科学”；\n基金本子没有突出优势，上会之前应该是有多个评审人基于不同的方面评估等级，所以很可能写的本子不对国内的“口味”。\n\n国内的学术条件确实在越来越好，这吸引了越来越多海外优秀的青年回国发展。 但目前国内长期不正常的学术土壤为祸尤烈，希望未来在政府的引导下、有识之士的建设下 朝着良好的方向前进。学术是创新探索，也是资源的分配，希望以后资源能够更主动地分配 到不同领域的各个角落，而不是各大门派山头。"
  },
  {
    "objectID": "posts/2023-07-06-can-biology-live-without-bioinformatics/index.html",
    "href": "posts/2023-07-06-can-biology-live-without-bioinformatics/index.html",
    "title": "生物医学能离开生物信息学吗？",
    "section": "",
    "text": "不能。\n整个生物医学领域，已经由实验科学进入了数据科学的层次，而这一点无法再倒退。 生物信息学者/家（bioinformatian/computational biologist），已经成为了该领域不可或缺的存在。无论是狭义的组学，还是更广义的分子结构计算/图形处理等，生物信息学者已经成为了科学发现/技术创造的中间力量。这也正是为什么从事生物信息学的人能从致谢名单中走到作者列表，走到第一/通讯作者的根本原因。\n如果你是一个纯湿实验的研究者，你还在心里鄙夷这个行业，你就应该反思了，时代的进步不会等待你的落后。"
  },
  {
    "objectID": "posts/2023-07-10-journal/index.html",
    "href": "posts/2023-07-10-journal/index.html",
    "title": "2023-07-10",
    "section": "",
    "text": "今天终于看完了《癌生物学》，具体而言，是「珠江肿瘤」公众号整理的中文版《癌生物学》的内容。\n当年阅读计划单上终于可以划去一项了，稍稍松了一口气。这几年，虽然我读完了不少“闲书”和网文小说，但阅读，特别是 读完的工作领域相关图书几乎是没有的。教科书类字少，但理解、思考却非常费时费力，充满挑战。 这里需要感谢公众号的作者的悉心整理，当然也特别感谢图书的作者和译者。\n\n\n公众号癌生物学汇总帖\n癌生物学PDF.pdf\n\n\n很多内容读的很浅，有些内容也跳读了，但翻完了，心里好像“靴子落地”了。这也给了我自信和时间去关注和完成其他的事情。\n这两年，我在生活和工作中都遇到了心里难以言表的困难，这种困难来自感受，也部分来自物质。切实地融入生活，才发生生活有那么多的琐事，很多事情需要耗费心力，却感受上“憋”的很。我常常会想在心里找个角落躲起来。也有时会在游戏、小说和心灵的孤独中放逐自我。 人不是机器，它不能一直产生正能量。我们都是大大宇宙中小小地球上一个个活着的卑微的人，我们想要诉求伟大，但跌入的是统计的深渊。\n不管怎样，我们的道路，就是要完成一个一个想做的事情，然后继续向前。"
  },
  {
    "objectID": "posts/2023-07-10-might-and-right/index.html",
    "href": "posts/2023-07-10-might-and-right/index.html",
    "title": "might & right",
    "section": "",
    "text": "摘录一句话。\n能力：might\n权利：right\n能力取决于自己能够占有多少，而权利取决于社会上其他人愿意给你多少。\n\n所以，该追求哪种呢？"
  },
  {
    "objectID": "posts/2023-07-10-scrna-recom/index.html",
    "href": "posts/2023-07-10-scrna-recom/index.html",
    "title": "scrna 核心工具",
    "section": "",
    "text": "Repo {scrna-recom} 单细胞综述文章关于单细胞转录组分析的流程、软件、安装等的一些说明。这里我主要是拷贝下其中关于核心工具的整理，防止迷失。\n\n\n\n\n\n\n\n\nPackage\n\n\nTutorial\n\n\n\n\n\n\nRaw Data Processing\n\n\nCell Ranger\n\n\nhttps://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger\n\n\n\n\nQuality Control\n\n\nDoubletFinder\n\n\nhttps://github.com/chris-mcginnis-ucsf/DoubletFinder\n\n\n\n\nSeurat\n\n\nhttps://satijalab.org/seurat/articles/pbmc3k_tutorial.html\n\n\n\n\nSoupX\n\n\nhttps://rawcdn.githack.com/constantAmateur/SoupX/204b602418df12e9fdb4b68775a8b486c6504fe4/inst/doc/pbmcTutorial.html\n\n\n\n\nNormalization\n\n\nSeurat\n\n\nhttps://satijalab.org/seurat/articles/pbmc3k_tutorial.html#normalizing-the-data-1\n\n\n\n\nIntegration\n\n\nSeurat:CCA,RPCA\n\n\nhttps://satijalab.org/seurat/articles/integration_rpca.html\n\n\n\n\nLiger\n\n\nhttps://github.com/welch-lab/liger\n\n\n\n\nHarmony\n\n\nhttps://github.com/immunogenomics/harmony\n\n\n\n\nDimensional Reduction\n\n\nSeurat:PCA,UMAP\n\n\nhttps://satijalab.org/seurat/articles/pbmc3k_tutorial.html#perform-linear-dimensional-reduction-1\n\n\n\n\nClustering\n\n\nSeurat\n\n\nhttps://satijalab.org/seurat/articles/pbmc3k_tutorial.html#cluster-the-cells-1\n\n\n\n\nCell type annotation\n\n\nSingleR\n\n\nhttps://github.com/dviraran/SingleR\n\n\n\n\nscCATCH\n\n\nhttps://github.com/ZJUFanLab/scCATCH\n\n\n\n\nRegulon analysis\n\n\nSCENIC\n\n\nhttps://pyscenic.readthedocs.io/en/latest/\n\n\n\n\nTrajectory inference\n\n\nMonocle3\n\n\nhttps://cole-trapnell-lab.github.io/monocle3/\n\n\n\n\nscVelo\n\n\nhttps://github.com/theislab/scvelo\n\n\n\n\nCell communication\n\n\nCellChat\n\n\nhttps://github.com/sqjin/CellChat\n\n\n\n\nMetabolic analysis\n\n\nscMetabolism\n\n\nhttps://github.com/wu-yc/scMetabolism\n\n\n\n\nscFEA\n\n\nhttps://github.com/changwn/scFEA\n\n\n\n\n\nWorkflow:"
  },
  {
    "objectID": "posts/2023-07-12-journal/index.html",
    "href": "posts/2023-07-12-journal/index.html",
    "title": "2023-07-12",
    "section": "",
    "text": "在看文献的时候发现一个自监督学习，我看英文有个 supervise，以为这是带标签的学习，了解后发现原来并非如此。这里记录下 ChatGPT 关于自监督学习和监督学习的回答。以后有机会实践深入了解下。\n自监督学习和监督学习是机器学习中两种不同的方法。\n监督学习是一种常见的机器学习方法，其中模型通过使用带有标签的训练数据进行训练。在监督学习中，输入和相应的输出之间存在一个明确的映射关系。训练数据包含了输入样本及其对应的预期输出标签。模型根据这些标签来调整自身的参数，以使预测结果尽可能接近于真实标签。例如，在图像分类任务中，监督学习会使用带有标签的图像来训练模型，使其能够根据输入图像正确地预测其所属的类别。\n自监督学习则是一种无监督学习的形式，其中模型在没有人工标签的情况下进行训练。相反，自监督学习利用输入数据中的某种自动生成的标签或信息来进行训练。这些自动生成的标签可以是输入数据的某种变换、部分信息或其他方式生成的。例如，在自我对比学习中，模型会将输入数据分为两个视图，并鼓励模型将它们视为相似。通过最大化这两个视图之间的相似性度量，模型可以学习到数据的有用表示。自监督学习的目标是通过学习数据中的内在结构或模式来训练模型，而无需人工标签。\n总的来说，监督学习依赖于带有人工标签的训练数据，而自监督学习则通过利用数据中的某种自动生成的标签或信息来进行训练。自监督学习在无法获得大量带有标签的数据时尤为有用，并且已经在多个领域中取得了显著的研究进展。"
  },
  {
    "objectID": "posts/2023-07-13-journal/index.html",
    "href": "posts/2023-07-13-journal/index.html",
    "title": "2023-07-13",
    "section": "",
    "text": "今天还是摘要书中看到的话。\n\n我们面临的，就是两个分离的世界：一个世界是我们真实的世界、看得见摸得着的物理世界。 在这里，一切都按照自然规律有条不紊地进行着。另一个是看不见、摸不着的观念世界。 在那里，人们时刻在形成、比较、交换和修正对未来的预期。\n\n\n每个人生活在世界上，都至少面临四种最基本的约束，那就是： 东西不够、时间有限、相互依赖、需要协调。\n\n——《薛兆丰经济学讲义》"
  },
  {
    "objectID": "posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index.html",
    "href": "posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index.html",
    "title": "Single-cell Workshop 2021 - 01 - scRNASeq 分析基础",
    "section": "",
    "text": "学习资料：https://holab-hku.github.io/Fundamental-scRNA/"
  },
  {
    "objectID": "posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index.html#准备",
    "href": "posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index.html#准备",
    "title": "Single-cell Workshop 2021 - 01 - scRNASeq 分析基础",
    "section": "准备",
    "text": "准备\n软件包\n载入下面的包，如果没有就先安装下。\n\nlibrary(Seurat)\n\nAttaching SeuratObject\n\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(hdf5r)\n\n数据\n下载数据：\n\nData used in this material is a 10k PBMC data getting from 10x Genomics website\nhttps://github.com/holab-hku/Fundamental-scRNA/blob/master/data/10k_PBMC.h5"
  },
  {
    "objectID": "posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index.html#单细胞技术介绍",
    "href": "posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index.html#单细胞技术介绍",
    "title": "Single-cell Workshop 2021 - 01 - scRNASeq 分析基础",
    "section": "单细胞技术介绍",
    "text": "单细胞技术介绍\n技术流程\n单细胞RNA测序（scRNA-seq）包括一系列技术，以产生许多单个细胞的全基因组表达数据。\n\n细胞分离\n根据技术主要可以分为两类：Droplet-based 和 Non droplet-based。\nDroplet-based：\n\n组织样品必须解离成悬浮液\n细胞将被单独封装成一个油包水滴\n高通量，低成本\n相关技术：Drop-seq (Macosko et al. 2015), inDrop (Klein et al. 2015), Chromium 10X (Zheng et al. 2017)\n\nNon droplet-based：\n\nSmart-seq2 (Ramsköld et al. 2012)：用微型毛细管移液器手工细胞取样\nCEL-seq (Hashimshony et al. 2012)：单个细胞被添加到试管中；第一个介绍了条形码和RNA聚合\nMARS-seq (Jaitin et al. 2014)是第一个使用FACS将单细胞分离到单孔中的方法，优化版MARS-seq2 (Keren-Shaul et al. 2019)的推出成本更低，可重复性更高，井间污染更少\n\n下图显示了一些常见的单细胞分离技术（Hwang, Lee, and Bang 2018）\n\n\n\nSingle Cell Isolation (modified from Hwang, Lee, and Bang 2018)\n\n\n条形码和唯一分子标识符（UMI）\n双端测序输出两个 fastq 文件，分别对应测序的5′和3′方向。使用这种测序技术，配对的第一个read总是与引物的细胞（条形码+UMI）部分一致。\n\n\n\nBiased paired-end reads (David Tse et.al)\n\n\n根据获得的细胞条形码、UMI 和 cDNA 的 reads，我们可以估计转录物的丰度。这允许 mapping 算法区分哪些序列是条形码，哪些是转录序列。因此，在确定细胞条形码和 UMI 条形码序列的长度和位置时，识别用于测序的文库制备化学方法非常重要。\n为了获得 UMIs 的计数，我们可以首先通过细胞条形码对 reads 进行分组，然后对齐 cDNA reads 并使用 UMIs 对每个细胞每个基因的独特分子进行计数。\n\n\n\nGrouping barcodes to assign reads to cells (modified from David Tse et.al)\n\n\n对细胞条形码和 UMIs 的分析包括在校准过程中，我们将在下一节中介绍更多内容。\n广泛应用的scRNA-seq技术汇总\n\n\nMethods\nTranscript coverage\nUMI possibility\nStrand specific\nReferences\n\n\n\nTang method\nNearly full-length\nNo\nNo\nTang et al. (2009)\n\n\nQuartz-Seq\nFull-length\nNo\nNo\nSasagawa et al. (2013)\n\n\nSUPeR-seq\nFull-length\nNo\nNo\nX. Fan et al. (2015)\n\n\nSmart-seq\nFull-length\nNo\nNo\nRamsköld et al. (2012)\n\n\nSmart-seq2\nFull-length\nNo\nNo\nPicelli et al. (2013)\n\n\nMATQ-seq\nFull-length\nYes\nYes\nSheng et al. (2017)\n\n\nSTRT-seq STRT/C1\n5′-only\nYes\nYes\nIslam et al. (2011)\n\n\nCEL-seq\n3′-only\nYes\nYes\nHashimshony et al. (2012)\n\n\nCEL-seq2\n3′-only\nYes\nYes\nHashimshony et al. (2016)\n\n\nMARS-seq\n3′-only\nYes\nYes\nJaitin et al. (2014)\n\n\nCytoSeq\n3′-only\nYes\nYes\nH. C. Fan, Fu, and Fodor (2015)\n\n\nDrop-seq\n3′-only\nYes\nYes\nMacosko et al. (2015)\n\n\nInDrop\n3′-only\nYes\nYes\nKlein et al. (2015)\n\n\nChromium\n3′-only\nYes\nYes\nZheng et al. (2017)\n\n\nSPLiT-seq\n3′-only\nYes\nYes\nRosenberg et al. (2018)\n\n\nsci-RNA-seq\n3′-only\nYes\nYes\nCao et al. (2017)\n\n\nSeq-Well\n3′-only\nYes\nYes\nGierahn et al. (2017)\n\n\nDroNC-seq\n3′-only\nYes\nYes\nHabib et al. (2017)\n\n\nQuartz-Seq2\n3′-only\nYes\nYes\nSasagawa et al. (2018)"
  },
  {
    "objectID": "posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index.html#预处理和质量控制",
    "href": "posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index.html#预处理和质量控制",
    "title": "Single-cell Workshop 2021 - 01 - scRNASeq 分析基础",
    "section": "预处理和质量控制",
    "text": "预处理和质量控制\nFASTQ 文件\n原始 RNA 测序数据可能在 FASTQ 文件中。它是一种基于文本的格式，用于存储由单字母代码表示的读序列。 FASTQ 文件中的序列以@符号开头的readID开始，然后是序列数据行，一个简单的加号+分隔符和碱基质量分数。\n它以以下格式表示:\n@ReadID\nREAD SEQUENCE\n+\nSEQUENCING QUALITY SCORES\n一般来说，fastq 文件是使用质量控制工具（如 FastQC）进行预处理的。这将输出一系列评估序列 reads 质量的指标。\nCell Ranger\nCell Ranger 是一组分析管道，用于处理 Chromium 单细胞数据以对齐 reads，生成特征条形码矩阵，执行聚类和其他二次分析等等。 它帮助我们生成 RNA reads 计数矩阵，我们将在学习中使用。\n一些概念：\n\nGEM 孔（以前称为 GEM 组）：来自单个 10x Chromium™ 芯片通道的分隔单元（凝胶颗粒悬浮液）集合。可以从一个 GEM 孔中获得一个或多个测序文库。\n文库（或测序文库）：从单个 GEM 孔中制备的带有 10x 条形码的测序文库。借助特征条形码或 V(D)J 分析，可以从同一个 GEM 孔中创建多个文库。文库类型可能包括基因表达、抗体捕获、CRISPR 引导捕获、TCR 富集等。\n测序 Run（或 Flowcell）: A flowcell containing data from one sequencing instrument run.（这个从英文直译上很难理解，通俗的说就是一次上机测序得到的数据流）\n\n通用流程\n从 Chromium 10X 管道获得的单细胞数据可以使用 cellranger 通过以下工作流程进行处理。\n\n\n\nCellranger Workflow (taken from the cellranger website)\n\n\n输出文件\n下面是我们将从 cellranger 获得的输出文件夹。outs 文件夹包含最终的管道输出文件，其中包括我们需要用于下游分析的内容。\n\n\nOverview of the folder generate from cellranger\n\n\n\nOverview of the outs folder\n\n以上是我们可以在outs文件夹中找到的内容。它包含了一些测序数据的总结信息，注释的读取序列，以及我们通常工作的基因表达矩阵。下面是我们想看的一些重要的输出文件。\n\nMatrices\nWeb Summary .html\nSecondary Analysis CSV\nBAM\nMolecule Info (h5)\nLoupe File (.cloupe)\n\n矩阵\n测序时，Chromium 10X 不仅对转录组进行测序，还对任何可能的分子进行测序。这就导致了背景条形码的存在。细胞相关条形码是cellranger 认为标记来自真实细胞的转录组而不是背景的条形码。\n对于不同版本的cellranger，使用不同的算法来检测细胞相关条形码。一般的想法是，细胞的条形码应该比背景条形码有更多的转录本计数。更多信息请访问：https://kb.10xgenomics.com/hc/en-us/articles/115003480523-How-are-barcodes-classified-as-cell-associated-。\ncellranger管道输出两种类型的特征条形码矩阵：\n\n未经过滤的特征条形码矩阵存储在raw_feature_bc_matrix（1-1）文件夹下。它包含了来自已知良好条形码序列固定列表的每个条形码，其中至少有一个读取，这意味着它包括背景和与细胞相关的条形码。\n经过过滤的特征条形码矩阵存储在filtered_feature_bc_matrix（1-2）文件夹下。它只包括已检测到的与细胞相关的条形码。\n\nraw_feature_bc_matrix和filtered_feature_bc_matrix文件夹中都包含三个文件。\n\nmatrix.mtx.gz文件以稀疏矩阵的形式存储 reads 计数，其中每一行表示scRNA-seq数据中的一个基因，每一列表示一个细胞。行索引的信息存储在features.tsv.gz文件中，而列索引的信息存储在barcodes.tsv.gz文件中。\nfeatures.tsv.gz文件对应于行索引。在scRNA-seq数据中，“features”实际上指的是基因。features.tsv.gz文件包含三列：feature ID：参考GTF文件的注释字段中的gene_id，表示特征的ID。 name：参考GTF文件的注释字段中的gene_name，如果参考GTF中没有gene_name字段，则基因名称等同于基因ID。 type of feature：描述特征类型，可以是Gene Expression、Antibody Capture、CRISPR或CUSTOM之一。对于scRNA-seq数据，它将是Gene Expression（基因表达）。\nbarcodes.tsv.gz对应于列索引，它包含了每个列的条形码。有关条形码序列格式的更多详细信息，请参考条形码BAM部分。\n\nWeb Summary .html\n一个概要的HTML文件包含了摘要指标和自动化二次分析结果。如果在流程运行期间检测到问题，将在此页面上显示警报。\n该HTML文件包括两个部分，SUMMARY（摘要）和ANALYSIS（分析）。您还可以点击每个仪表板顶部的“?”以获取有关每个指标的更多信息。\n\nSUMMARY（摘要）指标描述了测序质量和检测到的细胞的各种特征。在页面顶部附近醒目地显示了检测到的细胞数量、每个细胞的平均reads数以及每个细胞检测到的基因的中位数。\n\n\n\nCells dashboard (modified from the cellranger website)\n\n\n在“Cells”仪表板下的“Barcode Rank Plot”显示了条形码计数的分布以及被推断与细胞相关的条形码。y轴表示每个条形码映射到的UMI计数，x轴表示低于该值的条形码数量。陡峭的下降表示细胞关联的条形码与与空分区相关的条形码之间有良好的分离。条形码可以通过其UMI计数或其RNA配置文件确定为与细胞相关，因此图表的某些区域可能同时包含细胞关联和背景关联的条形码。图表的颜色表示与细胞关联的条形码的局部密度。\n\n\n\nSequencing and Mapping dashboards (modified from the cellranger website)\n\n其他用于评估的指标：\n\n\nEstimated Number of Cells: 500-10,000\n\nMean Reads per Cell: 20,000 reads/cell minimum recommended reads per cell around 10,000\n\nValid barcodes: greater than 75%\n\nQ30 bases in RNA read: ideally greater than 65%\n\nReads mapped confidently to transcriptome: ideally greater than 30%\n\nReads mapped antisense to gene: ideally smaller than 10%\n\n\n分析（ANALYSIS）指标包括以下自动化的二次分析：\n\n\n降维分析：将细胞投影到二维空间（t-SNE），以展示它们之间的关系。\n自动聚类分析：将具有相似表达特征的细胞分组在一起，形成聚类。\n差异表达基因列表：列出在所选聚类之间表达差异显著的基因。\n显示测序深度降低对观察到的文库复杂性的影响的图表。\n显示测序深度降低对每个细胞检测到的平均基因数的影响的图表。\n\nBAM\nBAM文件以二进制压缩格式保存了关于 mapping reads 的信息。它由可选的头部部分和对齐部分组成。如果存在头部部分，它将通过第一列中的@与对齐部分区分，并位于对齐部分之前。\n当解压缩成SAM文件时，信息以制表符分隔的表格形式存储，其中包含一些标准列和由 Cell Ranger 软件生成的特定列。Cell Ranger特定的列包含与 BAM 条形码、BAM 对齐和特征条形码相关的信息。标准列对应以下内容：\nQNAME : read name (generally will include UMI barcode if applicable)\nFLAG : number tag indicating the “type” of alignment, link to explanation of all possible “types”\nRNAME : reference sequence name (i.e. chromosome read is mapped to).\nPOS : leftmost mapping position\nMAPQ : Mapping quality\nCIGAR : string indicating the matching/mismatching parts of the read (may include soft-clipping).\nRNEXT : reference name of the mate/next read\nPNEXT : POS for mate/next read\nTLEN : Template length (length of reference region the read is mapped to)\nSEQ : read sequence\nQUAL : read quality\n可以使用 SAMtools 查看 BAM 文件：\nsamtools view output.bam\n为了进行基于 RNA 速率的轨迹分析，需要 bam 文件。\n分子信息（h5）\n它是一个 HDF5 文件，包含有效条形码和有效 UMI 的所有分子的每分子信息，并以高置信度分配给基因或特征条形码。该 HDF5 文件包含与观察到的分子相对应的数据，以及有关所使用的库和特征集的数据。这个文件的结构是：\n\n\nHDF5 File Hierarchy(taken from the cellranger website)\n\n二级分析 CSV 文件\n包含自动辅助分析结果的几个 CSV 文件。它包含有关降维、t-SNE、UMAP、聚类和差分表达的信息。它也通过Web Summary.html文件在ANALYSIS度量中可视化。\nLoupe 文件 (.cloupe)\nLoupe Browser 是一款桌面应用程序，提供与10x Genomics解决方案的数据进行交互式可视化分析的功能。它可以帮助寻找感兴趣的细胞、发现重要基因、识别细胞类型、探索细胞亚结构、研究细胞亚型、集成基因表达和V(D)J分析，并共享结果。\n通过 Loupe Browser 可以查看 Loupe 文件，该文件包含以下信息：\n\n样本中细胞的基因表达信息。\n细胞的各种基于基因表达的聚类信息，包括t-SNE和UMAP投影以及差异基因表达情况。\n来自转录组参考的基因注释信息。\nSTARsolo\nSTARsolo（Kaminow，Yunusov和Dobin 2021）是一个专为液滴式单细胞RNA测序数据（例如10X Genomics Chromium系统）设计的分析工具，直接内嵌在STAR代码中。STARsolo的输入是一个FASTQ文件，它可以以与Cell Ranger几乎相同的格式输出基因计数，但速度约快10倍。\nSTARsolo 程序输出大量反映 reads 比对过程细节的文件。在这里，我们只讨论其中一些关键文件。\n\n\nSTARsolo Output\n\n\nBAM文件包含有关比对 reads 的信息，与通过Cell Ranger生成的BAM文件非常相似。\n比对摘要文件Features.stats和Summary.csv包含有关基本比对细节的信息。这可以作为对比对过程进行简单初步质量控制检查的便捷工具。\n特征矩阵文件matrix.mtx包含每个个体细胞中映射的基因计数信息。列名对应于每个个体细胞的条形码，行名对应于所有注释的基因。由于该数据的规模较大，它以稀疏矩阵的形式存储。\n辅助文件 barcodes.tsv 和 features.tsv 提供了下游分析所需的额外元数据。这些文件连同矩阵文件在功能上扮演着与Cell Ranger输出中的 Matrices 部分相同的角色，并且在金标准的 scRNA-seq 数据分析软件 seurat 中进行分析时是必需的。\nDoublets\n双细胞是指虽然设计为由一个细胞生成，但却是由两个细胞生成的人工文库。通常这是由于细胞分选或捕获过程中的错误引起的。\n可以使用几种实验策略来去除双细胞：\n\n基于不同供体个体之间的自然遗传变异（Kang等人，2018）。\n使用与不同寡核苷酸结合的抗体标记一组细胞（例如，来自一个样本的所有细胞）。在混合后，观察到具有不同寡核苷酸的文库被视为双细胞并移除（Bach等人，2017）。\n仅基于表达谱的计算方法（如模拟）推断双细胞并进行去除。"
  },
  {
    "objectID": "posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index.html#使用-seurat-进行分析",
    "href": "posts/2023-07-13-fundamentals-of-scrnaseq-analysis/index.html#使用-seurat-进行分析",
    "title": "Single-cell Workshop 2021 - 01 - scRNASeq 分析基础",
    "section": "使用 Seurat 进行分析",
    "text": "使用 Seurat 进行分析\n本节的内容是根据Seurat - Guided Clustering Tutorial进行了一些修改和适应。我们使用的数据是从10x Genomics网站获取的10k PBMC数据。\n我们将学习如何读取10X测序数据并将其转换为Seurat对象，进行质控和选择用于进一步分析的细胞，对数据进行归一化处理，识别高可变特征（特征选择），对数据进行缩放，进行线性降维和可视化分析。\nSeurat 对象\nSeurat对象充当一个容器，其中包含单个单细胞数据集的数据（如计数矩阵）和分析（如PCA或聚类结果）。在使用 Seurat 分析scRNA-seq数据之前，我们可以先从这里对Seurat对象有一些基本的了解。\n设置Seurat对象\n\nlibrary(dplyr)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(ggplot2)\n\n我们从读入数据开始。Read10X_h5从10X CellRanger hdf5文件读取计数矩阵，返回唯一的分子识别（UMI）计数矩阵。该矩阵中的值表示每个特征（即基因；行）在每个细胞（列）中检测到的表达量。它可用于读取scATAC-seq和scRNA-seq矩阵。\n接下来我们使用计数矩阵来创建一个Seurat对象。\n\n# Load the PBMC dataset\npbmc.data &lt;- Read10X_h5(\"/Users/wsx/Library/CloudStorage/OneDrive-shanghaitech.edu.cn/Public/data/10k_PBMC.h5\")\n# Initialize the Seurat object with the raw (non-normalized data).\npbmc &lt;- CreateSeuratObject(counts = pbmc.data, project = \"pbmc10k\", min.cells = 3, min.features = 200)\npbmc\n\nAn object of class Seurat \n22432 features across 10813 samples within 1 assay \nActive assay: RNA (22432 features, 0 variable features)\n\n\n如果我们想直接使用 cellranger 管道从 10X 读取数据，我们可以使用 Read10X()。\n标准预处理流程\n以下步骤包含了 Seurat 中 scRNA-seq 数据的标准预处理工作流程。它们基于我们将从 Cell Ranger 或 STARsolo 输出中获得的 RNA reads 计数矩阵。标准的预处理工作流程代表了基于 QC 指标的细胞选择和过滤，数据归一化和缩放，以及高度可变特征的检测。\nQC 和细胞过滤\nSeurat 允许你根据任何用户定义的标准轻松探索 QC 指标和过滤细胞。社区常用的一些质量控制指标（Ilicic et al. 2016）包括：\n\n在每个细胞中检测到的独特基因的数量\n\n低质量的细胞或空液滴通常只有很少的基因\n细胞双胞胎或多胞胎可能表现出异常高的基因计数\n同样，细胞内检测到的分子总数（与独特的基因密切相关）\n\n\nreads 占到线粒体基因组的百分比\n\n低质量/垂死细胞通常表现出广泛的线粒体污染\n我们使用PercentageFeatureSet()函数计算线粒体 QC 指标，该函数计算源自一组特征的计数百分比\n我们用 MT 开头的所有基因集合作为线粒体基因集合\n\n\n\n\n# The [[ operator can add columns to object metadata. This is a great place to stash QC stats\npbmc[[\"percent.mt\"]] &lt;- PercentageFeatureSet(pbmc, pattern = \"^MT-\")\n\n在 CreateSeuratObject() 过程中自动计算唯一基因和总分子的数量。它们存储在对象元数据中。\n\n# Show QC metrics for the first 5 cells in the control group\nhead(pbmc@meta.data, 5)\n\n                   orig.ident nCount_RNA nFeature_RNA percent.mt\nAAACCCAGTATATGGA-1    pbmc10k        860          350 44.1860465\nAAACCCAGTATCGTAC-1    pbmc10k       1548          729  0.4521964\nAAACCCAGTCGGTGAA-1    pbmc10k       6387         1827 10.4117739\nAAACCCAGTTAGAAAC-1    pbmc10k      16664         3744  5.2808449\nAAACCCAGTTATCTTC-1    pbmc10k       3352         1464 13.8424821\n\n\n我们可以可视化 nFeature_RNA, nCount_RNA 和 percent.mt 作为 QC 指标。\n与 Cell Ranger 输出一样，以下结果中的 feature 表示基因。 nFeature_RNA 是每个细胞中检测到的基因数量。 nCount_RNA 是细胞内检测到的分子总数。 下图中的每个点代表一个细胞。\n\n# Visualize QC metrics as a violin plot\nVlnPlot(pbmc, features = c(\"nFeature_RNA\", \"nCount_RNA\", \"percent.mt\"), \n        ncol = 3, pt.size = 0.0001)\n\n\n\n\n我们接着使用点图来表示 3 者之间的关系。\n\n# FeatureScatter is typically used to visualize feature-feature relationships, but can be used\n# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.\nplot1 &lt;- FeatureScatter(pbmc, feature1 = \"nCount_RNA\", feature2 = \"percent.mt\") + \n  theme(legend.position=\"none\")\nplot2 &lt;- FeatureScatter(pbmc, feature1 = \"nCount_RNA\", feature2 = \"nFeature_RNA\") + \n  theme(legend.position=\"none\")\nplot1 + plot2\n\n\n\n\n在这里，我们过滤掉具有独特特征计数（基因）超过5000或少于200的细胞。我们也过滤掉线粒体数量大于15%的细胞。\n\npbmc &lt;- subset(pbmc, subset = nFeature_RNA &gt; 200 & nFeature_RNA &lt; 5000 & percent.mt &lt; 15)\n\n然后再一次用提琴图查看过滤后的质量图：\n\n# Visualize QC metrics as a violin plot\nVlnPlot(pbmc, features = c(\"nFeature_RNA\", \"nCount_RNA\", \"percent.mt\"), \n        ncol = 3, pt.size = 0.0001)\n\n\n\nplot1 &lt;- FeatureScatter(pbmc, feature1 = \"nCount_RNA\", feature2 = \"percent.mt\") + \n  theme(legend.position=\"none\")\nplot2 &lt;- FeatureScatter(pbmc, feature1 = \"nCount_RNA\", feature2 = \"nFeature_RNA\") + \n  theme(legend.position=\"none\")\nplot1 + plot2\n\n\n\n\n标准化数据\n从数据集中删除不需要的细胞后，下一步是对数据进行标准化（规范化）。默认情况下，我们使用全局缩放归一化方法“LogNormalize”，该方法通过总表达对每个细胞的特征表达式测量值进行归一化，将其乘以一个比例因子（默认为10,000），并对结果进行对数变换。标准化值存储在pbmc[[\"RNA\"]]@data中。\n\npbmc &lt;- NormalizeData(pbmc, \n          normalization.method = \"LogNormalize\", \n          scale.factor = 10000, verbose = FALSE)\n\n在这里，我们从基因表达矩阵中采样 10,000 个reads计数，分别可视化标准化前后的基因表达分布（不包括零）。\n\n# set seed and put two plots in one figure\nset.seed(123)\npar(mfrow=c(1,2))\n# original expression distribution\nraw_geneExp = as.vector(pbmc[['RNA']]@counts) %&gt;% sample(10000)\n\nWarning in .sparse2v(x): sparse-&gt;dense coercion: allocating vector of size 1.6\nGiB\n\nraw_geneExp = raw_geneExp[raw_geneExp != 0]\nhist(raw_geneExp)\n# expression distribution after normalization\nlogNorm_geneExp = as.vector(pbmc[['RNA']]@data) %&gt;% sample(10000)\n\nWarning in .sparse2v(x): sparse-&gt;dense coercion: allocating vector of size 1.6\nGiB\n\nlogNorm_geneExp = logNorm_geneExp[logNorm_geneExp != 0]\nhist(logNorm_geneExp)\n\n\n\n\n识别高度可变的特征（特征选择）\n接下来，我们计算数据集中表现出高细胞间差异的特征子集（即，它们在一些细胞中高表达，而在其他细胞中低表达）。研究表明(Brennecke et al. 2013)在下游分析中关注这些基因有助于突出单细胞数据集中的生物信号。\nSeurat中的过程详细描述在文献 Stuart et al. 2019 中，FindVariableFeatures()函数中实现直接建模单细胞数据中固有的均值-方差关系来改进以前的版本。默认情况下，Seurat每个数据集返回2000个特征，这些特征将用于下游分析，如PCA。\n\npbmc &lt;- FindVariableFeatures(pbmc, selection.method = \"vst\", nfeatures = 2000, verbose = FALSE)\n\n# Identify the 10 most highly variable genes\ntop10 &lt;- head(VariableFeatures(pbmc), 10)\n\n# plot variable features with and without labels\nplot1 &lt;- VariableFeaturePlot(pbmc) + \n  theme(legend.position=\"top\")\nplot2 &lt;- LabelPoints(plot = plot1, points = top10, repel = TRUE) + \n  theme(legend.position=\"none\")\n\nWhen using repel, set xnudge and ynudge to 0 for optimal results\n\nplot1 + plot2\n\nWarning: Transformation introduced infinite values in continuous x-axis\nTransformation introduced infinite values in continuous x-axis\n\n\n\n\n\n缩放数据\n接下来，我们应用线性变换(“缩放”)，这是在PCA等降维技术之前的标准预处理步骤。函数ScaleData()：\n\n移动每个基因的表达，使细胞间的平均表达为 0。\n缩放每个基因的表达，使细胞间的方差为 1。这一步在下游分析中具有同等的权重，因此高表达基因不会占主导地位。\n结果存储在 pbmc[[\"RNA\"]]@scale.data。\n\n\nall.genes &lt;- rownames(pbmc)\npbmc &lt;- ScaleData(pbmc, features = all.genes, verbose = FALSE)\n\n在使用上述命令时，我们使用所有基因来缩放数据。缩放是 Seurat 工作流程中的重要步骤，但仅限于将用作 PCA 输入的基因。因此，ScaleData()中的默认仅对先前确定的可变特征（默认值为2000）执行缩放。这将使这一步更快。\n在这种情况下，我们的PCA和聚类结果将不受影响。然而，Seurat 热图（用DoHeatmap()生成，如下图所示）需要对热图中的基因进行缩放，以确保高表达的基因不会在热图中占主导地位。我们在本教程中缩放了所有基因。\nScaleData()函数还允许我们从单个单细胞数据集中删除不需要的变异源。例如，我们可以通过回归移除细胞周期阶段或线粒体污染相关的异质性。这个特性可以通过指定vars.to.regress来实现。即：\n# skip here\npbmc &lt;- ScaleData(pbmc, vars.to.regress = \"percent.mt\")\n但是，特别是对于想要使用此功能的高级用户，Seurat 建议使用他们新的标准化工作流 SCTransform()。该方法在 Seurat 论文(Hafemeister and Satija 2019)中进行了描述，并有一个单独的技术文档。与ScaleData() 一样，函数SCTransform()也包含一个vars.to.regress参数。\n执行线性降维\n接下来，我们对缩放后的数据执行 PCA。默认情况下，只使用先前确定的可变特征作为输入，但是如果你希望选择不同的子集，则可以使用 features 参数定义。\n\npbmc &lt;- RunPCA(pbmc, features = VariableFeatures(object = pbmc), verbose = FALSE)\n\nSeurat提供了几种有用的方法来可视化定义 PCA 的细胞和特征，包括VizDimLoadings()、DimPlot() 和 DimHeatmap()。\n\n# Examine and visualize PCA results a few different ways\nprint(pbmc[[\"pca\"]], dims = 1:5, nfeatures = 5)\n\nPC_ 1 \nPositive:  LTB, IL32, TRAC, CD3D, TRBC2 \nNegative:  FCN1, FGL2, CST3, IFI30, TYMP \nPC_ 2 \nPositive:  MS4A1, CD79A, BANK1, IGHM, NIBAN3 \nNegative:  IL32, GZMM, CD3D, CD7, CD247 \nPC_ 3 \nPositive:  GZMB, CLIC3, NKG7, GNLY, KLRD1 \nNegative:  CCR7, LEF1, TRABD2A, TCF7, LTB \nPC_ 4 \nPositive:  CD79B, MS4A1, GNLY, CD79A, LINC00926 \nNegative:  LILRA4, CLEC4C, SERPINF1, TPM2, SCT \nPC_ 5 \nPositive:  CDKN1C, HES4, CTSL, TCF7L2, BATF3 \nNegative:  S100A12, ITGAM, VCAN, CES1, MGST1 \n\n\n\nVizDimLoadings(pbmc, dims = 1:2, reduction = \"pca\")\n\n\n\n\n\nDimPlot(pbmc, reduction = \"pca\")\n\n\n\n\n特别是 `DimHeatmap() 允许轻松地探索数据集中异构的主要来源，并且在试图决定将哪些pc包括在进一步的下游分析中时非常有用。\n\nDimHeatmap(pbmc, dims = 1, cells = 500, balanced = TRUE)\n\n\n\n\n\nDimHeatmap(pbmc, dims = 1:9, cells = 500, balanced = TRUE)\n\n\n\n\n为了克服scRNA-seq数据中任何单个特征中广泛的技术噪声，Seurat基于它们的PCA分数对细胞进行聚类，每个 PC 本质上代表一个“元特征”，该元特征结合了相关特征集中的信息。因此，顶部主成分代表了数据集的鲁棒压缩。在这里，我们选择前20 个 PC。\n细胞聚类\nSeurat v3采用了基于图的聚类方法，基于(Macosko等人，2015)中的初始策略进行改进。重要的是，驱动聚类分析的距离度量（基于先前确定的主成分）保持不变。然而，Seurat在将细胞距离矩阵划分为聚类的方法有了显著改进。这种方法受到最近一些研究的启发，这些研究将基于图的聚类方法应用于scRNA-seq数据（Xu和Su，2015）和CyTOF数据（Levine等人，2015）。简而言之，这些方法将细胞嵌入到一个图结构中，例如K最近邻（KNN）图，其中类似特征表达模式的细胞之间有边连接，然后尝试将该图划分为高度相互连接的“拟团”或“社区”。\n就像PhenoGraph一样，首先根据PCA空间中的欧氏距离构建了一个K最近邻图，然后根据局部邻域中的重叠情况（Jaccard相似性）调整任意两个细胞之间的边权重。这个步骤是使用FindNeighbors()函数完成的，它的输入是之前定义的数据集的维度（前20个主成分）。\n为了对细胞进行聚类，接下来我们应用模块度优化技术，如Louvain算法（默认）或SLM（Blondel等人，2008），以迭代地将细胞分组在一起，目标是优化标准的模块度函数。FindClusters()函数实现了这个过程，并包含一个分辨率参数，用于设置下游聚类的“粒度”，增大的值会导致更多的聚类。我们发现，在大约3K个细胞的单细胞数据集中，将此参数设置在 0.4-1.2 之间通常会得到良好的结果。对于更大的数据集，通常需要增加最佳分辨率。可以使用Idents()函数找到这些聚类。\n\npbmc &lt;- FindNeighbors(pbmc, dims = 1:20, verbose = FALSE)\npbmc &lt;- FindClusters(pbmc, resolution = 0.5, verbose = FALSE)\n\n\n# Look at cluster IDs of the first 5 cells\nhead(Idents(pbmc), 5)\n\nAAACCCAGTATCGTAC-1 AAACCCAGTCGGTGAA-1 AAACCCAGTTAGAAAC-1 AAACCCAGTTATCTTC-1 \n                 2                  4                  2                  8 \nAAACCCAGTTGCCGAC-1 \n                 0 \nLevels: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15\n\n\n运行非线性降维 UMAP/tSNE\nSeurat提供多种非线性降维技术，例如tSNE和UMAP，用于可视化和探索这些数据集。这些算法的目标是学习数据的潜在流形，以便将相似的细胞放置在低维空间中的一起。在上述基于图的聚类中确定的细胞应在这些降维图中共同定位。作为UMAP和tSNE的输入，我们建议使用与聚类分析相同的主成分作为输入。\n\npbmc &lt;- RunUMAP(pbmc, dims = 1:20, verbose = FALSE)\n\nWarning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric\nTo use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'\nThis message will be shown once per session\n\n\n然后得到单细胞聚类结果的UMAP图。\n\nDimPlot(pbmc, reduction = \"umap\")\n\n\n\n\n类似地，tSNE。\n\npbmc &lt;- RunTSNE(pbmc, dims = 1:20, verbose = FALSE)\nDimPlot(pbmc, reduction = \"tsne\")\n\n\n\n\n贴上聚类标签：\n\nDimPlot(pbmc, reduction = \"umap\", label = TRUE)\n\n\n\nplot &lt;- DimPlot(object = pbmc)\nLabelClusters(plot = plot, id = 'ident')\n\n\n\n\n是时候保存我们的分析结果了：\n\nsaveRDS(pbmc, \nfile = \"/Users/wsx/Library/CloudStorage/OneDrive-shanghaitech.edu.cn/Public/data/pbmc_processed.rds\")"
  },
  {
    "objectID": "posts/2023-07-18-journal/index.html",
    "href": "posts/2023-07-18-journal/index.html",
    "title": "2023-07-18",
    "section": "",
    "text": "Without hard work, nothing grows but weeds."
  },
  {
    "objectID": "posts/2023-07-20-journal/index.html",
    "href": "posts/2023-07-20-journal/index.html",
    "title": "2023-07-20",
    "section": "",
    "text": "今天很是犯困😪，很困。\n可能因为要早起找人签字，中午睡得昏昏沉沉。\n可能今天早上下午都有会议，坐久后的麻痹。\n可能今天精神太过紧绷，站中特别资助没上，又一直在编写和测试分析流程。\n总之，今天确实很犯困。一天看是什么都没做，但好歹有了记录，记录今天大体发生过什么。\n😪"
  },
  {
    "objectID": "posts/2023-07-21-how-do-you-think-bioinformatics-in-science/index.html",
    "href": "posts/2023-07-21-how-do-you-think-bioinformatics-in-science/index.html",
    "title": "你认同生物信息学不属于科学吗？",
    "section": "",
    "text": "刚看到 Zuguang Gu 发的推文，唔，国内生物学术界有这种看法我是生气的，并认为可耻。 因为这里的某个研究机构在收到求职信时，都没有了解过这个领域和它的贡献就妄下评判。 这体现一种自傲与无知。就没有想过世界存在即有理由吗？评估学术求职者考虑的不应该是 学科建设的契合度，求职人的科研态度、经历、成果吗？\n如果对技术的基础探索不属于科学范畴，那当前热门改造世界的伟大技术，比如CRISPR，那些研究、优化和利用它的人是不是也都不是在做科学呢？😄\n那些在实验室搬砖的打工人，那些在提蛋白的结构生物学研究生，那些将被技术/机器取代的科研岗位，他们都不属于科研吗？\n学术，永远是对知识和创新无穷探索的贡献，而无关方式。\n我其实愈加认识到，学术界，特别是国内的，还是人的江湖。关于人，我是既鄙夷又赞美。 我也不知道未来如落叶的我会飘向何方，且行且看，但我越来越感觉，尽力保持一颗“童心”才能不负生命。"
  },
  {
    "objectID": "posts/2023-07-21-academic-culture/index.html",
    "href": "posts/2023-07-21-academic-culture/index.html",
    "title": "学术的价值观",
    "section": "",
    "text": "这篇小文主要是记录、推荐和分享下吴思涵 Lab 的科学价值观条目。\n\n我觉得非常好，也非常佩服吴思涵创建这个条目和对每个进入 Lab 的成员进行宣读。\n有时候，科研工作的环境的喧嚣让人煎熬。在心中悬着一把价值之剑🗡️，我觉得既是告诫，也是指引。 这把剑有离得近和离得远的时候，但如果没有它，我们的心中会缺乏终极目标🎯。 科学的路，是永无止境的，我们一直在寻觅、挣扎、成长，也弯弯曲曲地走向岁月长河的下一步， 但是否在前进、是否在后退，是否能永远前进、是否会永远后退，真的不知道。\n当前，全国进入了“卷”时代，respect science value, keep deep think。"
  },
  {
    "objectID": "posts/2023-07-25-journal/index.html",
    "href": "posts/2023-07-25-journal/index.html",
    "title": "2023-07-25",
    "section": "",
    "text": "为什么事情容易堆积在一起发生？\n为什么越忙的时候越不想忙？忙的时候越容易分散精力？\n这是人类的什么心理呢？\n那些先圣先贤们究竟是如何塑造的呢？\n是什么在压抑着思潮，捶打着自信？\n怎样才能把想做的真正做好？不关注别人？多关注别人？\n哪里是智慧的真谛，生命的妙门？"
  },
  {
    "objectID": "posts/2023-07-25-small-notes/index.html",
    "href": "posts/2023-07-25-small-notes/index.html",
    "title": "小记（往昔）",
    "section": "",
    "text": "以时间倒序的形式备份下「小记」中写的部分诗。\n\n贺妻小记\n山水在回响你的生辰，\n我从中窥探生命的印记。\n缘来了——\n我作亭亭夏日的莲，\n你作微风，\n荡开我湖心。\n\n\n写于二十九\n实岁添九虚添十，\n已望天命瘦肚迟。\n天南地北终须尽，\n人到桥头有诀期。\n\n\n无题\n翠绿叠墨色，\n烟柳入江波。\n排水碧空尽，\n推云眺山郭。\n\n\n无题\n雨骤风萧天易冷，\n寒推漏窗夜捶门。\n鸟叫迟起难行早，\n世事情劫难度成。\n\n\n八月十四与妻登白云山\n山林日曳金明灭，\n乔木深深松涧叠。\n晚起上白云，\n双双汗水淋。\n来时云遮月，\n去时月动人。\n清风频相送，\n人月了无痕。\n\n\n二月\n人道江南好颜色，\n冷风吹起亮春泽。\n近观粉花掩半绿，\n远眺乌波驻高楼。\n骑行频闻鸣翠柳，\n游思偶得壮年愁。\n愿此人间多欢乐，\n笑声归处了白头。"
  },
  {
    "objectID": "posts/2023-07-26-clustering-and-cell-type-identification/index.html",
    "href": "posts/2023-07-26-clustering-and-cell-type-identification/index.html",
    "title": "Single-cell Workshop 2021 - 02 - 聚类和细胞类型鉴定",
    "section": "",
    "text": "学习资料：GitHub 地址"
  },
  {
    "objectID": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#数据下载",
    "href": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#数据下载",
    "title": "Single-cell Workshop 2021 - 02 - 聚类和细胞类型鉴定",
    "section": "数据下载",
    "text": "数据下载\n我们将使用包含大约10K个单细胞的PBMC数据集。这个数据集是由10X基因组公司公开提供的，可以从 https://www.dropbox.com/s/wn4mgwkkzqw2pox/SC3_v3_NextGem_DI_PBMC_10K_filtered_feature_bc_matrix.h5?dl=0 下载。"
  },
  {
    "objectID": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#准备",
    "href": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#准备",
    "title": "Single-cell Workshop 2021 - 02 - 聚类和细胞类型鉴定",
    "section": "准备",
    "text": "准备\n这个文章的内容灵感来自多个Seurat 文档。它假定你已经熟悉了最初的质控步骤。我们将从由cellranger生成的数据 x 细胞过滤矩阵开始，这是大多数分析的常见起点。\n我们将专注于单细胞RNA测序分析的两个具体关键任务：聚类和对已识别聚类的注释。"
  },
  {
    "objectID": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#安装包",
    "href": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#安装包",
    "title": "Single-cell Workshop 2021 - 02 - 聚类和细胞类型鉴定",
    "section": "安装包",
    "text": "安装包\ninstall.packages(\"Seurat\")\ninstall.packages(\"hdf5r\")\ninstall.packages(\"clustree\")\ninstall.packages(\"BiocManager\")\nBiocManager::install(\"SingleR\")\nBiocManager::install(\"celldex\")\n加载：\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(Seurat)\n\nAttaching SeuratObject\n\nlibrary(patchwork)\nlibrary(clustree)\n\nLoading required package: ggraph\n\n\nLoading required package: ggplot2\n\nlibrary(SingleR)\n\nLoading required package: SummarizedExperiment\n\n\nLoading required package: MatrixGenerics\n\n\nLoading required package: matrixStats\n\n\n\nAttaching package: 'matrixStats'\n\n\nThe following object is masked from 'package:dplyr':\n\n    count\n\n\n\nAttaching package: 'MatrixGenerics'\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,\n    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,\n    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,\n    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,\n    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,\n    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,\n    colWeightedMeans, colWeightedMedians, colWeightedSds,\n    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,\n    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,\n    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,\n    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,\n    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,\n    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,\n    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,\n    rowWeightedSds, rowWeightedVars\n\n\nLoading required package: GenomicRanges\n\n\nLoading required package: stats4\n\n\nLoading required package: BiocGenerics\n\n\n\nAttaching package: 'BiocGenerics'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    combine, intersect, setdiff, union\n\n\nThe following objects are masked from 'package:stats':\n\n    IQR, mad, sd, var, xtabs\n\n\nThe following objects are masked from 'package:base':\n\n    anyDuplicated, aperm, append, as.data.frame, basename, cbind,\n    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,\n    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,\n    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,\n    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,\n    table, tapply, union, unique, unsplit, which.max, which.min\n\n\nLoading required package: S4Vectors\n\n\n\nAttaching package: 'S4Vectors'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    first, rename\n\n\nThe following objects are masked from 'package:base':\n\n    expand.grid, I, unname\n\n\nLoading required package: IRanges\n\n\n\nAttaching package: 'IRanges'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    collapse, desc, slice\n\n\nLoading required package: GenomeInfoDb\n\n\nLoading required package: Biobase\n\n\nWelcome to Bioconductor\n\n    Vignettes contain introductory material; view with\n    'browseVignettes()'. To cite Bioconductor, see\n    'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'.\n\n\n\nAttaching package: 'Biobase'\n\n\nThe following object is masked from 'package:MatrixGenerics':\n\n    rowMedians\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    anyMissing, rowMedians\n\n\n\nAttaching package: 'SummarizedExperiment'\n\n\nThe following object is masked from 'package:SeuratObject':\n\n    Assays\n\n\nThe following object is masked from 'package:Seurat':\n\n    Assays\n\nlibrary(celldex)\n\n\nAttaching package: 'celldex'\n\n\nThe following objects are masked from 'package:SingleR':\n\n    BlueprintEncodeData, DatabaseImmuneCellExpressionData,\n    HumanPrimaryCellAtlasData, ImmGenData, MonacoImmuneData,\n    MouseRNAseqData, NovershternHematopoieticData"
  },
  {
    "objectID": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#读入数据集并创建一个-seurat-对象",
    "href": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#读入数据集并创建一个-seurat-对象",
    "title": "Single-cell Workshop 2021 - 02 - 聚类和细胞类型鉴定",
    "section": "读入数据集并创建一个 Seurat 对象",
    "text": "读入数据集并创建一个 Seurat 对象\n首先，我们要读取10X测序数据并将其转换为 Seurat 对象。Seurat 对象作为一个容器，最初只包含 UMI 计数矩阵。但我们会向其添加更多的分析内容（例如PCA、聚类结果）。\n我们首先通过使用 Read10X_h5 函数读取计数矩阵，该函数从10X CellRanger hdf5文件中读取计数矩阵。层次数据格式（Hierarchical Data Format，HDF5或H5）提供了数据的更压缩的表示形式。Seurat 软件包包含多个读取函数，具体取决于文件格式。\n在读取数据时，我们会应用基本的质量控制，将低质量的细胞丢弃。\n\npbmc.data &lt;- Read10X_h5(filename=\"/Users/wsx/Library/CloudStorage/OneDrive-shanghaitech.edu.cn/Public/data/SC3_v3_NextGem_DI_PBMC_10K_filtered_feature_bc_matrix.h5\")\npbmc &lt;- CreateSeuratObject(counts = pbmc.data, project = \"pbmc10k\", min.cells = 3, min.features = 200)\npbmc[[\"percent.mt\"]] &lt;- PercentageFeatureSet(pbmc, pattern = \"^MT-\")\npbmc &lt;- subset(pbmc, subset = nFeature_RNA &gt; 200 & nFeature_RNA &lt; 5000 & percent.mt &lt; 15)\n\n接下来，我们计算线粒体RNA在总RNA含量中的百分比贡献。高线粒体含量可能表明正在经历凋亡的低质量细胞。我们根据线粒体含量和每个细胞特征数的分布再次进行质量控制。特征数过低可能表明空的液滴中存在环境RNA污染。特征数过高可能是由于多个细胞被困在同一个液滴中引起的。"
  },
  {
    "objectID": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#数据处理",
    "href": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#数据处理",
    "title": "Single-cell Workshop 2021 - 02 - 聚类和细胞类型鉴定",
    "section": "数据处理",
    "text": "数据处理\n经过质量控制措施以选择继续分析的细胞后，接下来的步骤包括对数据进行归一化、识别高度可变特征以及进行尺度缩放。同时，还会进行主成分分析，因为许多后续分析步骤将在较低维度空间中进行计算。\n\npbmc &lt;- NormalizeData(pbmc)\npbmc &lt;- FindVariableFeatures(pbmc, selection.method = \"vst\", nfeatures = 2000)\nall.genes &lt;- rownames(pbmc)\npbmc &lt;- ScaleData(pbmc, features = all.genes)\n\nCentering and scaling data matrix\n\n\n\npbmc &lt;- RunPCA(pbmc, verbose = FALSE)\n\n前面所有步骤的基本原理都与质量控制相关，在前面的教程中有更详细的介绍。"
  },
  {
    "objectID": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#选择主成分的数量",
    "href": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#选择主成分的数量",
    "title": "Single-cell Workshop 2021 - 02 - 聚类和细胞类型鉴定",
    "section": "选择主成分的数量",
    "text": "选择主成分的数量\n首要的重要决策是在后续分析中保留多少个主成分（PCs）。保留的主成分越多，信号量也会增加，但同时也会增加噪音，并且计算需求也会增加。在做出这个选择之前，请检查与每个主成分相关的基因。存在与特定细胞类型相关的基因将表明该主成分具有信息量。而存在与所有不相关基因名称相关的情况则表明相反。在外周血单个核细胞（PBMC）的背景下，我们预期主要的细胞类型将包括T细胞、B细胞、NK细胞、单核细胞等等。\n检查前 10 个 PC，你会看到很多熟悉的基因名称。\n\nprint(pbmc[[\"pca\"]], dims = 1:10, nfeatures = 5)\n\nPC_ 1 \nPositive:  LTB, IL32, TRAC, CD3D, TRBC2 \nNegative:  FCN1, FGL2, CST3, IFI30, TYMP \nPC_ 2 \nPositive:  MS4A1, CD79A, BANK1, IGHM, NIBAN3 \nNegative:  IL32, GZMM, CD3D, CD7, CD247 \nPC_ 3 \nPositive:  GZMB, CLIC3, NKG7, GNLY, KLRD1 \nNegative:  CCR7, LEF1, TRABD2A, TCF7, LTB \nPC_ 4 \nPositive:  CD79B, MS4A1, GNLY, CD79A, LINC00926 \nNegative:  LILRA4, CLEC4C, SERPINF1, TPM2, SCT \nPC_ 5 \nPositive:  CDKN1C, HES4, CTSL, TCF7L2, BATF3 \nNegative:  S100A12, ITGAM, VCAN, CES1, MGST1 \nPC_ 6 \nPositive:  CDKN1C, NRGN, PADI4, CKB, FCGR3A \nNegative:  CRIP1, GBP5, ISG15, NIBAN1, MAF \nPC_ 7 \nPositive:  CLU, ITGB1, NRGN, LIMS1, GP1BB \nNegative:  MALAT1, CCR7, TXK, LINC02446, KLRK1 \nPC_ 8 \nPositive:  CDKN1C, VIM, S100A4, CKB, ITGB1 \nNegative:  MAP3K7CL, SERPING1, GMPR, LGALS2, NEXN \nPC_ 9 \nPositive:  HERC5, IFIT1, RSAD2, IFIT3, MX1 \nNegative:  CLEC10A, FCER1A, ENHO, CD1C, CACNA2D3 \nPC_ 10 \nPositive:  TNFRSF13B, IGHG1, IGHA1, SSPN, IGFBP7 \nNegative:  TCL1A, CD8A, TRGC2, GZMK, CD8B \n\n\n另一种可视化信息的方法是：\n\nVizDimLoadings(pbmc, dims = 1:2, reduction = \"pca\",balanced=TRUE)\n\n\n\n\n这是另一种提供图示表示的方法。细胞和特征根据主成分分析得分进行排序。设置一个细胞数量有助于计算效率，因为它会忽略那些信息较少的极端细胞。强制使其平衡可在正相关和负相关之间获得相等的表示。\n\nDimHeatmap(pbmc, dims = 1, cells = 500, balanced = TRUE)\n\n\n\n\n\nDimHeatmap(pbmc, dims = 1:15, cells = 500, balanced = TRUE)\n\n\n\n\nJackstraw 图用于估计每个主成分所捕获的结构的显著性。它会随机对数据的子集进行排列，以建立空值分布，并根据这个空值分布估计p值。\n⚠️ 这可能需要一些时间来执行。如果时间不够，请跳过这部分，然后只专注于接下来的拐点图。\n\npbmc &lt;- JackStraw(pbmc, num.replicate = 100)\npbmc &lt;- ScoreJackStraw(pbmc, dims = 1:20)\nJackStrawPlot(pbmc, dims = 1:20)\n\nWarning: Removed 28000 rows containing missing values (`geom_point()`).\n\n\n\n\n\n拐点图是经典的计算机科学方法，用于检查通过逐个添加主成分来表示数据中累积变异性。\n\nElbowPlot(pbmc,ndims=50)\n\n\n\n\n根据这些图，我们选择使用20个主成分。但也可以为15到30之间的任何数量提出理由。\n我们使用UMAP来可视化数据集。我们提前计算UMAP，以便在需要时立即使用。\n\npbmc &lt;- RunUMAP(pbmc, dims = 1:20, verbose = FALSE)\n\nWarning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric\nTo use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'\nThis message will be shown once per session"
  },
  {
    "objectID": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#聚类",
    "href": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#聚类",
    "title": "Single-cell Workshop 2021 - 02 - 聚类和细胞类型鉴定",
    "section": "聚类",
    "text": "聚类\nSeurat默认的聚类算法采用基于图的聚类方法。它受到以前的发表文章的启发，这些文章在开发和改进这种方法方面做出了贡献。特别是，《Phenograph》论文强烈推荐给那些希望更好地理解这种方法的人。简要来说，聚类算法首先在PCA空间中计算每个细胞的K个最近邻。然后，根据共享邻居计算细胞之间的Jaccard相似性。使用Louvain算法对信息进行聚合，以便将细胞迭代地分组在一起。\n\npbmc &lt;- FindNeighbors(pbmc, dims = 1:20)\n\nComputing nearest neighbor graph\n\n\nComputing SNN\n\n\n第二个重要的决策是选择聚类的分辨率。较小的数值会生成混合的聚类，而较大的数值会产生过多的聚类，这些聚类可能不太具有意义。\n📝 对于你自己的研究，花一些时间来优化分辨率的选择是很有帮助的。尝试使用多个候选的分辨率选项来进行所有后续分析可能会有帮助。\n在这里，我们尝试三个不同的分辨率值，并使用clustree来研究其影响。在计算完聚类后，我们还保存了pbmc对象。\n\npbmc &lt;- FindClusters(object = pbmc,  resolution = c(0.5, 1, 1.5),  dims.use = 1:10,  save.SNN = TRUE)\n\nWarning: The following arguments are not used: dims.use, save.SNN\n\n\nSuggested parameter: dims instead of dims.use\n\n\nWarning: The following arguments are not used: dims.use, save.SNN\n\n\nSuggested parameter: dims instead of dims.use\n\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 9729\nNumber of edges: 356102\n\nRunning Louvain algorithm...\nMaximum modularity in 10 random starts: 0.9145\nNumber of communities: 16\nElapsed time: 1 seconds\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 9729\nNumber of edges: 356102\n\nRunning Louvain algorithm...\nMaximum modularity in 10 random starts: 0.8655\nNumber of communities: 20\nElapsed time: 1 seconds\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 9729\nNumber of edges: 356102\n\nRunning Louvain algorithm...\nMaximum modularity in 10 random starts: 0.8279\nNumber of communities: 22\nElapsed time: 1 seconds\n\n\n\nsaveRDS(pbmc, file = \"/Users/wsx/Library/CloudStorage/OneDrive-shanghaitech.edu.cn/Public/data/pbmc_tutorial.rds\")\nclustree(pbmc)\n\n\n\n\n这三行表示每个分辨率值下的细胞分配情况。每行中的节点大小表示该聚类中的细胞数量。行之间的箭头显示随着分辨率的增加，聚类的分配情况如何变化。稳定的聚类可能会更改名称，但是细胞在不同的分辨率下仍然会聚集在一起。一些聚类可能会分裂成两个（或更多）子聚类。这暗示着增加分辨率。但是，如果你看到聚类之间来回跳动的情况很多，那就表示稳定性较差。在你自己的数据中，最好进行过度聚类，然后检查基因，然后手动选择要合并的聚类。\n我们选择分辨率=0.5进行进一步检查：\n\nIdents(pbmc) &lt;- pbmc$RNA_snn_res.0.5\nDimPlot(pbmc, reduction = \"umap\", label=TRUE)"
  },
  {
    "objectID": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#聚类富集标记",
    "href": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#聚类富集标记",
    "title": "Single-cell Workshop 2021 - 02 - 聚类和细胞类型鉴定",
    "section": "聚类富集标记",
    "text": "聚类富集标记\n接下来，对于每个聚类，我们想要检查在该聚类中相比其他细胞高度表达的特征（也称为标记或基因）。我们使用’roc’方法来估计每个标记的分类能力（0表示随机，1表示完美）。我们可以逐个聚类地进行这个分析，也可以同时对所有聚类进行分析。\n\ncluster0.markers &lt;- FindMarkers(pbmc, ident.1 = 0, logfc.threshold = 0.25, test.use = \"roc\", only.pos = TRUE)\n\n⚠️ 对所有聚类执行此操作非常耗时。如果你想休息一下。在这样做之前启动它。计算时间可能长达30分钟。如果你在教程时间方面运行晚了，现在跳过这个和下面的热图。\n\ncluster.all.markers0.5 &lt;- FindAllMarkers(pbmc, logfc.threshold = 0.25, test.use = \"roc\", only.pos = TRUE, min.pct = 0.25)\n\nCalculating cluster 0\n\n\nCalculating cluster 1\n\n\nCalculating cluster 2\n\n\nCalculating cluster 3\n\n\nCalculating cluster 4\n\n\nCalculating cluster 5\n\n\nCalculating cluster 6\n\n\nCalculating cluster 7\n\n\nCalculating cluster 8\n\n\nCalculating cluster 9\n\n\nCalculating cluster 10\n\n\nCalculating cluster 11\n\n\nCalculating cluster 12\n\n\nCalculating cluster 13\n\n\nCalculating cluster 14\n\n\nCalculating cluster 15\n\n\n热图为共享高度表达标记的集群提供了很好的图形表示。注意到umap中这些集群之间的关系了吗?\n\ncluster.all.markers0.5  %&gt;%\n    group_by(cluster) %&gt;%\n    top_n(n = 5, wt = avg_log2FC) -&gt; top5\n\nDoHeatmap(pbmc, features = top5$gene) + NoLegend()\n\n\n\n\n接下来，我们选择一些标记，这些标记往往适用于PBMC数据集。其中许多来自cluster.all.markers0.5。\n\nmarkers.to.plot &lt;- c(\"CD3D\", \"HSPH1\", \"SELL\", \"CD14\", \"LYZ\", \"GIMAP5\", \"CACYBP\", \"GNLY\", \"NKG7\", \"CCL5\", \"CD8A\", \"MS4A1\", \"CD79A\", \"FCGR3A\", \"MS4A7\", \"S100A9\", \"HLA-DQA1\",\"GPR183\", \"PPBP\", \"GNG11\", \"TSPAN13\", \"IL3RA\", \"FCER1A\", \"CST3\", \"S100A12\")\n\nDotPlot(pbmc, features = markers.to.plot, cols = c(\"blue\", \"red\"), dot.scale = 8) +RotatedAxis()\n\n\n\n\n\nVlnPlot(pbmc, features = c(\"MS4A1\", \"CD79A\"))\n\n\n\nVlnPlot(pbmc, features = c(\"NKG7\", \"GNLY\"))\n\n\n\nVlnPlot(pbmc, features = c(\"FCGR3A\", \"MS4A7\"))\n\n\n\nVlnPlot(pbmc, features = c(\"PPBP\"))\n\n\n\nVlnPlot(pbmc, features = c(\"FCER1A\", \"CST3\"))   \n\n\n\nVlnPlot(pbmc, features = c(\"CD8A\", \"CD8B\", \"CD3D\"))\n\n\n\n\n\nFeaturePlot(pbmc, features = c(\"MS4A1\", \"GNLY\", \"CD3E\", \"CD14\", \"FCER1A\", \"FCGR3A\", \"LYZ\", \"PPBP\",  \"CD8A\"))"
  },
  {
    "objectID": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#基于参考的聚类注释",
    "href": "posts/2023-07-26-clustering-and-cell-type-identification/index.html#基于参考的聚类注释",
    "title": "Single-cell Workshop 2021 - 02 - 聚类和细胞类型鉴定",
    "section": "基于参考的聚类注释",
    "text": "基于参考的聚类注释\n基于参考数据的聚类注释不在Seurat软件包中进行。为此，我们将使用SingleR，并首先将Seurat数据的信息转换为SingleR的格式。\n\nsce &lt;- GetAssayData(object = pbmc, assay = \"RNA\", slot = \"data\")\n\n我们将使用一篇经典论文中的数据，该论文使用分类细胞对不同的免疫细胞类型进行了比较。基于参考数据的注释允许与高度精选的数据集进行直接比较。然而，缺点是推断的结果取决于参考数据集中定义的内容。\n\nrefMonaco &lt;- MonacoImmuneData()\n\nsnapshotDate(): 2022-10-31\n\n\nsee ?celldex and browseVignettes('celldex') for documentation\n\n\nloading from cache\n\n\nsee ?celldex and browseVignettes('celldex') for documentation\n\n\nloading from cache\n\n\n数据格式在两个层次上显示信息:主要细胞类型和更精细的分辨率信息：\n\nprediction_Monaco_main &lt;- SingleR(test=sce, ref=refMonaco, clusters=Idents(pbmc), labels=refMonaco$label.main)\nprediction_Monaco_fine &lt;- SingleR(test=sce, ref=refMonaco, clusters=Idents(pbmc), labels=refMonaco$label.fine)\n\npredicted_Monaco &lt;- data.frame(cluster=sort(unique(Idents(pbmc))), Monaco_main= prediction_Monaco_main$labels, Monaco_fine= prediction_Monaco_fine$labels)\npredicted_Monaco\n\n   cluster     Monaco_main                  Monaco_fine\n1        0       Monocytes          Classical monocytes\n2        1    CD4+ T cells            Naive CD4 T cells\n3        2       Monocytes          Classical monocytes\n4        3    CD8+ T cells            Naive CD8 T cells\n5        4    CD4+ T cells               Th1/Th17 cells\n6        5         T cells           Non-Vd2 gd T cells\n7        6         B cells  Non-switched memory B cells\n8        7         B cells                Naive B cells\n9        8        NK cells         Natural killer cells\n10       9       Monocytes       Intermediate monocytes\n11      10         T cells                   MAIT cells\n12      11 Dendritic cells      Myeloid dendritic cells\n13      12 Dendritic cells Plasmacytoid dendritic cells\n14      13       Monocytes          Classical monocytes\n15      14     Progenitors             Progenitor cells\n16      15         B cells                 Plasmablasts"
  }
]